<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>suid exploitation</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>suid exploitation</h1><br/>Assuimg we have basic access. If a program is allowed to run as root as below, it can be used for privilege escalation.<br /><br />Before running any privilege escalation or enumeration script, let&#39;s check the basic commands for elevating<br />privileges like sudo and id :<br /><br /><a href=""><img src="images/32-1.png" alt="images/32-1.png" /></a><br /><br /><a href=""><img src="images/32-2.png" alt="images/32-2.png" /></a><br /><br />Bugtracker seems intresting.<br /><br />find / -group bugtracker 2&gt;/dev/null<br /><br /><a href=""><img src="images/32-3.png" alt="images/32-3.png" /></a><br /><br />ls -la /usr/bin/bugtracker &amp;&amp; file /usr/bin/bugtracker<br /><br /><a href=""><img src="images/32-4.png" alt="images/32-4.png" /></a><br /><br />There is a suid set on that binary, which is a promising exploitation path.<br /><br />Commonly noted as SUID (Set owner User ID), the special permission for the user access level has a single function: A file with SUID always executes as the user who owns the file, regardless of the user passing the command. If the file owner doesn&#39;t have execute permissions, then use an uppercase S here.<br /><br />In our case, the binary &#39;bugtracker&#39; is owned by root &amp; we can execute it as root since it has SUID set.<br /><br />Lets run it:<br /><br /><a href=""><img src="images/32-5.png" alt="images/32-5.png" /></a><br /><br />The tool is accepting user input as a name of the file that will be read using the cat command, however, it<br />does not specifies the whole path to file cat and thus we might be able to exploit this.<br /><br /><strong>We will make our own malicious cat</strong>.<br /><br />We will navigate to /tmp directory and create a file named cat with the following content:<br /><br />/bin/sh<br /><br />We will then set the execute privileges:<br /><br />chmod +x cat<br /><br />In order to exploit this we can add the /tmp directory to the PATH environmental variable.<br />PATH is an environment variable on Unix-like operating systems, DOS, OS/2, and<br />Microsoft Windows, specifying a set of directories where executable programs are<br />located.We can do that my issuing the following command:<br /><br />export PATH=/tmp:$PATH<br /><br />Now we will check the $PATH :<br /><br />echo $PATH<br /><br /><a href=""><img src="images/32-6.png" alt="images/32-6.png" /></a><br /><br /><br />Finally execute the bugtracker from /tmp directory:<br /><br /><a href=""><img src="images/32-7.png" alt="images/32-7.png" /></a><br /><br /><h6>We have root access now !!!!</h6></div>
</body>
</html>
