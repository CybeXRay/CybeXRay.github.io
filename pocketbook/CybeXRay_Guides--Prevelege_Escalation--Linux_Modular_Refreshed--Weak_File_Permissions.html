<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Weak File Permissions</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Weak File Permissions</h1><br/><strong><h1>Weak File Permissions</h1></strong><br /><br /><strong><h2>A) Readable /etc/shadow</h2></strong><br /><br />The /etc/shadow file contains user password hashes and is usually readable only by the root user.<br /><br /><strong>Note </strong>that the /etc/shadow file on the VM is world-readable:<br /><br /><strong>ls -l /etc/shadow</strong><br /><br />View the contents of the /etc/shadow file:<br /><br /><strong>cat /etc/shadow</strong><br /><br />Each line of the file represents a user. A user&#39;s password hash (if they have one) can be found between the first and second colons (:) of each line.<br /><br />Save the root user&#39;s hash to a file called <strong>hash.txt</strong> on your Kali VM and use <strong>john the ripper</strong> to crack it. You may have to unzip /usr/share/wordlists/rockyou.txt.gz first and run the command using sudo depending on your version of Kali:<br /><br /><strong>john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt</strong><br /><br />Switch to the root user, using the cracked password:<br /><br /><strong>su root</strong><br /><br /><strong>Example:</strong><br /><img src="images/219-1.png" alt="images/219-1.png" /><br /><br />Now in Kali<br /><img src="images/219-2.png" alt="images/219-2.png" /><br /><br /><br /><strong><h2>B) Writable /etc/shadow</h2></strong><br /><br />The /etc/shadow file contains user password hashes and is usually readable only by the root user.<br /><br /><strong>Note </strong>that the /etc/shadow file on the VM is world-writable:<br /><br /><strong>ls -l /etc/shadow</strong><br /><br />Generate a new password hash with a password of your choice:<br /><br /><strong>mkpasswd -m sha-512 newpasswordhere</strong><br />or<br /><strong>openssl passwd -6 -salt custom_salt newpasswordhere</strong><br /><br /><strong>Edit</strong> the<strong> /etc/shadow</strong> file and replace the original root user&#39;s password hash with the one you just generated.<br /><br />Switch to the root user, using the new password:<br /><br /><strong>su root</strong><br /><br /><strong>Example:</strong><br /><img src="images/219-3.png" alt="images/219-3.png" /><br />Next, we will edit the /etc/shadow file and add these passwords for root user and login with Password1234<br /><br /><br /><strong><h2>C) Writable /etc/passwd</h2></strong><br /><br />The /etc/passwd file contains information about user accounts. It is world-readable, but usually only writable by the root user. Historically, the /etc/passwd file contained user password hashes, and some versions of Linux will still allow password hashes to be stored there.<br /><br /><strong>Note</strong> that the /etc/passwd file is world-writable:<br /><br /><strong>ls -l /etc/passwd</strong><br /><br />Generate a new password hash with a password of your choice:<br /><br /><strong>openssl passwd newpasswordhere</strong><br />It creates a MD5 hash($1$)<br /><br />Edit the <strong>/etc/passwd</strong> file and place the generated<strong> password hash </strong>between the <strong>first</strong> and <strong>second</strong> colon <strong>(:)</strong> of the <strong>root user&#39;s row</strong> (replacing the <strong>&quot;x&quot;</strong>).<br /><br />Switch to the root user, using the new password:<br /><strong>su root</strong><br /><br /><strong>Alternatively</strong>, <strong>copy</strong> the root user&#39;s row and append it to the bottom of the file, changing the first instance of the word &quot;<strong>root</strong>&quot; to &quot;<strong>newroot</strong>&quot; and placing the generated password hash between the first and second colon (replacing the &quot;x&quot;).<br /><br />Now switch to the newroot user, using the new password:<br /><br /><strong>su newroot</strong><br /><br /><br /><strong><h2>END</h2></strong><br /></div>
</body>
</html>
