<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Intro to ISAC</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Intro to ISAC</h1><br/><strong><h1>Introduction</h1></strong><br /><br />Information Sharing and Analysis Centers (ISACs), are used to  share and exchange various Indicators of Compromise (IOCs) to obtain  threat intelligence. IOCs can include MD5s, IPs, YARA rules, and more.  There are many ISACs that can be used to gather threat intelligence  including AlienVault OTX, Threat Connect, and MISP.<br /><br /><br /><strong>Terminology:</strong><br /><br /><br /><strong>APT</strong> is an acronym for <strong>Advanced Persistent Threat</strong>. This can be considered a team/group (threat group), or even country (nation-state group), that engages in long-term attacks against organizations and/or countries. The term &#39;advanced&#39; can be misleading as it will tend to cause us to believe that each APT group all have some super-weapon, e.i. a zero-day exploit, that they use. That is not the case. As we will see a bit later, the techniques these APT groups use are quite common and can be detected with the right implementations in place. You can view FireEye&#39;s current list of APT groups here.  <br /><br /><strong>TTP</strong> is an acronym for <strong>Tactics</strong>, <strong>Techniques</strong>, and <strong>Procedures</strong>, but what does each of these terms mean?<br /><br />    The <strong>Tactic</strong> is the adversary&#39;s goal or objective.<br />    The <strong>Technique</strong> is how the adversary achieves the goal or objective.<br />    The <strong>Procedure</strong> is how the technique is executed.<br /><br /><strong>TI</strong> is an acronym for <strong>Threat Intelligence</strong>. Threat Intelligence is an overarching term for all collected information on adversaries and TTPs. You will also commonly hear <strong>CTI</strong> or <strong>Cyber Threat Intelligence</strong> which is just another way of saying Threat Intelligence.<br /><br /><strong>IOCs</strong> is an acronym for <strong>Indicators of Compromise</strong>, the indicators for malware and adversary groups. Indicators can include file hashes, IPs, names, etc.<br /><br /><br /><strong><h3>Threat Intelligence:</h3></strong><br />Threat Intelligence, also known as TI and Cyber Threat Intelligence also known as, CTI, is used to provide information about the threat landscape specifically adversaries and their TTPs. Typically CTI revolves around APT groups and/or other threats, these can be well-known groups or up and coming new threats.<br /><br />Data must be analyzed to be considered threat intelligence. Once analyzed and actionable, then it becomes threat intelligence. The data needs context around to become intel.<br /><br />CTI is a precautionary measure that companies use or contribute to so that other corporations do not get hit with the same attacks. Of course, adversaries change their TTPs all the time so the TI landscape is constantly changing.<br /><br />Vendors and corporations will sometimes share their collected CTI in what are called ISACs or Information Sharing and Analysis Centers. ISACs collect various indicators of an adversary that other corporations can use as a precaution against adversaries.<br /><br />Threat Intelligence is also broken up into <strong>three</strong> different types.<br /><br />◇ <strong>Strategic</strong><br />Assist senior management make informed decisions specifically about the security budget and strategies.<br /><br />◇ <strong>Tactical</strong><br />Interacts with the TTPs and attack models to identify adversary attack patterns.<br /><br />◇ <strong>Operational</strong><br />Interact with IOCs and how the adversaries operationalize.<br /><br /><br /><strong><h3>ISAC:</h3></strong><br />According to the National Council of ISACs, &quot;Information Sharing and  Analysis Centers (ISACs) are member-driven organizations, delivering  all-hazards threat and mitigation information to asset owners and  operators&quot;. ISACs can be community-centered or vendor-specific. ISACs  include CTI from threat actors as well as mitigation information in the  form of IOCs, YARA rules, etc. ISACs maintain situational awareness by  sharing and collaborating to maintain CTI, through a <a href="https://www.nationalisacs.org/">National Council of ISACs</a>.<br /><br />You can view a list of member ISACs here: <a href="https://www.nationalisacs.org/member-isacs-3">https://www.nationalisacs.org/member-isacs</a>.<br /><br />We  will be focusing on ISACs as they pertain to cybersecurity and cyber  threat intelligence; however, ISACs can be utilized for more than just  cybersecurity.<br /><br />Below is a list of ISACs that can help a blue team we will only be showcasing a few in this room.<br />• <a href="https://us-cert.cisa.gov/">US-CERT</a><br />• <a href="https://otx.alienvault.com/">AlienVault OTX</a><br />• <a href="https://threatconnect.com/">ThreatConnect</a><br />• <a href="https://www.misp-project.org/">MISP</a><br /><br /><br /><br /><strong>ThreatConnect:</strong><br />Threat Connect Overview<br /><br />Threat Connect focuses more on the information and new developments within cybersecurity and the threat landscape and connecting the landscape with indicators. This intelligence can help your team make better-informed decisions on what to prioritize. Threat Connect would fall under the tactical type of threat intelligence. <br /><br />There is a free and open-source version of Threat Connect available but if you were actually using this on a security team you would want to pay for access to the full platform. Threat Connect is a very large platform with many capabilities but we will only be using it to create our threat intel dashboard and gather indicators from other ISACs like AlienVault OTX. It is important to have multiple sources for the information or intelligence that you collect.<br /><br />Sign up for a free ThreatConnect account here. (<strong>https://threatconnect.com/</strong>)<br /><br /><strong>Note:</strong> Currently ThreatConnect has gone through a new re-branding and seems to no longer offer a free account.<br /><br /><br /><strong>AlienVault OTX:</strong><br /><br />AlienVault OTX from  AT&amp;T Cybersecurity is one of the main ISACs that is used as an  exchange for community maintained threat intelligence.<br />You will need to create an AlienVault account before you can fully use the application. Go to <a href="https://otx.alienvault.com/">https://otx.alienvault.com/</a> and create an account before continuing.<br /><img src="images/258-1.png" alt="images/258-1.png" /><br /><br />Alienvault  uses &#39;<strong>Pulses</strong>&#39; to create trackers for various categories. <strong>Pulses</strong> can be  categorized by Malware type, APT or group, and targeted industry. All <strong>pulses</strong> are community-created excluding official pulses from AlienVault. <br /><br /><strong>Pulses</strong> can include a wide variety of IOCs such as File Hashes (MD5, SHA1), IPv4, IPv6, Domain, URL, YARA, CVE, and more. <br /><br /><img src="images/258-2.png" alt="images/258-2.png" /><br /><br /><br />The  main page of OTX you will use is the Dashboard. The default dashboard  includes a visualization of the most common active malware broken down  by category as well as a list of Subscribed Pulses. By default, only  AlienVault&#39;s Subscribed Pulses will be listed. This can be expanded upon  later.<br /><br />There are also six different tabs that you can navigate to on the navigation bar, they are outlined below.<br />   ◇ Dashboard - This is shown above in the screenshot above. It&#39;s the main page of OTX and will provide a brief overview of important intel.<br />   ◇ Browse - This will allow you to see all new pulses and sort by various categories to find the newest intel.<br />   ◇ Scan Endpoints - This is an automated service called OTX Endpoint Security that will scan endpoints for indicators.<br />   ◇ Create Pulse - This will allow you to create your own pulses and contribute to the threat exchange.<br />   ◇ Submit Sample - This allows you to submit a malware sample or URL sample which OTX will analyze and generate a report based on the provided sample.<br />   ◇ API Integration - Allows synchronization of the threat exchange with other tools for monitoring your environment.<br /><br /><br /><strong>Pulses Overview:</strong><br /><br />Pulses can consist of a description, tags, indicator types (file  hash, Yara, IP, domain, etc.), and threat infrastructure (country of  origin). OTX uses pulses as their indicators. A majority of pulses are  community-created and maintained. You need to keep this in mind when  using pulses for threat intelligence as not all pulses are legit or may  contain inaccurate information. Always verify and analyze the indicators  used before using them for CTI.<br /><br /><br /><strong> Breaking Down a Pulse</strong><br />First,  we need to understand how to analyze and gather information from a  pulse in order to understand how to use OTX&#39;s many categories, ways of  obtaining threat intelligence, and indicators.<br /><br />As an example, we will be looking at the Xanthe - Docker aware  miner pulse released from the official AlienVault account. You can find it <a href="https://otx.alienvault.com/pulse/5fc6767d4cca089129062db9">here</a>.<br /><br />Pulses consist of three main sections: <strong>Pulse Description</strong>, I<strong>ndicator  Overview</strong>, <strong>Indicators</strong>. We will break down these sections further and  identify each component of them.<br /><br /><strong>Pulse Description</strong><br />The  Pulse Description consists of the description itself, references, tags,  malware families, and ATT&amp;CK IDs. The three most important parts  are the reference section, the description itself, and the ATT&amp;CK  IDs. The references can be used to verify the pulse and get further  background information on the pulse/indicators. The description can give  you a brief overview of what the pulse is for and how it was gathered  which can be useful when quickly looking for pulses to use. The  ATT&amp;CK IDs can be used to quickly identify what TTPs are being used  by the pulse and familiarize yourself with them. For more information  about ATT&amp;CK check out Heavenraiza&#39;s <a href="https://tryhackme.com/room/mitre">MITRE room</a>.<br /><img src="images/258-3.png" alt="images/258-3.png" /><br /><br /><strong>Indicator Overview</strong><br /><br /><br />The  Indicator Overview will give you a very brief statistical  representation of the indicators within the pulse as well as threat  infrastructure. The indicator overview can be useful when looking for a  very specific IOC like a file hash or YARA rule, etc.<br /><br /><img src="images/258-4.png" alt="images/258-4.png" /><br /><br /><br />From here we can see that the pulse has six different types of indicators as well as four different countries that the pulse is originating from.<br /><em>Note: A majority of pulses do not have threat infrastructure however it can be useful when analyzing a pulse for CTI.</em><br /><br /><br /><strong>Indicators</strong><br /><br />Indicators are probably the most important section of the entire pulse. It contains all of the indicators and information about them.<br /><br /><img src="images/258-5.png" alt="images/258-5.png" /><br /><br />There is a lot of information to break down for each pulse. Look below for more information about each column of the indicators.<br /><br />• Type - The type of indicator (URL, File Hash, IP, Domain, etc.)<br />• Indicator - The indicator itself<br />• Added - Date added, pulses can be updated this can be useful to track the pulses history<br />• Active - Shows, whether the indicator is still seen in the wild and active, can be useful when selecting pulses to use.<br />• Related Pulses - Shows pulses that share the same indicator, can be useful to cross-check indicators.<br />• Extra Information (Advanced) - These are the advanced options including Dynamic Analysis, Network Activity, and YARA rules.¬†<br /><br />The  <strong>Advanced</strong> section of indicators can contain the most information and  allow you to get a better understanding of what you are dealing with.  Not all pulses or indicators will contain any advanced information but  it can be very useful when available. Below is an example of a YARA  detection and dynamic analysis of a binary from a file hash.<br /><img src="images/258-6.png" alt="images/258-6.png" /><br /><br /><br /><strong>Creating IOCs Manually</strong><br />A large portion of ISACs are community contributions where contributors take the latest malware samples and create IOCs  for them. There are a few tools that can help with the creation of IOCs  including <strong>strings</strong>, <strong>winmd5free</strong>, and <strong>Mandiant IOC Editor</strong>. There are also  tools that can be used to automate this process like Mandiant Redline  however that is out of scope for this room.<br /><br /><img src="images/258-7.png" alt="images/258-7.png" /><br /><br /><br />If  you open the Tools folder on the Desktop you will see all of the tools  necessary to create IOCs for both the practice binaries and the  scenarios.<br /><br /><img src="images/258-8.png" alt="images/258-8.png" /><br /><br />To  begin collecting indicators from a sample you can gather the MD5 file  hash using WinMD5. Simply run WinMD5 and select the file you want to  gather from.<br /><br /><img src="images/258-9.png" alt="images/258-9.png" /><br /><br />Practice with the Cerber sample in <strong>C:\Users\Jon\Documents\Practice\Practice 1\</strong><br />To  get another baseline of information we can look at the properties of  the file to find other indicators including size, name, date created,  etc.<br /><br /><img src="images/258-10.png" alt="images/258-10.png" /><br /><br />To  get our final indicator and probably the most unique we need to run  strings on the sample to identify if there are any unusual or unique  strings that we can use in the IOC. I would advise taking the output into a file to view later.<br />Syntax:<strong> </strong><strong>./strings.exe &lt;path to file&gt; -accepteula &gt; output.txt</strong><br /><br /><img src="images/258-11.png" alt="images/258-11.png" /><br /><br /><br />You&#39;re looking for strings that are human-readable and unique this can include IPs, BTC Addresses, unique function names, etc. You  may not always find unique strings right away with some samples. This  is where the use of an automated tool like Redline could come in handy  as well as for identifying other indicators.<br /><br />The string below is unique enough that it could be used as an indicator.<br /><br /><img src="images/258-12.png" alt="images/258-12.png" /><br /><br />Continue looking through the strings output of the Cerber ransomware to find unique strings.<br />Once you have all of your indicators prepared you can begin creating an IOC with <strong>Mandiant IOCe</strong>.<br /><br />1. Create a new IOC by navigating to File &gt; New Indicator.<br /><br /><img src="images/258-13.png" alt="images/258-13.png" /><br /><br /><br />2. Add in your indicators to the IOC from the Item tab, for more in-depth information on creating IOCs check out the <a href="https://www.fireeye.com/content/dam/fireeye-www/services/freeware/ug-ioc-editor.pdf">IOCe user guide</a>.                                    <img src="images/258-14.png" alt="images/258-14.png" /><br /><br />This is an example of an IOC for the Cerber sample. If this was a real investigation you could then upload it to AlienVault OTX or another ISAC.<br /><br /><br /><strong>Creating Pulses from IOCs:</strong><br /><span style="text-decoration:underline;">Note: Please do not take malware outside of the sandbox or create a pulse on OTX without an actual investigation.</span><br />You can navigate to the Create Pulse tab of AlienVault OTX to begin creating a pulse.<br /><br /><img src="images/258-15.png" alt="images/258-15.png" /><br /><br /><br />AlienVault OTX can automatically extract indicators including MD5, SHA265 hashes,  etc. Even though OTX automatically extracts indicators it is still  suggested to create your own IOCs.<br /><br /><img src="images/258-16.png" alt="images/258-16.png" /><br /><br />AlienVault OTX also has built-in functionality to take a malware sample under the submit a sample tab and analyze it. This will give back many indicators  including MD5 hashes, SHA256 hashes, and PE anomalies as well as related  pulses.<br /><br /><img src="images/258-17.png" alt="images/258-17.png" /><br /><br /><br /><br /><br /><br /></div>
</body>
</html>
