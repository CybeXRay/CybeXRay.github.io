<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>nmap</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>nmap</h1><br/><strong>TRYHACKME NMAP COMPLETE</strong>----&gt;<br /><br /><strong>List the IPs to be scanned without actually scanning them:</strong><br /><br />(-n to skip Reverse DNS lookup)<br />nmap -nsL Target_List/Target_IP<br /><br />nmap -nsL 10.10.12.13/29<br />nmap -nsL 10.10.0-255.101-125<br /><br /><br />(With Reverse DNS lookup)<br />nmap -sL Target_List/Target_IP<br /><br />nmap -sL 10.10.12.13/29<br />nmap -sL 10.10.0-255.101-125<br /><br /><br /><strong>Host Discovery “without” any Port Scans:</strong> (To check if Host/s are up)<br /><br />(General Host Discovery)<br />nmap -sn Target_List/Target_IP<br /><br />(ARP only Host Discovery)<br />nmap -PR -sn Target_List/Target_IP<br /><br />(PING/ICMP echo only Host Discovery)  ICMP 8/0<br />nmap -PE -sn Target_List/Target_IP<br />Remember that an ARP query will precede the ICMP request if your target is on the same subnet.<br /><br />As Ping is blocked accross most machines. We can use ICMP Timestamp<br />(ICMP Timestamp Host Discovery)  ICMP 13/14<br />nmap -PP -sn Target_List/Target_IP<br /><br />As Ping is blocked accross most machines. We can use ICMP Address Mask<br />(ICMP Address Mask Host Discovery) ICMP 17/18<br />nmap -PM -sn Target_List/Target_IP<br /><br />Host Discovery using TCP &amp; UDP Ping<br />TCP SYN ping: nmap -PS -sn Target_List/Target_IP<br /><br />-PS80 (default)<br />-PS20-25<br />-PS80,443,8080<br /><br />Super User: 	SYN			SYN/ACK			RST<br />Normal User: 	SYN			SYN/ACK			ACK			<br /><br /><br />TCP ACK ping: nmap -PA -sn Target_List/Target_IP<br /><br />-PS80 (default)<br />-PS20-25<br />-PS80,443,8080<br /><br />Super User: 	ACK			RST<br />Normal User: 	Cannot Perform this<br /><br /><br />UDP Ping: 	nmap -PU -sn Target_List/Target_IP<br /><br />Uses an uncommon port as only if port is closed we get a response &amp; know that system is online. (If port is open, we get no response)<br /><br /><strong>Reverse DNS Lookup:</strong><br /><br />By Default nmap does Reverse DNS lookup. This can be skipped by -n option.<br />Now, to use reverse DNS lookup for all hosts(even offline) can be done using -R option<br /><br /><strong>Port Scans:</strong><br /><br /><strong>TCP Connect Scan</strong>  (Can be performed by normal user also)<br />By Default it scans <strong>most common</strong> 1000 ports:<br /><br />nmap -sT Target_List/Target_IP<br /><br /><br /><strong>TCP SYN Scan</strong> (Only Preveleged User) : Default mode for Preveleged user.<br /><br />nmap -sS Target_List/Target_IP<br /><br /><strong>UDP Scan:</strong> (Only Preveleged User)<br /><br />nmap -sU Target_List/Target_IP<br /><br /><br /><strong>Fine Tuning &amp; Managing Scope:</strong><br /><br />-F<br />We can use <strong>-F</strong> to enable fast mode and decrease the number of scanned ports from <strong>1000 to 100 </strong>most common ports.<br /><br />--top-ports &lt;number&gt; : Eg. --top-ports 10  will scan 10 most common ports<br /><br />-r<br />It is worth mentioning that the <strong>-r</strong> option can also be added to scan the ports in consecutive order instead of random order. <br />This option is useful when testing whether ports open in a consistent manner, for instance, when a target boots up.<br /><br />-p<br />Port list: <br />-p22			: Scan 22<br />-p20-25 	: Scan 20,21,22,23,24,25<br />-p22,80	: Scan 22 &amp; 80<br />-p-			: Scan all 65535 <br /><br />-T<br />Timmings. -T&lt;0-5&gt;<br />-T0	:	Paranoid (Slowest)<br />-T1	: 	Sneaky (Real World)<br />-T2	:	Polite<br />-T3	: 	Normal (Nmap Default)<br />-T4	:	Aggressive (CTFs)<br />-T5	:	Insane (Fastest)<br /><br />Slow --→ Helps in IDS evasion<br /><br />Alternatively we can control the packet rate:<br />--min-rate &lt;number&gt; Eg. --min-rate 10<br />--max-rate &lt;number&gt; Eg. --max-rate 20<br /><br />Probing Parallelization: (Determines the number of parallel probes for host discovery &amp; port scans)<br />--min-parallelism &lt;numprobes&gt;  <br />--max-parallelism &lt;numprobes&gt;<br />Eg. --min-parallelism 512 : Indicates that nmap has to maintain atlest 512 parallel probes for host discovery &amp; port scans.<br /><br /><br /><strong>Advanced Port Scans:</strong><br /><br /><strong>Null Scan:</strong> (Only Preveleged User)<br />Send TCP with no flags set. If Port Open or Firewall is present we get no response.<br />If no firewall  &amp; port is closed: We get a RST flag response. (indicating port is closed)<br /><br />nmap -sN Target_List/Target_IP<br /><br />Note: It can say with certainity if a port is closed. But for open ports its not sure as no response is recorded. (open|filtered)<br /><br /><strong>FIN</strong> <strong>Scan:</strong> (Only Preveleged User)<br />Send TCP with FIN flag set. If Port Open or Firewall is present we get no response.<br />If no firewall  &amp; port is closed: We get a RST flag response. (indicating port is closed)<br /><br />nmap -sF Target_List/Target_IP<br /><br />Note: It can say with certainity if a port is closed. But for open ports its not sure as no response is recorded. (open|filtered)<br /><br /><strong>Xmas</strong> <strong>Scan:</strong> (Only Preveleged User)<br />Send TCP with URG,PSH,FIN flag set. If Port Open or Firewall is present we get no response.<br />If no firewall  &amp; port is closed: We get a RST flag response. (indicating port is closed)<br /><br />nmap -sX Target_List/Target_IP<br /><br />Note: It can say with certainity if a port is closed. But for open ports its not sure as no response is recorded. (open|filtered)<br /><br /><br />Null, FIN &amp; Xmas are best used when there is a stateless firewall. (That blocks SYN flag packets)<br />However, a Stateful Firewall will still block these 3 scans.<br /><br /><strong>Maimon Scan:</strong> (Used for BSD-Derived System)<br /><br />Uses a TCP packet with FIN &amp; ACK flag set. Normally Open/Closed all ports should respond with a RST flag. So not very useful.<br />However, in certain BSD-Derived systems, if the port is open the packet is dropped &amp; no response is recorded. (Used to find Open|Filtered Ports)<br /><br />nmap -sM Target_List/Target_IP<br /><br /><strong>TCP ACK Scan:</strong> (Used to detect Firewall rule sets &amp; configuration)<br /><br />We send a TCP packet with ACK flag set. Irrespective of whether port is open or closed we get a RST flag in response. (So we cannot check for open ports)<br />However, if a port is blocked by the firewall, the packet is dropped. (Indicating Firewall blocked it)<br /><br />Thus, the ports where we receive RST flag, we know that its accessible in firewall rules. (Can be open|closed)<br /><br />nmap -sA Target_List/Target_IP<br /><br /><strong>TCP Window Scan:</strong> (Used to detect Firewall rule sets &amp; configuration)<br /><br />We send a TCP packet with ACK flag set. Irrespective of whether port is open or closed we get a RST flag in response. <br />But upon checking the window position in the TCP header, we see certain differences.<br /><br />If Firewall is blocking the port, packet is dropped. Else we get a RST flag.<br /><br />nmap -sW Target_List/Target_IP<br /><br /><strong>Custom Scan:</strong><br /><br />nmap --scanflags &lt;FLAGS&gt; Target_List/Target_IP<br /><br />We can se multiple flags in our request and test.<br /><br />-scanflags RSTSYNFIN : It will set the RST, SYN and FIN flags<br />-scanflags SYNACKURGPSHRSTFIN : It will set all flags: SYN, ACK, URG, PSH, RST and FIN<br /><br /><strong>Spoof &amp; Decoy:</strong><br /><br />Spoof:<br />To make target think nmap coming from different IP/MAC &amp; send responses back to that IP/MAC. (Note: -Pn is required as we don&#39;t want any packets back to source)<br /><br />IP Spoof<br />nmap -e NET_INTERFACE -Pn SPOOFED_IP Target_List/Target_IP<br />eg: nmap -e eth0 -Pn 10.10.10.10 Target_List/Target_IP<br /><br />Responses will be sent to 10.10.10.10<br /><br />MAC Spoof (Only works in all systems on same ethernet or wifi network)<br />nmap --spoof-mac SPOOFED_MAC Target_List/Target_IP<br /><br />Decoy:<br />To send packets from multiple dummy targets as well as the attacker.<br />Keywords:<br />ME: Attacker IP<br />RND: Random IP<br /><br />nmap -D 10.10.0.1,10.10.0.2,RND,RND,ME Target_List/Target_IP<br /><br /><strong>Fragmented Packets:</strong><br />Used for evasion against firewalls &amp; IDS. (Old)<br /><br />nmap -f Target_List/Target_IP 	:	Divided packet into 8 bytes fragments plus change.<br />nmap -ff Target_List/Target_IP 	: 	Divides packet into 16 bytes fragments plus change.<br /><br /><strong>Idle/Zombie Scan:</strong><br />It spoofs the scan from zombie_ip and records the IP ID of the zombie/idle device for any increment more than 1 in IP ID. <br />if IP ID increased, it means port is open &amp; the zombie/ID device received a SYN/ACK from target &amp; responded with a RST.<br /><br />nmap -sI ZOMBIE_IP Target_List/Target_IP<br /><br /><strong>Getting More Details:</strong><br /><br />--reason <br />Option gives the reason of all the outputs<br /><br />-v<br />Option for verbose display<br /><br />-vv<br />For very verbose display<br /><br />-d<br />Detailed debug output<br /><br />-dd<br />Very detailed debug output<br /><br />--source-port PORT_NUM<br />Specify source Port Number<br /><br />--data-length NUM<br />Append random data to reach given length<br /><br /><strong>Service Detection:</strong><br /><br />Service Detection is achieved through -sV. It does a complete 3 way hankshake<br /><br />--version-intensity LEVEL		:		LEVEL (0-9) 0: Lightest 9: Most Complete<br />--version-light							: 		Its equivalent to --version-intensity 2<br /><br />eg. nmap -sV --version-intensity 7  Target_List/Target_IP<br />eg, nmap -sV --version-light Target_List/Target_IP<br /><br /><strong>OS Detection:</strong><br /><br />-O <br />Capital O option is used for OS detection.<br />Generally type of OS is correctly determined in most cases. (Windows/Linux)<br />However, the version of running OS is not so accurate.<br /><br />eg. nmap -sS -O Target_List/Target_IP<br /><br /><strong>Traceroute:</strong><br /><br />-traceroute<br />It is used to show traceroute details in nmap scan. (It runs opposite to normal windows/linux traceroute)<br /><br />eg. nmap -sS -traceroute Target_List/Target_IP<br /><br /><strong>Scripts:</strong><br /><br />nmap -sS -sC Target_List/Target_IP								: This uses the default script, same as --script=default<br />nmap -sS --script=CATEGORY Target_List/Target_IP		: This uses the mentioned category<br />nmap -sS --script “xyz.nse” Target_List/Target_IP 		: This searches for xyz.nse in /usr/share/nmap/scripts folder<br /><br />Categories---&gt;<br />auth 				: authentication related<br />broadcast		: discover hosts by sending broadcast messages<br />brute				: performs brute-force password auditing against logins<br />default				: default scripts, same as -sC<br />discovery		: retrieve accessible information such as database tables and dns names<br />dos					: detects servers vulnerable to denial of service<br />exploit				: attempts to exploit various vulnerable services<br />external			: checks using a third party plugin such as Geoplugin and Virustotal<br />fuzzer				: launch fuzzing attacks<br />intrusive			: intrusive scripts such as brute-force attacks and exploitation<br />malware			: scans for backdoors<br />safe					: safe scripts that wont crash the target<br />version			: retrieve service versions<br />vuln 				: checks for vulnerabilities or explot vulnerable services<br /><br /><strong>Outputs:</strong><br /><br />Formats: Normal, Grepable, XML &amp; Script Kiddie<br /><br />-oN	:	Normal<br />-oG	:	Grepable<br />-oX	:	XML<br />-oA	:	Writes output in all 3 Normal, Grepable &amp; XML formats<br />-oS	:	Script Kiddie (Just normal output with styled charecters, no significant need)<br /><br /><strong>Misc:</strong><br /><br />-A 	:	Equivalent to -sV -O -sC -traceroute<br /><br /><br /><strong>Making a ports variable with quick scan and using this open ports for detailed scan</strong><br /><br />ports=$(nmap -p- --min-rate 1000 -T4 10.10.10.150 | grep ^[0-9] | cut -d&#39;/&#39; -f 1 | tr &#39;\n&#39; &#39;,&#39; | sed s/,$//)<br />nmap -sC -sV -p$ports 10.10.10.150 --open<br /></div>
</body>
</html>
