<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>blaster</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>blaster</h1><br/><strong><h1>THM: Blaster</h1></strong><br /><br /><br /><strong><h2>Enumeration</h2></strong><br /><br /><strong>Rustscan &amp; Nmap</strong><br /><img src="images/44-1.png" alt="images/44-1.png" /><br /><br /><strong>Open Ports:</strong> 80 (WEB) &amp; 3389 (RDP)<br /><br /><strong>Website Enumeration</strong><br /><img src="images/44-2.png" alt="images/44-2.png" /><br /><br />We find a default IIS Server page.<br /><br /><strong>Dirsearch &amp; Gobuster</strong><br /><img src="images/44-3.png" alt="images/44-3.png" /><br /><br /><strong>Web Directory Enumeration</strong><br /><img src="images/44-4.png" alt="images/44-4.png" /><br /><br />We found a blogging page &amp; also found a wordpress login page.<br /><img src="images/44-5.png" alt="images/44-5.png" /><br /><br /><br />We can also use gobuster with <strong>http://10.10.163.147/retro</strong>. But i will continue manually enumerating the website &amp; as expected I found clear text password in the “<strong>Ready Player One</strong>” Blog entry.<br /><br /><img src="images/44-6.png" alt="images/44-6.png" /><br /><br /><strong>Credentials Found:</strong><br />Username	: 	<strong>Wade</strong><br />Password		:	<strong>parzival</strong>	 	<br /><br />Lets Login to Wordpress with the credentials.<br /><img src="images/44-7.png" alt="images/44-7.png" /><br /><br />And as expected we are successful.<br /><br /><strong>Note</strong><br />There are 2 Foothold Methods. Access to normal user is possible in both the methods. However, Later I found out that Windows Defender is active in the machine thus, I get to system access with Method-2 only<br /><br /><strong><h2>Foothold Method-1</h2></strong><br /><br />Go to <strong>Apperance -→ Themes</strong> &amp; select any theme (Preferably Non Active) to make changes.<br /><img src="images/44-8.png" alt="images/44-8.png" /><br /><br />I choose<strong> Twenty Sixteen</strong>.<br />Now lets go to <strong>Apperance --→ Theme Editor</strong> &amp; select the <strong>theme</strong> on the <strong>right</strong> from the <strong>dropdown</strong> and click on “<strong>Select</strong>” button<br /><br /><img src="images/44-9.png" alt="images/44-9.png" /><br /><br /><br />Then from the right side pane of “<strong>Theme Files</strong>”, select any php file (Prefarably <strong>index.php</strong>)<br /><img src="images/44-10.png" alt="images/44-10.png" /><br /><br />Now, replace the contents on the index.php with the php-reverse-shell for <strong>ALL OS</strong> <br />Link: <strong>https://github.com/ivan-sincek/php-reverse-shell/blob/master/src/reverse/php_reverse_shell.php</strong><br /><strong>Note:</strong> Make the necessary changes in the reverse shell file in the <strong>ip</strong> &amp; <strong>port</strong> field.<br /><br /><img src="images/44-11.png" alt="images/44-11.png" /><br /><br />After making the changes, click on update file on the bottom of the page.<br /><br /><strong>Triggering the Reverse Shell</strong><br />Start a netcat listener in Kali machine on port specified on the reverse shell file.<br />Next <strong>Live</strong> <strong>Preview</strong> the <strong>Twenty Sixteen</strong> theme to activate the reverse shell.<br /><br />Go to <strong>Apperance -→ Themes</strong> &amp; click on <strong>Live Preview</strong> of the <strong>Twenty Sixteen</strong> theme (Select the one modified by you)<br /><img src="images/44-12.png" alt="images/44-12.png" /><br /><br />And back in our Netcat Listner, we got a shell.<br /><img src="images/44-13.png" alt="images/44-13.png" /><br /><br /><br /><strong><h2>Priviege Escalation</h2></strong><br /><br />I check the user details and its privileges. Luckily, the user has <strong>SeImpersonate / SeAssignPrimaryToken</strong> present for the user.<br />This can be used for privilege escalation.<br /><br /><img src="images/44-14.png" alt="images/44-14.png" /><br /><br />I decided to use the <strong>PrintSpoofer.exe</strong> exploit for privilege escalation.<br /><strong>Note:</strong> It will only work if the above privileges are present.<br /><br />Link: <strong>https://github.com/itm4n/PrintSpoofer/releases</strong><br /><br />I will host the <strong>PrintSpoofer.exe</strong> using python web server in my kali machine.<br />Keep the PrintSpoofer.exe in a directory and from that directory run.<br /><br /><strong>python -m http.server 80</strong><br /><br />In the Windows Terminal, Open <strong>Powershell</strong> as it supports wget for file download. Then go the <strong>C:\Users\Public</strong> directory as it is world writable.<br />Then <strong>download</strong> the <strong>Printspoofer.exe</strong> &amp; <strong>run</strong> it.<br /><br />I tried the above and it failed because the w<strong>indows defender </strong>was blocking the program, We will tackle the situation in an alternate method.<br /><br /><br /><strong><h2>Foothold Method-2</h2></strong><br /><br /><br /></div>
</body>
</html>
