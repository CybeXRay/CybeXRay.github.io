<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>nax</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>nax</h1><br/><p><strong><h1>THM: Nax</h1></strong></p><p></p><p><strong><h2>Enumeration</h2></strong></p><p></p><p><strong>Rustscan</strong></p><p><img src="images/30-1.png" alt="images/30-1.png" /></p><p></p><p><strong>Nmap</strong></p><p><img src="images/30-2.png" alt="images/30-2.png" /></p><p></p><p></p><p><strong>Dirbuster</strong></p><p><img src="images/30-3.png" alt="images/30-3.png" /></p><p></p><p>Opening the /nagios</p><p><img src="images/30-4.png" alt="images/30-4.png" /></p><p></p><p></p><p></p><p><strong>Webpage Source</strong></p><p><img src="images/30-5.png" alt="images/30-5.png" /></p><p></p><p><strong>Going to the link in view source.</strong></p><p><img src="images/30-6.png" alt="images/30-6.png" /></p><p></p><p><strong>Webpage Enumeration</strong></p><p><img src="images/30-7.png" alt="images/30-7.png" /></p><p></p><p>Ag – Hg – Ta – Sb – Po – Pd – Hg – Pt – Lr</p><p>47 – 80 – 73 – 51 – 84 – 46 – 80 – 78 – 103</p><p></p><p>Above are the element&#39;s number in periodic table.</p><p>We convert the above from ASCII to Text Oniline.</p><p></p><p></p><p><img src="images/30-8.png" alt="images/30-8.png" /></p><p></p><p>Enumerating the new location found. (<strong>/PI3T.PNg</strong>)</p><p><img src="images/30-9.png" alt="images/30-9.png" /></p><p></p><p>We downloaded the PNG file and checked with <strong>exiftool</strong>. Indeed it shows binary content</p><p><img src="images/30-10.png" alt="images/30-10.png" /></p><p></p><p>We got one answer though: <strong>Creator of File - Piet Mondrian</strong></p><p>Binwalk also didn&#39;t give any particular results.</p><p></p><p><img src="images/30-11.png" alt="images/30-11.png" /></p><p></p><p>Then, we searched online for <strong>PIET steganography</strong> &amp; looked for decoder.</p><p><strong>Note:</strong> <strong>Piet</strong> as an esoteric language where code looks like abstract geometric pictures</p><p></p><p>We will use this link: <strong>https://www.bertnase.de/npiet/npiet-execute.php</strong> </p><p></p><p><img src="images/30-12.png" alt="images/30-12.png" /></p><p></p><p>The online site was showing errors. (As it needs the Picture in <strong>PPM</strong> format &amp; within a certain <strong>size</strong>)</p><p><strong>Windows</strong></p><p>Windows executiblle does not need ppm format. We downloaded the windows executible and opened the <strong>PI3T.PNg</strong> file.</p><p><img src="images/30-13.png" alt="images/30-13.png" /></p><p></p><p><strong>Linux</strong></p><p>To install <strong>npiet</strong> in linux. Get the <strong>www.bertnase.de/npiet/npiet-1.3f.tar.gz</strong> compressed source code</p><p>First install the required library from <strong>https://github.com/libgd/libgd/releases</strong> by gettin the release <strong>libgd-2.3.3.tar.gz</strong></p><p></p><p>To install both the source code. (First install the libgd library)</p><p>Use the following insdie the respective folders. (Preferably in /opt)</p><p></p><p><strong>./configure</strong></p><p><strong>make</strong></p><p><strong>make install</strong></p><p></p><p>To Uninstall</p><p><strong>make uninstall</strong></p><p></p><p><strong>Note:</strong> In Linux, the <strong>.PNG</strong> format won&#39;t work. We need to convert it to <strong>.PPM</strong></p><p>Open the PNG file in <strong>gimp</strong> and then export it to PPM format</p><p></p><p>We run as follows:</p><p><img src="images/30-14.png" alt="images/30-14.png" /></p><p></p><p></p><p>From both the run instances, we found long series of text which is repeated. Following is the string</p><p><strong>nagiosadmin%n3p3UQ&amp;9BjLp4$7uhWdY</strong></p><p></p><p>Credentials Found</p><p><strong>Username:	nagiosadmin</strong></p><p><strong>Password:		n3p3UQ&amp;9BjLp4$7uhWdY</strong></p><p></p><p></p><p>We try to use the same in the Login pages we found earlier.</p><p><img src="images/30-15.png" alt="images/30-15.png" />                                                                                                                                                                                                                                                                                                                     </p><p>We got inside the Nagios dashboard</p><p><img src="images/30-16.png" alt="images/30-16.png" /></p><p></p><p></p><p>Nagios Version: Found at left bottom of Nagios XI Dashboard</p><p><img src="images/30-17.png" alt="images/30-17.png" /></p><p></p><p><strong><h2>Foothold With Elevated Privileges</h2></strong></p><p></p><p>Using Searchsploit we found the exploit.</p><p><img src="images/30-18.png" alt="images/30-18.png" /></p><p></p><p>We will use metasploit as the exploit is indeed present in it.(see the highlight above)</p><p>We searched the CVE in google</p><p><img src="images/30-19.png" alt="images/30-19.png" /></p><p></p><p>Exploit Used:</p><p><strong>exploit/linux/http/nagios_xi_plugins_check_plugin_authenticated_rce</strong></p><p></p><p>Options Set:</p><p><img src="images/30-20.png" alt="images/30-20.png" /></p><p></p><p>After Running, we get root access.</p><p><img src="images/30-21.png" alt="images/30-21.png" /></p><p></p><p>We get the flags and complete the machine.</p><p></p><p><img src="images/30-22.png" alt="images/30-22.png" /></p><p></p><p>Thanks!!</p><p></p></div>
</body>
</html>
