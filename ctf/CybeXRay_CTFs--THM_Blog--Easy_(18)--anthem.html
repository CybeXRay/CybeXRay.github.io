<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>anthem</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>anthem</h1><br/><strong><h1>Anthem</h1></strong><br /><br /><br /><strong><h3>Enumeration</h3></strong><br /><br /><strong>Rustscan for Ports:</strong><br /><img src="images/52-1.png" alt="images/52-1.png" /><br /><br /><strong>Nmap for Details:</strong><br /><img src="images/52-2.png" alt="images/52-2.png" /><br /><br /><strong>Website Enumeration:</strong><br /><img src="images/52-3.png" alt="images/52-3.png" /><br /><br />By looking at one of the posts. We get idea about email id convention.<br /><img src="images/52-4.png" alt="images/52-4.png" /><br /><br />The following post is by <strong>Jane Doe</strong> &amp; the email ID is <strong>JD@anthem.com</strong><br /><br />Also, by doing view source: We find the <strong>First Flag</strong> in the meta content.<br />THM{L0L_WH0_US3S_M3T4}<br /><br />The <strong>Second Flag</strong> is in the search element of view source.<br />THM{G!T_G00D}<br /><br />The <strong>Third Flag</strong> is in the profile page of Jane Doe. We get there by either using the following link or clicking on Jane Doe in the post.<br />THM{L0L_WH0_D15}<br /> <br /><img src="images/52-5.png" alt="images/52-5.png" /><br /><br />By looking at one of the posts, it says its a poem about admin. I searched the poem in google &amp; found the author name. (It could be a potential username)<br /><br /><img src="images/52-6.png" alt="images/52-6.png" /><br /><br /><img src="images/52-7.png" alt="images/52-7.png" /><br /><br /><strong>Potential Username: Solomon Grundy Or SG@anthem.com</strong><br /><br />Also, by doing view source: We find the <strong>Fourth Flag</strong> in the meta content.<br />THM{AN0TH3R_M3TA}<br /><br /><br />We search the website for any information &amp; found intresting info in the <strong>robots.txt</strong><br /><img src="images/52-8.png" alt="images/52-8.png" /><br /><br />It seems <strong>umbraco</strong> application is running. Also, the first line seems like a potential password.<br /><br /><strong>Potential Password: UmbracoIsTheBest!</strong><br /><br /><br /><strong>Enumerating the Umbraco Client:</strong><br /><br />We open the link: http://10.10.112.187/umbraco <br /><img src="images/52-9.png" alt="images/52-9.png" /><br /><br />We are able to successfully Login with <strong>SG@anthem.com</strong> &amp; <strong>UmbracoIsTheBest!</strong><br /><br /><img src="images/52-10.png" alt="images/52-10.png" /><br /><br /><strong>Note:</strong> From here, there are two options to solve the machine. One is however, blocked by Antivirus.<br /><br /><strong><h3>Foothold</h3></strong><br /><br /><strong><span style="text-decoration:underline;">Method-1:</span></strong><br />I searched for the application in searchsploit. <br /><img src="images/52-11.png" alt="images/52-11.png" /><br /><br />The 2 highlighted exploits do work. (Tested after turing off the anti-virus)<br />However, by default the Anti-Virus is ON &amp; it blocks any code injection reverse shells.<br /><br /><strong><span style="text-decoration:underline;">Method-2:</span></strong><br />We will use the same credentials for RDP into the machine.<br />Username: SG<br />Password: UmbracoIsTheBest!<br /><br /><strong>xfreerdp /dynamic-resolution +clipboard /cert:ignore /scale:140 /v:10.10.112.187 /u:SG /p:&#39;UmbracoIsTheBest!&#39;</strong><br /><br />We found the user flag on the desktop.<br /><br /><strong><h3>Privilege Escalation</h3></strong><br /><br />I go to C: Drive &amp; find a hidden folder named “<strong>backup</strong>”<br /><br /><img src="images/52-12.png" alt="images/52-12.png" /><br /><br />Inside Backup directory, I found a restore.txt file. But i didn&#39;t have enough permissions.<br /><img src="images/52-13.png" alt="images/52-13.png" /><br /><br />I opened the <strong>Properties</strong> of the file. Went to <strong>Security</strong> tab and edited the permissions. I searched for the name <strong>SG</strong> &amp; added all permissions to it. It was successful.<br /><br /><img src="images/52-14.png" alt="images/52-14.png" /><br /><br /><img src="images/52-15.png" alt="images/52-15.png" /><br /><br />Now, we open the <strong>restore.txt</strong> again. We did find the administrator password.<br /><img src="images/52-16.png" alt="images/52-16.png" /><br /><br />Next, I RDP into the machine as administrator.<br /><br /><strong>xfreerdp /dynamic-resolution +clipboard /cert:ignore /scale:140 /v:10.10.112.187 /u:administrator /p:&#39;ChangeMeBaby1MoreTime&#39;</strong><br /><br />We have administrator access! We collect the root flag in Administrator Desktop.<br /><br />Thanks!!<br /><br /><br /></div>
</body>
</html>
