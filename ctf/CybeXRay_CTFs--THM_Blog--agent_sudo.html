<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>agent sudo</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>agent sudo</h1><br/><strong><h1>THM: Agent Sudo</h1></strong><br /><br /><strong><h2>Enumeration</h2></strong><br /><br /><strong>Rustscan</strong><br /><img src="images/29-1.png" alt="images/29-1.png" /><br /><br /><strong>Nmap</strong><br /><img src="images/29-2.png" alt="images/29-2.png" /><br /><br /><br /><strong>FTP</strong><br />Anonymous Login not allowed.<br /><img src="images/29-3.png" alt="images/29-3.png" /><br /><br /><strong>Website</strong><br /><img src="images/29-4.png" alt="images/29-4.png" /><br /><br />We change the user-agent with burpsuite and send the request.<br /><img src="images/29-5.png" alt="images/29-5.png" /><br /><br />As message was from Agent R.<br />We tried <strong>“R”</strong> as <strong>user-agent</strong>.<br /><br />We got a different output, stating having 25 employees.<br /><br /><br />We then try for A,B,C,D...<br />Upon sending <strong>User-Agent: C</strong> <br />We found a Location tag highlighted below. We will open it..<br /><img src="images/29-6.png" alt="images/29-6.png" /><br /><br /><br />We use the location in path and user-agent as c<br /><img src="images/29-7.png" alt="images/29-7.png" /><br /><br />We get a different page. Which talks about telling something to Agent J and that the users&#39;s password is weak.<br /><strong>Username Found: Chris</strong><br /><br />Rendered page below:<br /><img src="images/29-8.png" alt="images/29-8.png" /><br /><br />I tried to use <strong>User-Agent: J</strong><br />But we did not get any special page.<br /><br /><strong>FTP Bruteforce</strong><br />As chris user has weak password. I try to bruteforce it using hydra<br /><img src="images/29-9.png" alt="images/29-9.png" /><br /><br />Indeed we cracked the FTP credentials.<br /><br /><strong>Credential Found<br />Username: 	chris<br />Password: 	crystal</strong><br /><br /><strong>FTP</strong><br /><img src="images/29-10.png" alt="images/29-10.png" /><br /><br /><strong>File Contents</strong><br /><img src="images/29-11.png" alt="images/29-11.png" /><br />The note says that agent J&#39;s password is stored in the pictures.<br /><br /><br /><strong>Enumerating the Pictures</strong><br /><img src="images/29-12.png" alt="images/29-12.png" /><br /><br />I used <strong>steghide</strong> on both the files and found nothing.<br />Then i used <strong>exiftool</strong><br /><br /><img src="images/29-13.png" alt="images/29-13.png" /><br /><br /><img src="images/29-14.png" alt="images/29-14.png" /><br /><br />We find something intresting in the 2nd file. (Highlighted)<br />Lets use -b option<br /><br /><img src="images/29-15.png" alt="images/29-15.png" /><br /><br />We got the binary source. (Not so usable)<br /><br />Next we use <strong>binwalk</strong><br /><br /><img src="images/29-16.png" alt="images/29-16.png" /><br /><br />We see there ia zip archive data<br />We extract it.<br /><br /><img src="images/29-17.png" alt="images/29-17.png" /><br /><br /><br />Following are the contents of <strong>_cutie.png.extracted</strong> directory<br /><img src="images/29-18.png" alt="images/29-18.png" /><br /><br /><br />We will try to extract the zip file.<br />unzip did not work, however i searched google with the error. it is recommened to use 7zip. <br /><img src="images/29-19.png" alt="images/29-19.png" /><br /><br />It worked in 7zip, however we still do not know the password. We will use john<br /><br /><img src="images/29-20.png" alt="images/29-20.png" /><br /><br /><img src="images/29-21.png" alt="images/29-21.png" /><br /><br /><br /><strong>Lets Unzip</strong><br />The unzip was successful with the found password<br /><br /><img src="images/29-22.png" alt="images/29-22.png" /><br /><br /><br />Thus, following are the contents of the file we got out of archive.<br /><img src="images/29-23.png" alt="images/29-23.png" /><br /><br />We then decode the found code.<br /><br /><img src="images/29-24.png" alt="images/29-24.png" /><br /><br /><br />Lets use the found password in <strong>steghide</strong><br /><img src="images/29-25.png" alt="images/29-25.png" /><br /><br /><strong>Credentials Found<br />Username: 	james<br />Password: 	hackerrules!</strong><br /><br /><img src="images/29-26.png" alt="images/29-26.png" /><br /><br />We reverse image search the image and also search with foxnews(In Hint)<br />We find the answer: <strong>Roswell alien autopsy</strong><br /><br /><strong><h2>Privilege Escalation</h2></strong><br /><br /><img src="images/29-27.png" alt="images/29-27.png" /><br /><br />The system is running an outdated version of sudo. We will look online/searchsploit for any vulnerabilities.<br /><br /><img src="images/29-28.png" alt="images/29-28.png" /><br /><br />We get the highlighted exploit and check it.<br /><img src="images/29-29.png" alt="images/29-29.png" /><br /><br /><br />We use the above code &amp; get into root.<br /><img src="images/29-30.png" alt="images/29-30.png" /><br /><br /><img src="images/29-31.png" alt="images/29-31.png" /><br /><br />Thanks!!</div>
</body>
</html>
