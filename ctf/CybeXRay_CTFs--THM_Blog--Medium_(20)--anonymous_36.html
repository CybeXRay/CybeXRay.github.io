<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>anonymous</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>anonymous</h1><br/><p><strong><h1>THM: Anonymous</h1></strong></p><p></p><p><strong><h2>Enumeration</h2></strong></p><p></p><p></p><p><strong>Rustscan and Nmap</strong></p><p><img src="images/36-1.png" alt="images/36-1.png" /></p><p></p><p><strong>Samba Share (Rabbit Hole)</strong></p><p><img src="images/36-2.png" alt="images/36-2.png" /></p><p></p><p>It seems we can access pics share. We connect to it and get the files.</p><p><img src="images/36-3.png" alt="images/36-3.png" /></p><p></p><p><strong>Image Enumeration</strong></p><p>We use <strong>exiftool, steghide and binwalk</strong>. It turns out to be a rabbit hole with no useful information</p><p></p><p>Then we continue our enumeration</p><p><strong>FTP</strong></p><p><img src="images/36-4.png" alt="images/36-4.png" /></p><p></p><p>We got 3 files in FTP. Lets look at them.</p><p></p><p><img src="images/36-5.png" alt="images/36-5.png" /></p><p></p><p>It seems that the script clean.sh is running automatically after certain time intervals.</p><p></p><p></p><p><strong><h2>Foothold</h2></strong></p><p></p><p><strong>Our Approach</strong></p><p>We will edit the local clean.sh and add a reverse shell. We will upload it back using FTP and hope we get a connection back</p><p><img src="images/36-6.png" alt="images/36-6.png" /></p><p></p><p>Then we upload it.</p><p><img src="images/36-7.png" alt="images/36-7.png" /></p><p></p><p></p><p></p><p><strong>Note: </strong>Also add execution permission to clean.sh before uploading.</p><p><strong>chmod +x clean.sh</strong></p><p></p><p>We start our listener and wait for the script to run automatically. (Runs every minute: Found out later)</p><p><img src="images/36-8.png" alt="images/36-8.png" /></p><p></p><p>We get user.txt in the <strong>namelessone&#39;s</strong> home directory.</p><p></p><p><strong><h2>Privilege Escalation</h2></strong></p><p></p><p>We check for SUID set files.</p><p><strong>find / -type f -perm -u=s 2&gt;/dev/null</strong></p><p></p><p><img src="images/36-9.png" alt="images/36-9.png" /></p><p></p><p>We found /usr/bin/env has SUID bit set. We use GTFObins to find the exploit.</p><p></p><p><strong>/usr/bin/env /bin/bash -p </strong></p><p></p><p><img src="images/36-10.png" alt="images/36-10.png" /></p><p></p><p></p><p></p></div>
</body>
</html>
