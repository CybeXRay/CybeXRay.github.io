<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>simplectf</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>simplectf</h1><br/><p><strong><h1>THM Simple CTF</h1></strong></p><p></p><p><strong><h2>Enumeration</h2></strong></p><p></p><p><strong>Rustscan</strong></p><p><img src="images/27-1.png" alt="images/27-1.png" /></p><p></p><p><strong>Nmap </strong></p><p><img src="images/27-2.png" alt="images/27-2.png" /></p><p></p><p></p><p><strong>FTP</strong></p><p><img src="images/27-3.png" alt="images/27-3.png" /></p><p></p><p>The contents of the file</p><p><img src="images/27-4.png" alt="images/27-4.png" /></p><p></p><p>It gives a hint that the web password and system password might be same.</p><p></p><p><strong>Website Emuneration</strong></p><p><img src="images/27-5.png" alt="images/27-5.png" /></p><p></p><p></p><p></p><p>The following CMS was found</p><p><img src="images/27-6.png" alt="images/27-6.png" /></p><p></p><p>We get version information at bottom of page.</p><p><img src="images/27-7.png" alt="images/27-7.png" /></p><p></p><p></p><p>We further enumerate this.</p><p><img src="images/27-8.png" alt="images/27-8.png" />\</p><p></p><p>We get the following admin login page.</p><p><img src="images/27-9.png" alt="images/27-9.png" /></p><p></p><p>We search the vulnerable version exploit.</p><p><img src="images/27-10.png" alt="images/27-10.png" /></p><p></p><p>We will use searchsploit and run this. (Note: We need <strong>python2</strong>)</p><p></p><p><img src="images/27-11.png" alt="images/27-11.png" /></p><p></p><p>We will use the highlighted one.</p><p><strong>searchsploit -m php/webapps/46635.py</strong></p><p><img src="images/27-12.png" alt="images/27-12.png" /></p><p></p><p></p><p>We will run in a fresh terminal as it will expand it to max.</p><p><img src="images/27-13.png" alt="images/27-13.png" /></p><p></p><p></p><p><strong>python2 46635.py -u http://10.10.223.252/simple/ --crack -w /usr/share/seclists/Passwords/Common-Credentials/best110.txt</strong></p><p>We use the wordlist provided in the hint.</p><p></p><p><img src="images/27-14.png" alt="images/27-14.png" /></p><p></p><p>We got the web credentials as follows:</p><p><strong>Username:  	mitch</strong></p><p><strong>Password:		secret</strong></p><p></p><p><strong><h2>Foothold</h2></strong></p><p></p><p>We use the found credentials to ssh into the machine. We were successful and find the user flag.</p><p></p><p><img src="images/27-15.png" alt="images/27-15.png" /></p><p></p><p><strong><h2>Privilege Escalation</h2></strong></p><p></p><p>We search for sudo permissions and find that mitch is allowed to run <strong>/usr/bin/vim</strong> as <strong>sudo</strong></p><p>We open <strong>sudo /usr/bin/vim</strong> and run the following command to get a root shell.</p><p><strong>:!/bin/bash</strong></p><p></p><p><img src="images/27-16.png" alt="images/27-16.png" /></p><p>Inside Vim</p><p><img src="images/27-17.png" alt="images/27-17.png" /></p><p></p><p>We got root shell</p><p><img src="images/27-18.png" alt="images/27-18.png" /></p><p>We get the root flag in /root directory.</p><p></p><p>Thanks !!</p></div>
</body>
</html>
