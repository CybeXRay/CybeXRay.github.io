<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>rootme</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>rootme</h1><br/><strong><h1>THM RootMe</h1></strong><br /><br /><br /><strong><h2>Enumeration</h2></strong><br /><br /><strong>Rustscan to find out open ports.</strong><br /><br />rustscan -a 10.10.132.11 <br /><br /><img src="images/23-1.png" alt="images/23-1.png" /><br /><br /><strong>Nmap for Details</strong><br /><br /><img src="images/23-2.png" alt="images/23-2.png" /><br /><br /><br /><strong>Dirsearch the Website</strong><br /><br /><img src="images/23-3.png" alt="images/23-3.png" /><br /><br /><img src="images/23-4.png" alt="images/23-4.png" /><br /><br />We find 2 intresting directories <strong>panel</strong> &amp; <strong>uploads</strong><br /><br /><strong>Enumerating the directories</strong><br /><br /><img src="images/23-5.png" alt="images/23-5.png" /><br /><br /><img src="images/23-6.png" alt="images/23-6.png" /><br /><br />Upon viewing wappalyzer, we confirm that php is running on the server. We will try to upload a malicious php file and open it to check if php code is being executed or not. We will use a php-reverse-shell (For Linux - Confirmed in nmap)<br /><br /><strong><h2>Foothold</h2></strong><br /><br />we upload a php-reverse-shell. (Check <strong>CybeXRay Guides ------→ Shells -----→ PHP Reverse Shell</strong>)<br /> <br /> We get a portuguese message that php is not allowed.<br /> <img src="images/23-7.png" alt="images/23-7.png" /><br /> <br /><img src="images/23-8.png" alt="images/23-8.png" /><br /><br /><br />We then use phtml to bypass the .php blocker. upload was successful.<br />Renamed the file from .php to .phtml<br /><br /><img src="images/23-9.png" alt="images/23-9.png" /><br /><br /><img src="images/23-10.png" alt="images/23-10.png" /><br /><img src="images/23-11.png" alt="images/23-11.png" /><br /><br />We start <strong>netcat listener</strong> and open the <strong>http://10.10.132.11/uploads/</strong>  and open the <strong>phtml file</strong>. We will receive a shell as below.<br /><br /><img src="images/23-12.png" alt="images/23-12.png" /><br /><br /><img src="images/23-13.png" alt="images/23-13.png" /><br /><br /><br /><strong>Finding the user flag</strong><br /><br /><br />find / -type f -name user.txt 2&gt;/dev/null<br /><br /><img src="images/23-14.png" alt="images/23-14.png" /><br /><br /><br /><strong><h2>Privilege Escalation</h2></strong><br /><br />We search files with <strong>suid</strong> set.<br /><br />find / type f -perm -u=s 2&gt;/dev/null<br /><br /><img src="images/23-15.png" alt="images/23-15.png" /><br /><br />As we see, /usr/bin/python can be run with root privileges, we can easily get a root shell by the following,<br /><br /><strong>/usr/bin/python -c  ‘import os;os.execl(&quot;/bin/sh&quot;, “sh”, “-p”)’</strong><br /><br /><img src="images/23-16.png" alt="images/23-16.png" /><br /><br />We get the root flag inside the /root folder.<br /><br />Thanks!!</div>
</body>
</html>
