<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>anthem</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>anthem</h1><br/><p><strong><h1>Anthem</h1></strong></p><p></p><p></p><p><strong><h3>Enumeration</h3></strong></p><p></p><p><strong>Rustscan for Ports:</strong></p><p><img src="images/52-1.png" alt="images/52-1.png" /></p><p></p><p><strong>Nmap for Details:</strong></p><p><img src="images/52-2.png" alt="images/52-2.png" /></p><p></p><p><strong>Website Enumeration:</strong></p><p><img src="images/52-3.png" alt="images/52-3.png" /></p><p></p><p>By looking at one of the posts. We get idea about email id convention.</p><p><img src="images/52-4.png" alt="images/52-4.png" /></p><p></p><p>The following post is by <strong>Jane Doe</strong> &amp; the email ID is <strong>JD@anthem.com</strong></p><p></p><p>Also, by doing view source: We find the <strong>First Flag</strong> in the meta content.</p><p>THM{L0L_WH0_US3S_M3T4}</p><p></p><p>The <strong>Second Flag</strong> is in the search element of view source.</p><p>THM{G!T_G00D}</p><p></p><p>The <strong>Third Flag</strong> is in the profile page of Jane Doe. We get there by either using the following link or clicking on Jane Doe in the post.</p><p>THM{L0L_WH0_D15}</p><p> </p><p><img src="images/52-5.png" alt="images/52-5.png" /></p><p></p><p>By looking at one of the posts, it says its a poem about admin. I searched the poem in google &amp; found the author name. (It could be a potential username)</p><p></p><p><img src="images/52-6.png" alt="images/52-6.png" /></p><p></p><p><img src="images/52-7.png" alt="images/52-7.png" /></p><p></p><p><strong>Potential Username: Solomon Grundy Or SG@anthem.com</strong></p><p></p><p>Also, by doing view source: We find the <strong>Fourth Flag</strong> in the meta content.</p><p>THM{AN0TH3R_M3TA}</p><p></p><p></p><p>We search the website for any information &amp; found intresting info in the <strong>robots.txt</strong></p><p><img src="images/52-8.png" alt="images/52-8.png" /></p><p></p><p>It seems <strong>umbraco</strong> application is running. Also, the first line seems like a potential password.</p><p></p><p><strong>Potential Password: UmbracoIsTheBest!</strong></p><p></p><p></p><p><strong>Enumerating the Umbraco Client:</strong></p><p></p><p>We open the link: http://10.10.112.187/umbraco </p><p><img src="images/52-9.png" alt="images/52-9.png" /></p><p></p><p>We are able to successfully Login with <strong>SG@anthem.com</strong> &amp; <strong>UmbracoIsTheBest!</strong></p><p></p><p><img src="images/52-10.png" alt="images/52-10.png" /></p><p></p><p><strong>Note:</strong> From here, there are two options to solve the machine. One is however, blocked by Antivirus.</p><p></p><p><strong><h3>Foothold</h3></strong></p><p></p><p><strong><span style="text-decoration:underline;">Method-1:</span></strong></p><p>I searched for the application in searchsploit. </p><p><img src="images/52-11.png" alt="images/52-11.png" /></p><p></p><p>The 2 highlighted exploits do work. (Tested after turing off the anti-virus)</p><p>However, by default the Anti-Virus is ON &amp; it blocks any code injection reverse shells.</p><p></p><p><strong><span style="text-decoration:underline;">Method-2:</span></strong></p><p>We will use the same credentials for RDP into the machine.</p><p>Username: SG</p><p>Password: UmbracoIsTheBest!</p><p></p><p><strong>xfreerdp /dynamic-resolution +clipboard /cert:ignore /scale:140 /v:10.10.112.187 /u:SG /p:&#39;UmbracoIsTheBest!&#39;</strong></p><p></p><p>We found the user flag on the desktop.</p><p></p><p><strong><h3>Privilege Escalation</h3></strong></p><p></p><p>I go to C: Drive &amp; find a hidden folder named “<strong>backup</strong>”</p><p></p><p><img src="images/52-12.png" alt="images/52-12.png" /></p><p></p><p>Inside Backup directory, I found a restore.txt file. But i didn&#39;t have enough permissions.</p><p><img src="images/52-13.png" alt="images/52-13.png" /></p><p></p><p>I opened the <strong>Properties</strong> of the file. Went to <strong>Security</strong> tab and edited the permissions. I searched for the name <strong>SG</strong> &amp; added all permissions to it. It was successful.</p><p></p><p><img src="images/52-14.png" alt="images/52-14.png" /></p><p></p><p><img src="images/52-15.png" alt="images/52-15.png" /></p><p></p><p>Now, we open the <strong>restore.txt</strong> again. We did find the administrator password.</p><p><img src="images/52-16.png" alt="images/52-16.png" /></p><p></p><p>Next, I RDP into the machine as administrator.</p><p></p><p><strong>xfreerdp /dynamic-resolution +clipboard /cert:ignore /scale:140 /v:10.10.112.187 /u:administrator /p:&#39;ChangeMeBaby1MoreTime&#39;</strong></p><p></p><p>We have administrator access! We collect the root flag in Administrator Desktop.</p><p></p><p>Thanks!!</p><p></p><p></p></div>
</body>
</html>
