<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>agent sudo</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>agent sudo</h1><br/><p><strong><h1>THM: Agent Sudo</h1></strong></p><p></p><p><strong><h2>Enumeration</h2></strong></p><p></p><p><strong>Rustscan</strong></p><p><img src="images/29-1.png" alt="images/29-1.png" /></p><p></p><p><strong>Nmap</strong></p><p><img src="images/29-2.png" alt="images/29-2.png" /></p><p></p><p></p><p><strong>FTP</strong></p><p>Anonymous Login not allowed.</p><p><img src="images/29-3.png" alt="images/29-3.png" /></p><p></p><p><strong>Website</strong></p><p><img src="images/29-4.png" alt="images/29-4.png" /></p><p></p><p>We change the user-agent with burpsuite and send the request.</p><p><img src="images/29-5.png" alt="images/29-5.png" /></p><p></p><p>As message was from Agent R.</p><p>We tried <strong>“R”</strong> as <strong>user-agent</strong>.</p><p></p><p>We got a different output, stating having 25 employees.</p><p></p><p></p><p>We then try for A,B,C,D...</p><p>Upon sending <strong>User-Agent: C</strong> </p><p>We found a Location tag highlighted below. We will open it..</p><p><img src="images/29-6.png" alt="images/29-6.png" /></p><p></p><p></p><p>We use the location in path and user-agent as c</p><p><img src="images/29-7.png" alt="images/29-7.png" /></p><p></p><p>We get a different page. Which talks about telling something to Agent J and that the users&#39;s password is weak.</p><p><strong>Username Found: Chris</strong></p><p></p><p>Rendered page below:</p><p><img src="images/29-8.png" alt="images/29-8.png" /></p><p></p><p>I tried to use <strong>User-Agent: J</strong></p><p>But we did not get any special page.</p><p></p><p><strong>FTP Bruteforce</strong></p><p>As chris user has weak password. I try to bruteforce it using hydra</p><p><img src="images/29-9.png" alt="images/29-9.png" /></p><p></p><p>Indeed we cracked the FTP credentials.</p><p></p><p><strong>Credential Found</strong></p><p><strong>Username: 	chris</strong></p><p><strong>Password: 	crystal</strong></p><p></p><p><strong>FTP</strong></p><p><img src="images/29-10.png" alt="images/29-10.png" /></p><p></p><p><strong>File Contents</strong></p><p><img src="images/29-11.png" alt="images/29-11.png" /></p><p>The note says that agent J&#39;s password is stored in the pictures.</p><p></p><p></p><p><strong>Enumerating the Pictures</strong></p><p><img src="images/29-12.png" alt="images/29-12.png" /></p><p></p><p>I used <strong>steghide</strong> on both the files and found nothing.</p><p>Then i used <strong>exiftool</strong></p><p></p><p><img src="images/29-13.png" alt="images/29-13.png" /></p><p></p><p><img src="images/29-14.png" alt="images/29-14.png" /></p><p></p><p>We find something intresting in the 2nd file. (Highlighted)</p><p>Lets use -b option</p><p></p><p><img src="images/29-15.png" alt="images/29-15.png" /></p><p></p><p>We got the binary source. (Not so usable)</p><p></p><p>Next we use <strong>binwalk</strong></p><p></p><p><img src="images/29-16.png" alt="images/29-16.png" /></p><p></p><p>We see there ia zip archive data</p><p>We extract it.</p><p></p><p><img src="images/29-17.png" alt="images/29-17.png" /></p><p></p><p></p><p>Following are the contents of <strong>_cutie.png.extracted</strong> directory</p><p><img src="images/29-18.png" alt="images/29-18.png" /></p><p></p><p></p><p>We will try to extract the zip file.</p><p>unzip did not work, however i searched google with the error. it is recommened to use 7zip. </p><p><img src="images/29-19.png" alt="images/29-19.png" /></p><p></p><p>It worked in 7zip, however we still do not know the password. We will use john</p><p></p><p><img src="images/29-20.png" alt="images/29-20.png" /></p><p></p><p><img src="images/29-21.png" alt="images/29-21.png" /></p><p></p><p></p><p><strong>Lets Unzip</strong></p><p>The unzip was successful with the found password</p><p></p><p><img src="images/29-22.png" alt="images/29-22.png" /></p><p></p><p></p><p>Thus, following are the contents of the file we got out of archive.</p><p><img src="images/29-23.png" alt="images/29-23.png" /></p><p></p><p>We then decode the found code.</p><p></p><p><img src="images/29-24.png" alt="images/29-24.png" /></p><p></p><p></p><p>Lets use the found password in <strong>steghide</strong></p><p><img src="images/29-25.png" alt="images/29-25.png" /></p><p></p><p><strong>Credentials Found</strong></p><p><strong>Username: 	james</strong></p><p><strong>Password: 	hackerrules!</strong></p><p></p><p><img src="images/29-26.png" alt="images/29-26.png" /></p><p></p><p>We reverse image search the image and also search with foxnews(In Hint)</p><p>We find the answer: <strong>Roswell alien autopsy</strong></p><p></p><p><strong><h2>Privilege Escalation</h2></strong></p><p></p><p><img src="images/29-27.png" alt="images/29-27.png" /></p><p></p><p>The system is running an outdated version of sudo. We will look online/searchsploit for any vulnerabilities.</p><p></p><p><img src="images/29-28.png" alt="images/29-28.png" /></p><p></p><p>We get the highlighted exploit and check it.</p><p><img src="images/29-29.png" alt="images/29-29.png" /></p><p></p><p></p><p>We use the above code &amp; get into root.</p><p><img src="images/29-30.png" alt="images/29-30.png" /></p><p></p><p><img src="images/29-31.png" alt="images/29-31.png" /></p><p></p><p>Thanks!!</p></div>
</body>
</html>
