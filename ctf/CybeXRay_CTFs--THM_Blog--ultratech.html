<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>ultratech</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>ultratech</h1><br/><strong><h1>THM: UltraTech</h1></strong><br /><br /><br /><strong><h2>Enumeration</h2></strong><br /><br /><strong>Rustscan</strong><br /><img src="images/35-1.png" alt="images/35-1.png" /><br /><br /><img src="images/35-2.png" alt="images/35-2.png" /><br /><br /><strong>nmap</strong><br /><img src="images/35-3.png" alt="images/35-3.png" /><br /><br /><strong>Website Enumeration</strong><br /><br /><strong>Port 31331:</strong><br />Basic website with a login page. No exploitable endpoints found.<br /><img src="images/35-4.png" alt="images/35-4.png" /><br /><br /><br />When we give dummy login credential, we are redirected to port <strong>8081</strong><br /><img src="images/35-5.png" alt="images/35-5.png" /><br /><br /><strong>Port 8081:</strong><br /><img src="images/35-6.png" alt="images/35-6.png" /><br /><br />The website shows that an API is running. We already know it. The API is running at port <strong>31331</strong><br />Now, we already know /auth is a branch. We check for other directories.<br /><br /><strong>Dirsearch</strong><br /><img src="images/35-7.png" alt="images/35-7.png" /><br /><br />We see a directory named <strong>/ping</strong> giving server error. Lets enumerate that.<br /><br /><img src="images/35-8.png" alt="images/35-8.png" /><br /><br />We try out a few things and finally stumble upon the<strong> IP</strong> parameter.<br />Lets use it and see what happens.<br /><strong>http://10.10.21.21:8081/ping?ip=127.0.0.1</strong><br /><br /><img src="images/35-9.png" alt="images/35-9.png" /><br /><br />We can see, we are getting command execution with the <strong>ping</strong><br /><br />Next we give <strong>ls</strong> in ip field. But for system commands to run we have to give in inside <strong>``</strong><br /><strong>Explanation</strong><br /><img src="images/35-10.png" alt="images/35-10.png" /><br /><br />Thus, if we give the command for execution inside <strong>``</strong>, it will be executed,<br />However, only one entry is received. (ie the final entry)<br /><br /><strong>Note:</strong> This becomes handy if a directory contains only one entry. (As it will be displayed)<br /><br />Lets try it on the website.<br /><img src="images/35-11.png" alt="images/35-11.png" /><br /><br />We see a file named <strong>utech.db.sqlite</strong><br />Lets cat the file&#39;s contents. We will use the same command execution quoted <strong>``</strong>.<br /><br /><img src="images/35-12.png" alt="images/35-12.png" /><br /><br />We got some hashes.<br />(Mr00tf357a0c52799563c7c7b76c1e7543a32)Madmin0d0ea5111e3c1def594c1684e3b9be84<br /><br />Lets crack the <strong>r00t</strong> user&#39;s hash<br /><br /><strong>Username	: 	r00t<br />Hash			:	f357a0c52799563c7c7b76c1e7543a32</strong><br /><br /><strong>Cracking the hash</strong><br /><img src="images/35-13.png" alt="images/35-13.png" /><br /><br />Its mostly MD5 as others are pretty old.<br />We use <strong>hashcat</strong> to crack it<br /><img src="images/35-14.png" alt="images/35-14.png" /><br /><br />We will use the first highlighted one.<br /><img src="images/35-15.png" alt="images/35-15.png" /><br /><br /><br /><strong>Credentials Found:</strong><br /><strong>Username	: 	r00t<br />Password	:	n100906</strong><br /><br /><strong><h2>Foothold</h2></strong><br /><br />We try to SSH to the machine with the found credentials.<br /><img src="images/35-16.png" alt="images/35-16.png" /><br /><br /><br />We found an intresting file called /usr/bin/docker which suggests a docker is running. We try to list the name<br /><br /><img src="images/35-17.png" alt="images/35-17.png" /><br /><br />Now, we have the name. Lets try to escalate privilege in the docker enivronment using <strong>GTFObins</strong><br /><br /><img src="images/35-18.png" alt="images/35-18.png" /><br /><br /><strong><h2>Partial Privilege Escalation</h2></strong><br /><br />We use the command. (replacing alpine with our docket image name)<br /><strong>docker run -v /:/mnt --rm -it bash chroot /mnt sh</strong><br /><img src="images/35-19.png" alt="images/35-19.png" /><br /><br />Thanks!!<br /><br /></div>
</body>
</html>
