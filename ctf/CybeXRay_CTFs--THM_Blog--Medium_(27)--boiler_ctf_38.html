<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>boiler ctf</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>boiler ctf</h1><br/><p><strong><h1>THM: Boiler CTF</h1></strong></p><p></p><p></p><p><strong><h2>Enumeration</h2></strong></p><p></p><p><strong>Rustscan &amp; Nmap</strong></p><p></p><p><strong>ports=$(rustscan -g -a 10.10.110.201 | cut -d &quot;[&quot; -f 2 | cut -d &quot;]&quot; -f 1)</strong></p><p><img src="images/38-1.png" alt="images/38-1.png" /></p><p></p><p><strong>nmap -A -p$ports 10.10.110.201</strong></p><p><img src="images/38-2.png" alt="images/38-2.png" /></p><p></p><p><strong>Browser Enumeration</strong></p><p>Robots.txt</p><p><img src="images/38-3.png" alt="images/38-3.png" /></p><p></p><p>Port 10000: HTTP gives error : HTTPS loads the page.</p><p><img src="images/38-4.png" alt="images/38-4.png" /></p><p></p><p></p><p><strong>FTP</strong></p><p><img src="images/38-5.png" alt="images/38-5.png" /></p><p></p><p>FTP server has no normal files. We need to dig deeper, so I looked for hidden files using <strong>&quot;ls -al&quot;</strong> and we found an <strong>.info.txt</strong> file</p><p></p><p>File Contents:</p><p><img src="images/38-6.png" alt="images/38-6.png" /></p><p></p><p>We got an ecnoded message lets decode it. It looks like ROT13</p><p>I used cyberchef to decode the message.</p><p><img src="images/38-7.png" alt="images/38-7.png" /></p><p></p><p>As we can see, there is no relevant information regarding the machine here.</p><p></p><p><strong>Dirsearch</strong></p><p>I enumerated the http server to look for hidden directories and indeed we find a <strong>joomla</strong> CMS</p><p><img src="images/38-8.png" alt="images/38-8.png" /></p><p></p><p>Enumerating the CMS</p><p><img src="images/38-9.png" alt="images/38-9.png" /></p><p></p><p>We also find a joomla administrator page.</p><p><img src="images/38-10.png" alt="images/38-10.png" /></p><p></p><p>Next I proceeded to do a dirsearch on <strong>/joomla</strong> directory</p><p></p><p><strong>Dirsearch</strong></p><p><img src="images/38-11.png" alt="images/38-11.png" /></p><p><img src="images/38-12.png" alt="images/38-12.png" /></p><p></p><p>Most of the folders had are blank or lead to some encoded strings with rabbit holes.</p><p>Example:</p><p><img src="images/38-13.png" alt="images/38-13.png" /></p><p></p><p><img src="images/38-14.png" alt="images/38-14.png" /></p><p></p><p></p><p>But, one directory is intresting.</p><p><strong>/joomla/_test</strong></p><p></p><p><img src="images/38-15.png" alt="images/38-15.png" /></p><p></p><p>It is running <strong>sar2html</strong>, upon searching on google, there are entries in exploit-db for certain versions.</p><p>We need to check our sar2html version. I couldn&#39;t find any version info on the webpage. However, i clicked on the <strong>sar2ascii.tar</strong> link and it prompted me to download the file.</p><p></p><p>I inspected the downloaded file locally.</p><p><img src="images/38-16.png" alt="images/38-16.png" /></p><p></p><p>The version is 3.2.1 and its a vulnerable version.</p><p></p><p><strong>https://www.exploit-db.com/exploits/49344</strong></p><p></p><p><img src="images/38-17.png" alt="images/38-17.png" /></p><p></p><p>I created the python file with the above and have command execution.</p><p><img src="images/38-18.png" alt="images/38-18.png" /></p><p></p><p>I explorered the contents of the present directory</p><p><img src="images/38-19.png" alt="images/38-19.png" /></p><p></p><p>I enumerated further and found ssh credentials of a user in log.txt</p><p><img src="images/38-20.png" alt="images/38-20.png" /></p><p></p><p><strong>SSH Credentials:</strong></p><p>Username:	<strong>basterd</strong></p><p>Password:	<strong>superduperp@$$</strong></p><p></p><p></p><p><strong><h2>Foothold</h2></strong></p><p></p><p>I SSH to the machine on port <strong>55007</strong></p><p></p><p><img src="images/38-21.png" alt="images/38-21.png" /></p><p></p><p>I looked at home directory to find there is another user named <strong>stoner</strong></p><p>I found a <strong>backup.sh</strong> in the current directoruy and it contained the ssh credentials for <strong>stoner</strong>.</p><p></p><p><img src="images/38-22.png" alt="images/38-22.png" /></p><p></p><p></p><p><strong>Note:</strong> I checked if basterd is having sudo permission. He doesn&#39;t have sudo permission</p><p></p><p><strong>SSH Credentials:</strong></p><p>Username:	<strong>stoner</strong></p><p>Password:	<strong>superduperp@$$no1knows</strong></p><p></p><p>I SSH to the machine with the new credentials. I found 1 hidden file in the home directory. It is the user flag.</p><p></p><p><img src="images/38-23.png" alt="images/38-23.png" /></p><p></p><p></p><p>I checked for sudo access. There was none. Next i searched for SUID set bits executibles.</p><p><img src="images/38-24.png" alt="images/38-24.png" /></p><p></p><p></p><p></p><p>I found <strong>/usr/bin/find</strong> has SUID bit set. It can easily be used to get a <strong>euid root</strong> shell. Check <strong>GTFOBins</strong></p><p>Command: <strong>/usr/bin/find . -exec /bin/sh -p \; -quit</strong></p><p></p><p><img src="images/38-25.png" alt="images/38-25.png" /></p><p></p><p>As we can see we have root access. (Partial)</p><p></p><p></p><p><strong><h2>Extra</h2></strong></p><p></p><p>Not Required for try hack me questions. </p><p></p><p>Q&gt; How to get <strong>full root user</strong> access from <strong>euid root</strong></p><p></p><p>Edit <strong>/etc/sudoers</strong> file and add an user which i have password( Or we need to create a password and replace in /etc/shadow file)</p><p>Then switch to that user and run <strong>sudo su</strong>..</p><p></p><p></p><p>Thanks !!</p></div>
</body>
</html>
