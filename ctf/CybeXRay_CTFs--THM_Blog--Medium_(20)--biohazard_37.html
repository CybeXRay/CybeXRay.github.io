<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>biohazard</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>biohazard</h1><br/><p></p><p></p><p><strong>Rustscan &amp; Nmap</strong></p><p>‚îå‚îÄ‚îÄ(rootüíÄmatrix)-[~]</p><p>‚îî‚îÄ# rustscan -g -a 10.10.123.187</p><p>10.10.123.187 -&gt; [21,22,80]</p><p></p><p><img src="images/37-1.png" alt="images/37-1.png" /></p><p></p><p><strong>Website Enumeration</strong></p><p><img src="images/37-2.png" alt="images/37-2.png" /></p><p></p><p>Click on the mansion link. We go to <strong>http://10.10.123.187/mansionmain/</strong> </p><p></p><p><img src="images/37-3.png" alt="images/37-3.png" /></p><p></p><p>A question was asked. We view source to look for clues.</p><p><img src="images/37-4.png" alt="images/37-4.png" /></p><p></p><p>We get the answer: <strong>/diningRoom</strong></p><p>Using the above directory</p><p></p><p><img src="images/37-5.png" alt="images/37-5.png" /></p><p></p><p></p><p></p><p></p><p>We click on <strong>YES</strong></p><p><img src="images/37-6.png" alt="images/37-6.png" /></p><p></p><p></p><p></p><p>Looks like we got the <strong>emblem flag</strong> along with instruction to reload the <strong>/diningRoom</strong> page.</p><p>The reloaded page.</p><p><img src="images/37-7.png" alt="images/37-7.png" /></p><p></p><p></p><p></p><p>Now we get a input field which asks for the imput flag. We put the <strong>emblem flag</strong> in it and <strong>submit</strong>.</p><p>However, we went to a deadend. (Nothing happened page)</p><p><img src="images/37-8.png" alt="images/37-8.png" /></p><p></p><p></p><p></p><p></p><p>Then we go back to the<strong> /dinningRoom</strong> and view its source</p><p><img src="images/37-9.png" alt="images/37-9.png" /></p><p></p><p></p><p></p><p>We decode it and get a hint about <strong>/teaRoom</strong></p><p><img src="images/37-10.png" alt="images/37-10.png" /></p><p></p><p></p><p></p><p>Lets open <strong>/teaRoom</strong></p><p><img src="images/37-11.png" alt="images/37-11.png" /></p><p></p><p></p><p></p><p>We get a <strong>Lockpick Link</strong> and another room as hint <strong>/artRoom</strong></p><p><img src="images/37-12.png" alt="images/37-12.png" /></p><p></p><p></p><p></p><p>We get the <strong>lock_pick Flag</strong>. We head to <strong>/artRoom</strong></p><p><img src="images/37-13.png" alt="images/37-13.png" /></p><p></p><p></p><p>We click <strong>YES</strong></p><p><img src="images/37-14.png" alt="images/37-14.png" /></p><p></p><p>We got a map of the <strong>mansion</strong></p><p></p><p>Lets go through the new rooms sequentially.</p><p>First we enter <strong>/barRoom</strong></p><p></p><p><img src="images/37-15.png" alt="images/37-15.png" /></p><p>We use the <strong>lock_pick flag</strong> here and submit. It unlocked the <strong>barRoom</strong></p><p>Flag Used: <strong>lock_pick{037b35e2ff90916a9abf99129c8e1837}</strong></p><p></p><p><img src="images/37-16.png" alt="images/37-16.png" /></p><p>We have a <strong>READ</strong> link. We will open it.</p><p></p><p></p><p><img src="images/37-17.png" alt="images/37-17.png" /></p><p>Looks like we got a decoded music note.</p><p>We decode it using base-32</p><p></p><p><img src="images/37-18.png" alt="images/37-18.png" /></p><p></p><p>We used the above music to <strong>play the piano</strong> and submit.</p><p>Flag Used: <strong>music_sheet{362d72deaf65f5bdc63daece6a1f676e}</strong></p><p></p><p><img src="images/37-19.png" alt="images/37-19.png" /></p><p>We landed on a secret bar room and we take the <strong>gold emblem</strong> by clicking <strong>YES</strong></p><p></p><p></p><p><img src="images/37-20.png" alt="images/37-20.png" /></p><p>It gives us <strong>gold_emblem</strong> flag and instructs to refresh the previous page.</p><p></p><p><img src="images/37-21.png" alt="images/37-21.png" /></p><p>Upon Refreshing the previous page we are asked to enter an emblem flag. (We just have one such which we had found first in the /diningRoom)</p><p>Flag Used: <strong>emblem{fec832623ea498e20bf4fe1821d58727}</strong></p><p></p><p><img src="images/37-22.png" alt="images/37-22.png" /></p><p></p><p>We got a name: <strong>rebecca</strong></p><p>Also I remembered that <strong>/diningRoom</strong> had an input field that did not work with the normal emblem flag. Lets try the <strong>gold emblem flag</strong> there.</p><p><img src="images/37-23.png" alt="images/37-23.png" /></p><p>We entered the <strong>gold emblem flag</strong> and hit submit.</p><p>Flag Used: <strong>gold_emblem{58a8c41a9d08b8a4e38d02a4d7ff4843}</strong></p><p></p><p><img src="images/37-24.png" alt="images/37-24.png" /></p><p>We got yet more encoded information. </p><p>I checked the encoded information in <strong>cyberchef</strong>. After trying for some time. I found that the instruction was encoded with <strong>Vigenere Cipher</strong></p><p>It asked for a key. (I entered the plain text name ‚Äú<strong>rebecca</strong>‚Äù we had found in the<strong> secret bar room</strong>)</p><p>The message was successfully decoded. We are instructed to go to <strong>the_great_shield_key</strong> inside the <strong>/diningRoom</strong></p><p><img src="images/37-25.png" alt="images/37-25.png" /></p><p></p><p>We opened the instructed page.</p><p><img src="images/37-26.png" alt="images/37-26.png" /></p><p>We got the <strong>shield_key</strong> flag</p><p></p><p>We move on to <strong>/diningRoom2F</strong></p><p><img src="images/37-27.png" alt="images/37-27.png" /></p><p>Nothing Important here. So we view its source.</p><p></p><p></p><p><img src="images/37-28.png" alt="images/37-28.png" /></p><p></p><p>We found some encoded information. [Its looks like rot13 where alphabets are shifted 13 charecters.]</p><p>I used an universal online encoder/decoder (<strong>https://www.scopulus.co.uk/tools/hexconverter.htm</strong>) to decode the information.</p><p><img src="images/37-29.png" alt="images/37-29.png" /></p><p></p><p></p><p>We tried various decoding formats. As expected using <strong>rot13</strong> we decoded the message successfully.</p><p><strong>You get the blue gem by pushing the status to the lower floor. The gem is on the diningRoom first floor. Visit sapphire.html</strong></p><p></p><p></p><p>As instructed in the message. We go <strong>/diningRoom</strong> and into<strong> /sapphire.html</strong></p><p><img src="images/37-30.png" alt="images/37-30.png" /></p><p>We got the <strong>blue_gem</strong> flag</p><p></p><p></p><p>Next, we continue to explore other rooms. We go to <strong>/tigerStatusRooom</strong></p><p><img src="images/37-31.png" alt="images/37-31.png" /></p><p>It asks for a gem. Lets try to put the <strong>blue_gem</strong> flag here.</p><p></p><p></p><p><img src="images/37-32.png" alt="images/37-32.png" /></p><p>We got the above message. We need to find <strong>4 </strong>such <strong>crests</strong> and <strong>combine</strong> them then <strong>decode</strong> them to reveal some path.</p><p>Also it says each crest is encoded twice.</p><p></p><p>Therefore I decoded the crest 2 times and got our <strong>first crest part</strong>.</p><p>I took the help of cyberchef&#39;s magic method to determine the encryption.</p><p></p><p><img src="images/37-33.png" alt="images/37-33.png" /></p><p>(14 Charecters)</p><p>Crest 1: <strong>RlRQIHVzZXI6IG</strong></p><p></p><p>We continue to next room. We now got to the <strong>/galleryRoom</strong></p><p><img src="images/37-34.png" alt="images/37-34.png" /></p><p>I click on <strong>Examine</strong></p><p></p><p></p><p><img src="images/37-35.png" alt="images/37-35.png" /></p><p>We got the second crest. We decoded it twice and have the <strong>second crest part</strong></p><p>We tried a lot with <strong>cyberchef</strong>. I din&#39;t find any solution. So i used the <strong>magic</strong> decoder.</p><p></p><p><img src="images/37-36.png" alt="images/37-36.png" /></p><p>It suggests first base32 is used to decode.</p><p>then base58 decoding is done.</p><p></p><p>We do the same in terminal. We get the crest 2 output.</p><p><img src="images/37-37.png" alt="images/37-37.png" /></p><p></p><p>(18 Charecters)</p><p>Crest 2: <strong>h1bnRlciwgRlRQIHBh</strong></p><p></p><p></p><p>We moved on the next room. We go to <strong>/studyRoom</strong>.</p><p><img src="images/37-38.png" alt="images/37-38.png" /></p><p></p><p></p><p>It asks for a <strong>helmet</strong> symbol. We do not have any such flags</p><p>We move on the next room. We enter <strong>/armorRoom/</strong></p><p></p><p><img src="images/37-39.png" alt="images/37-39.png" /></p><p></p><p></p><p>It asks for a <strong>shield</strong> symbol. We do not have any such flags</p><p>We enter the shield flag here.</p><p></p><p>Flag Used: <strong>shield_key{48a7a9227cd7eb89f0a062590798cbac}</strong></p><p></p><p><img src="images/37-40.png" alt="images/37-40.png" /></p><p>We click on the <strong>READ</strong></p><p></p><p><img src="images/37-41.png" alt="images/37-41.png" /></p><p>We found the <strong>crest 3</strong>. We will decode it and keep it as the <strong>third crest part</strong></p><p>As usual we try to decode it with cyberchef&#39;s magic method. We found 3 encryptions used.</p><p></p><p>3 Times Encoded: base64 ‚Üí binary ‚Üí hex</p><p><img src="images/37-42.png" alt="images/37-42.png" /></p><p>we get the output</p><p></p><p>(19 Charecters)</p><p>Crest 3: <strong>c3M6IHlvdV9jYW50X2h</strong></p><p></p><p></p><p>We move on the next room. We enter <strong>/attic/</strong></p><p></p><p><img src="images/37-43.png" alt="images/37-43.png" /></p><p></p><p>It asks for a <strong>shield</strong> symbol. We do not have any such flags</p><p></p><p>Flag Used: <strong>shield_key{48a7a9227cd7eb89f0a062590798cbac}</strong></p><p></p><p><img src="images/37-44.png" alt="images/37-44.png" /></p><p></p><p>We click on <strong>READ</strong></p><p>and got the <strong>fourth crest part</strong></p><p><img src="images/37-45.png" alt="images/37-45.png" /></p><p></p><p>We use cyberchef again.</p><p><img src="images/37-46.png" alt="images/37-46.png" /></p><p></p><p>(17 Charecters)</p><p>Crest 4: <strong>pZGVfZm9yZXZlcg==</strong></p><p></p><p>Now, we have all the 4 crests and decoded them.</p><p>Lets combine all of them</p><p></p><p>crest 1 + crest 2 + crest 3 + crest 4</p><p></p><p><strong>RlRQIHVzZXI6IGh1bnRlciwgRlRQIHBhc3M6IHlvdV9jYW50X2hpZGVfZm9yZXZlcg==</strong></p><p></p><p>We decode this:</p><p><img src="images/37-47.png" alt="images/37-47.png" /></p><p></p><p></p><p><strong>FTP Credentials Found</strong></p><p>Username	:	<strong>hunter</strong></p><p>Password		:	<strong>you_cant_hide_forever</strong>	</p><p></p><p></p><p><img src="images/37-48.png" alt="images/37-48.png" /></p><p></p><p></p><p>We get all the files locally and inspect them.</p><p></p><p><img src="images/37-49.png" alt="images/37-49.png" /></p><p></p><p>Lets check the hidden directory <strong>/hidden_closet</strong></p><p></p><p><img src="images/37-50.png" alt="images/37-50.png" /></p><p></p><p>I then focus on the <strong>helmet_key.txt.gpg</strong> file. This file should contain the flag.</p><p>We use the following command to decrypt the file. But it asks for a paraphrase.</p><p></p><p><strong>gpg --decrypt helmet_key.txt.gpg </strong></p><p></p><p><img src="images/37-51.png" alt="images/37-51.png" /></p><p></p><p>We do not have a paraphrase currently so we cancel it. </p><p>Following is the terminal output.</p><p></p><p><img src="images/37-52.png" alt="images/37-52.png" /></p><p></p><p></p><p>We then check all the pictures and look for a paraphrase.</p><p></p><p><strong>1st Picture: 001-key.jpg</strong></p><p><img src="images/37-53.png" alt="images/37-53.png" /></p><p></p><p>We the extract the <strong>key-001.txt</strong> using the following.</p><p><img src="images/37-54.png" alt="images/37-54.png" /></p><p></p><p>key-001.txt: <strong>cGxhbnQ0Ml9jYW</strong></p><p></p><p><strong>2nd Picture: 002-key.jpg</strong></p><p><img src="images/37-55.png" alt="images/37-55.png" /></p><p></p><p>key-002.txt: <strong>5fYmVfZGVzdHJveV9</strong></p><p></p><p><strong>3rd Picture: 003-key.jpg</strong></p><p><img src="images/37-56.png" alt="images/37-56.png" /></p><p></p><p>It seems that <strong>003-key.jpg</strong> has hidden data</p><p>We thus extract the components</p><p></p><p><img src="images/37-57.png" alt="images/37-57.png" /></p><p></p><p></p><p>We then explore the extracted directory: <strong>_003-key.jpg.extracted</strong></p><p></p><p><img src="images/37-58.png" alt="images/37-58.png" /></p><p></p><p></p><p>key-003.txt: <strong>3aXRoX3Zqb2x0</strong></p><p></p><p></p><p>Let us combine all the 3 keys found from the 3 images:</p><p></p><p><strong>cGxhbnQ0Ml9jYW5fYmVfZGVzdHJveV93aXRoX3Zqb2x0</strong></p><p></p><p>We try to decode it using base64 (Got hint from <strong>cyberchef</strong>)</p><p></p><p><img src="images/37-59.png" alt="images/37-59.png" /></p><p>Paraphrase Found: <strong>plant42_can_be_destroy_with_vjolt</strong></p><p></p><p></p><p>Lets decrypt the <strong>helmet_key.txt.gpg</strong> file with the found paraphrase.</p><p><strong>gpg --decrypt helmet_key.txt.gpg</strong></p><p></p><p>It was successfully decrypted. Following is the <strong>helmet_key</strong> flag.</p><p><img src="images/37-60.png" alt="images/37-60.png" /></p><p></p><p></p><p></p><p>Now, that we have the <strong>helmet_key</strong> we can open 2 previously locked rooms.</p><p></p><p><strong>/studyRoom</strong></p><p><strong>/hidden_closet</strong></p><p></p><p>Lets open each of them witht the <strong>helmet_key</strong>.</p><p></p><p><strong>Enumerating: /studyRoom</strong></p><p>We open the <strong>/studyRoom</strong></p><p><img src="images/37-61.png" alt="images/37-61.png" /></p><p></p><p></p><p>We click on <strong>EXAMINE</strong>. We get a <strong>doom.tar.gz</strong> file. We download it to our local machine.</p><p>Lets examine the file.</p><p></p><p><img src="images/37-62.png" alt="images/37-62.png" /></p><p></p><p>We got a SSH User: <strong>umbrella_guest</strong></p><p></p><p></p><p></p><p><strong>Enumerating: /hidden_closet</strong></p><p>Next, lets enumerate the <strong>/hidden_closet</strong> directory and open it with the <strong>helmet_key</strong></p><p></p><p><img src="images/37-63.png" alt="images/37-63.png" /></p><p></p><p>We click on <strong>READ</strong> &amp; <strong>EXAMINE</strong></p><p></p><p><strong>READ</strong></p><p><img src="images/37-64.png" alt="images/37-64.png" /></p><p>Above is the contents of MO disk 1</p><p>We know similar encryption was solved before. <strong>(Vigenere cipher)</strong></p><p>But we had a key. Presently there seems to be no keys.</p><p><strong></strong></p><p><strong></strong></p><p><strong>EXAMINE</strong></p><p><img src="images/37-65.png" alt="images/37-65.png" /></p><p>Above is the contents of wolf_medal</p><p>We got a SSH Password:	<strong>T_virus_rules</strong></p><p></p><p></p><p>SSH Credentials</p><p>Username	:	<strong>umbrella_guest</strong>	</p><p>Password		:	<strong>T_virus_rules</strong></p><p></p><p><strong><h2>Foothold</h2></strong></p><p></p><p>We SSH into the machine with the above credentials and enumerate further.</p><p></p><p><img src="images/37-66.png" alt="images/37-66.png" /></p><p></p><p>We get the whereabouts of <strong>Chris</strong></p><p>It also tells that <strong>Weasker</strong> is the traitor</p><p></p><p>We also got the <strong>MO disk 2</strong> : albert</p><p>Maybe we can use this to decrypt the <strong>MO disk 1</strong> : wpbwbxr wpkzg pltwnhro, txrks_xfqsxrd_bvv_fy_rvmexa_ajk</p><p></p><p>We use cyberchef again with the new found key.</p><p><img src="images/37-67.png" alt="images/37-67.png" /></p><p>We cracked the contents.</p><p>We got: <strong>weasker login password, stars_members_are_my_guinea_pig</strong></p><p></p><p></p><p>SSH Credentials</p><p>Username	: 	<strong>weasker</strong></p><p>Password		:	<strong>stars_members_are_my_guinea_pig</strong></p><p></p><p>Then we login with the new SSH credential.</p><p></p><p><img src="images/37-68.png" alt="images/37-68.png" /></p><p></p><p>We also got the name of the ultimate lifeform: <strong>Tyrant</strong></p><p>We get the root flag at /root.</p><p><img src="images/37-69.png" alt="images/37-69.png" /></p><p></p><p>Thanks!!</p><p></p></div>
</body>
</html>
