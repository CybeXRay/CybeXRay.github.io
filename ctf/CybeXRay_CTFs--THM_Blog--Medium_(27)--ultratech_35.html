<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>ultratech</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>ultratech</h1><br/><p><strong><h1>THM: UltraTech</h1></strong></p><p></p><p></p><p><strong><h2>Enumeration</h2></strong></p><p></p><p><strong>Rustscan</strong></p><p><img src="images/35-1.png" alt="images/35-1.png" /></p><p></p><p><img src="images/35-2.png" alt="images/35-2.png" /></p><p></p><p><strong>nmap</strong></p><p><img src="images/35-3.png" alt="images/35-3.png" /></p><p></p><p><strong>Website Enumeration</strong></p><p></p><p><strong>Port 31331:</strong></p><p>Basic website with a login page. No exploitable endpoints found.</p><p><img src="images/35-4.png" alt="images/35-4.png" /></p><p></p><p></p><p>When we give dummy login credential, we are redirected to port <strong>8081</strong></p><p><img src="images/35-5.png" alt="images/35-5.png" /></p><p></p><p><strong>Port 8081:</strong></p><p><img src="images/35-6.png" alt="images/35-6.png" /></p><p></p><p>The website shows that an API is running. We already know it. The API is running at port <strong>31331</strong></p><p>Now, we already know /auth is a branch. We check for other directories.</p><p></p><p><strong>Dirsearch</strong></p><p><img src="images/35-7.png" alt="images/35-7.png" /></p><p></p><p>We see a directory named <strong>/ping</strong> giving server error. Lets enumerate that.</p><p></p><p><img src="images/35-8.png" alt="images/35-8.png" /></p><p></p><p>We try out a few things and finally stumble upon the<strong> IP</strong> parameter.</p><p>Lets use it and see what happens.</p><p><strong>http://10.10.21.21:8081/ping?ip=127.0.0.1</strong></p><p></p><p><img src="images/35-9.png" alt="images/35-9.png" /></p><p></p><p>We can see, we are getting command execution with the <strong>ping</strong></p><p></p><p>Next we give <strong>ls</strong> in ip field. But for system commands to run we have to give in inside <strong>``</strong></p><p><strong>Explanation</strong></p><p><img src="images/35-10.png" alt="images/35-10.png" /></p><p></p><p>Thus, if we give the command for execution inside <strong>``</strong>, it will be executed,</p><p>However, only one entry is received. (ie the final entry)</p><p></p><p><strong>Note:</strong> This becomes handy if a directory contains only one entry. (As it will be displayed)</p><p></p><p>Lets try it on the website.</p><p><img src="images/35-11.png" alt="images/35-11.png" /></p><p></p><p>We see a file named <strong>utech.db.sqlite</strong></p><p>Lets cat the file&#39;s contents. We will use the same command execution quoted <strong>``</strong>.</p><p></p><p><img src="images/35-12.png" alt="images/35-12.png" /></p><p></p><p>We got some hashes.</p><p>(Mr00tf357a0c52799563c7c7b76c1e7543a32)Madmin0d0ea5111e3c1def594c1684e3b9be84</p><p></p><p>Lets crack the <strong>r00t</strong> user&#39;s hash</p><p></p><p><strong>Username	: 	r00t</strong></p><p><strong>Hash			:	f357a0c52799563c7c7b76c1e7543a32</strong></p><p></p><p><strong>Cracking the hash</strong></p><p><img src="images/35-13.png" alt="images/35-13.png" /></p><p></p><p>Its mostly MD5 as others are pretty old.</p><p>We use <strong>hashcat</strong> to crack it</p><p><img src="images/35-14.png" alt="images/35-14.png" /></p><p></p><p>We will use the first highlighted one.</p><p><img src="images/35-15.png" alt="images/35-15.png" /></p><p></p><p></p><p><strong>Credentials Found:</strong></p><p><strong>Username	: 	r00t</strong></p><p><strong>Password	:	n100906</strong></p><p></p><p><strong><h2>Foothold</h2></strong></p><p></p><p>We try to SSH to the machine with the found credentials.</p><p><img src="images/35-16.png" alt="images/35-16.png" /></p><p></p><p></p><p>We found an intresting file called /usr/bin/docker which suggests a docker is running. We try to list the name</p><p></p><p><img src="images/35-17.png" alt="images/35-17.png" /></p><p></p><p>Now, we have the name. Lets try to escalate privilege in the docker enivronment using <strong>GTFObins</strong></p><p></p><p><img src="images/35-18.png" alt="images/35-18.png" /></p><p></p><p><strong><h2>Partial Privilege Escalation</h2></strong></p><p></p><p>We use the command. (replacing alpine with our docket image name)</p><p><strong>docker run -v /:/mnt --rm -it bash chroot /mnt sh</strong></p><p><img src="images/35-19.png" alt="images/35-19.png" /></p><p></p><p>Thanks!!</p><p></p></div>
</body>
</html>
