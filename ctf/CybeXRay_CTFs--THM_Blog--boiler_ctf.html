<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>boiler ctf</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>boiler ctf</h1><br/><strong><h1>THM: Boiler CTF</h1></strong><br /><br /><br /><strong><h2>Enumeration</h2></strong><br /><br /><strong>Rustscan &amp; Nmap</strong><br /><br /><strong>ports=$(rustscan -g -a 10.10.110.201 | cut -d &quot;[&quot; -f 2 | cut -d &quot;]&quot; -f 1)</strong><br /><img src="images/38-1.png" alt="images/38-1.png" /><br /><br /><strong>nmap -A -p$ports 10.10.110.201</strong><br /><img src="images/38-2.png" alt="images/38-2.png" /><br /><br /><strong>Browser Enumeration</strong><br />Robots.txt<br /><img src="images/38-3.png" alt="images/38-3.png" /><br /><br />Port 10000: HTTP gives error : HTTPS loads the page.<br /><img src="images/38-4.png" alt="images/38-4.png" /><br /><br /><br /><strong>FTP</strong><br /><img src="images/38-5.png" alt="images/38-5.png" /><br /><br />FTP server has no normal files. We need to dig deeper, so I looked for hidden files using <strong>&quot;ls -al&quot;</strong> and we found an <strong>.info.txt</strong> file<br /><br />File Contents:<br /><img src="images/38-6.png" alt="images/38-6.png" /><br /><br />We got an ecnoded message lets decode it. It looks like ROT13<br />I used cyberchef to decode the message.<br /><img src="images/38-7.png" alt="images/38-7.png" /><br /><br />As we can see, there is no relevant information regarding the machine here.<br /><br /><strong>Dirsearch</strong><br />I enumerated the http server to look for hidden directories and indeed we find a <strong>joomla</strong> CMS<br /><img src="images/38-8.png" alt="images/38-8.png" /><br /><br />Enumerating the CMS<br /><img src="images/38-9.png" alt="images/38-9.png" /><br /><br />We also find a joomla administrator page.<br /><img src="images/38-10.png" alt="images/38-10.png" /><br /><br />Next I proceeded to do a dirsearch on <strong>/joomla</strong> directory<br /><br /><strong>Dirsearch</strong><br /><img src="images/38-11.png" alt="images/38-11.png" /><br /><img src="images/38-12.png" alt="images/38-12.png" /><br /><br />Most of the folders had are blank or lead to some encoded strings with rabbit holes.<br />Example:<br /><img src="images/38-13.png" alt="images/38-13.png" /><br /><br /><img src="images/38-14.png" alt="images/38-14.png" /><br /><br /><br />But, one directory is intresting.<br /><strong>/joomla/_test</strong><br /><br /><img src="images/38-15.png" alt="images/38-15.png" /><br /><br />It is running <strong>sar2html</strong>, upon searching on google, there are entries in exploit-db for certain versions.<br />We need to check our sar2html version. I couldn&#39;t find any version info on the webpage. However, i clicked on the <strong>sar2ascii.tar</strong> link and it prompted me to download the file.<br /><br />I inspected the downloaded file locally.<br /><img src="images/38-16.png" alt="images/38-16.png" /><br /><br />The version is 3.2.1 and its a vulnerable version.<br /><br /><strong>https://www.exploit-db.com/exploits/49344</strong><br /><br /><img src="images/38-17.png" alt="images/38-17.png" /><br /><br />I created the python file with the above and have command execution.<br /><img src="images/38-18.png" alt="images/38-18.png" /><br /><br />I explorered the contents of the present directory<br /><img src="images/38-19.png" alt="images/38-19.png" /><br /><br />I enumerated further and found ssh credentials of a user in log.txt<br /><img src="images/38-20.png" alt="images/38-20.png" /><br /><br /><strong>SSH Credentials:</strong><br />Username:	<strong>basterd</strong><br />Password:	<strong>superduperp@$$</strong><br /><br /><br /><strong><h2>Foothold</h2></strong><br /><br />I SSH to the machine on port <strong>55007</strong><br /><br /><img src="images/38-21.png" alt="images/38-21.png" /><br /><br />I looked at home directory to find there is another user named <strong>stoner</strong><br />I found a <strong>backup.sh</strong> in the current directoruy and it contained the ssh credentials for <strong>stoner</strong>.<br /><br /><img src="images/38-22.png" alt="images/38-22.png" /><br /><br /><br /><strong>Note:</strong> I checked if basterd is having sudo permission. He doesn&#39;t have sudo permission<br /><br /><strong>SSH Credentials:</strong><br />Username:	<strong>stoner</strong><br />Password:	<strong>superduperp@$$no1knows</strong><br /><br />I SSH to the machine with the new credentials. I found 1 hidden file in the home directory. It is the user flag.<br /><br /><img src="images/38-23.png" alt="images/38-23.png" /><br /><br /><br />I checked for sudo access. There was none. Next i searched for SUID set bits executibles.<br /><img src="images/38-24.png" alt="images/38-24.png" /><br /><br /><br /><br />I found <strong>/usr/bin/find</strong> has SUID bit set. It can easily be used to get a <strong>euid root</strong> shell. Check <strong>GTFOBins</strong><br />Command: <strong>/usr/bin/find . -exec /bin/sh -p \; -quit</strong><br /><br /><img src="images/38-25.png" alt="images/38-25.png" /><br /><br />As we can see we have root access. (Partial)<br /><br /><br /><strong><h2>Extra</h2></strong><br /><br />Not Required for try hack me questions. <br /><br />Q&gt; How to get <strong>full root user</strong> access from <strong>euid root</strong><br /><br />Edit <strong>/etc/sudoers</strong> file and add an user which i have password( Or we need to create a password and replace in /etc/shadow file)<br />Then switch to that user and run <strong>sudo su</strong>..<br /><br /><br />Thanks !!<br /></div>
</body>
</html>
