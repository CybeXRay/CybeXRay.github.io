<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>simplectf</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>simplectf</h1><br/><strong><h1>THM Simple CTF</h1></strong><br /><br /><strong><h2>Enumeration</h2></strong><br /><br /><strong>Rustscan</strong><br /><img src="images/27-1.png" alt="images/27-1.png" /><br /><br /><strong>Nmap </strong><br /><img src="images/27-2.png" alt="images/27-2.png" /><br /><br /><br /><strong>FTP</strong><br /><img src="images/27-3.png" alt="images/27-3.png" /><br /><br />The contents of the file<br /><img src="images/27-4.png" alt="images/27-4.png" /><br /><br />It gives a hint that the web password and system password might be same.<br /><br /><strong>Website Emuneration</strong><br /><img src="images/27-5.png" alt="images/27-5.png" /><br /><br /><br /><br />The following CMS was found<br /><img src="images/27-6.png" alt="images/27-6.png" /><br /><br />We get version information at bottom of page.<br /><img src="images/27-7.png" alt="images/27-7.png" /><br /><br /><br />We further enumerate this.<br /><img src="images/27-8.png" alt="images/27-8.png" />\<br /><br />We get the following admin login page.<br /><img src="images/27-9.png" alt="images/27-9.png" /><br /><br />We search the vulnerable version exploit.<br /><img src="images/27-10.png" alt="images/27-10.png" /><br /><br />We will use searchsploit and run this. (Note: We need <strong>python2</strong>)<br /><br /><img src="images/27-11.png" alt="images/27-11.png" /><br /><br />We will use the highlighted one.<br /><strong>searchsploit -m php/webapps/46635.py</strong><br /><img src="images/27-12.png" alt="images/27-12.png" /><br /><br /><br />We will run in a fresh terminal as it will expand it to max.<br /><img src="images/27-13.png" alt="images/27-13.png" /><br /><br /><br /><strong>python2 46635.py -u http://10.10.223.252/simple/ --crack -w /usr/share/seclists/Passwords/Common-Credentials/best110.txt</strong><br />We use the wordlist provided in the hint.<br /><br /><img src="images/27-14.png" alt="images/27-14.png" /><br /><br />We got the web credentials as follows:<br /><strong>Username:  	mitch<br />Password:		secret</strong><br /><br /><strong><h2>Foothold</h2></strong><br /><br />We use the found credentials to ssh into the machine. We were successful and find the user flag.<br /><br /><img src="images/27-15.png" alt="images/27-15.png" /><br /><br /><strong><h2>Privilege Escalation</h2></strong><br /><br />We search for sudo permissions and find that mitch is allowed to run <strong>/usr/bin/vim</strong> as <strong>sudo</strong><br />We open <strong>sudo /usr/bin/vim</strong> and run the following command to get a root shell.<br /><strong>:!/bin/bash</strong><br /><br /><img src="images/27-16.png" alt="images/27-16.png" /><br />Inside Vim<br /><img src="images/27-17.png" alt="images/27-17.png" /><br /><br />We got root shell<br /><img src="images/27-18.png" alt="images/27-18.png" /><br />We get the root flag in /root directory.<br /><br />Thanks !!</div>
</body>
</html>
