<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>rootme</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>rootme</h1><br/><p><strong><h1>THM RootMe</h1></strong><span style="text-decoration:underline;"></span></p><p><span style="text-decoration:underline;"></span></p><p></p><p><strong><h2>Enumeration</h2></strong></p><p></p><p><strong>Rustscan to find out open ports.</strong></p><p></p><p>rustscan -a 10.10.132.11 </p><p></p><p><img src="images/23-1.png" alt="images/23-1.png" /></p><p></p><p><strong>Nmap for Details</strong></p><p></p><p><img src="images/23-2.png" alt="images/23-2.png" /></p><p></p><p></p><p><strong>Dirsearch the Website</strong></p><p></p><p><img src="images/23-3.png" alt="images/23-3.png" /></p><p></p><p><img src="images/23-4.png" alt="images/23-4.png" /></p><p></p><p>We find 2 intresting directories <strong>panel</strong> &amp; <strong>uploads</strong></p><p></p><p><strong>Enumerating the directories</strong></p><p></p><p><img src="images/23-5.png" alt="images/23-5.png" /></p><p></p><p><img src="images/23-6.png" alt="images/23-6.png" /></p><p></p><p>Upon viewing wappalyzer, we confirm that php is running on the server. We will try to upload a malicious php file and open it to check if php code is being executed or not. We will use a php-reverse-shell (For Linux - Confirmed in nmap)</p><p></p><p><strong><h2>Foothold</h2></strong></p><p></p><p>we upload a php-reverse-shell. (Check <strong>CybeXRay Guides ------→ Shells -----→ PHP Reverse Shell</strong>)</p><p> </p><p> We get a portuguese message that php is not allowed.</p><p> <img src="images/23-7.png" alt="images/23-7.png" /></p><p> </p><p><img src="images/23-8.png" alt="images/23-8.png" /></p><p></p><p></p><p>We then use phtml to bypass the .php blocker. upload was successful.</p><p>Renamed the file from .php to .phtml</p><p></p><p><img src="images/23-9.png" alt="images/23-9.png" /></p><p></p><p><img src="images/23-10.png" alt="images/23-10.png" /></p><p><img src="images/23-11.png" alt="images/23-11.png" /></p><p></p><p>We start <strong>netcat listener</strong> and open the <strong>http://10.10.132.11/uploads/</strong>  and open the <strong>phtml file</strong>. We will receive a shell as below.</p><p></p><p><img src="images/23-12.png" alt="images/23-12.png" /></p><p></p><p><img src="images/23-13.png" alt="images/23-13.png" /></p><p></p><p></p><p><strong>Finding the user flag</strong></p><p></p><p></p><p>find / -type f -name user.txt 2&gt;/dev/null</p><p></p><p><img src="images/23-14.png" alt="images/23-14.png" /></p><p></p><p></p><p><strong><h2>Privilege Escalation</h2></strong></p><p></p><p>We search files with <strong>suid</strong> set.</p><p></p><p>find / type f -perm -u=s 2&gt;/dev/null</p><p></p><p><img src="images/23-15.png" alt="images/23-15.png" /></p><p></p><p>As we see, /usr/bin/python can be run with root privileges, we can easily get a root shell by the following,</p><p></p><p><strong>/usr/bin/python -c  ‘import os;os.execl(&quot;/bin/sh&quot;, “sh”, “-p”)’</strong></p><p></p><p><img src="images/23-16.png" alt="images/23-16.png" /></p><p></p><p>We get the root flag inside the /root folder.</p><p></p><p>Thanks!!</p></div>
</body>
</html>
