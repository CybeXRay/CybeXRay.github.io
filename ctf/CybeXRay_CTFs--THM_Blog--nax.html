<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>nax</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>nax</h1><br/><strong><h1>THM: Nax</h1></strong><br /><br /><strong><h2>Enumeration</h2></strong><br /><br /><strong>Rustscan</strong><br /><img src="images/30-1.png" alt="images/30-1.png" /><br /><br /><strong>Nmap</strong><br /><img src="images/30-2.png" alt="images/30-2.png" /><br /><br /><br /><strong>Dirbuster</strong><br /><img src="images/30-3.png" alt="images/30-3.png" /><br /><br />Opening the /nagios<br /><img src="images/30-4.png" alt="images/30-4.png" /><br /><br /><br /><br /><strong>Webpage Source</strong><br /><img src="images/30-5.png" alt="images/30-5.png" /><br /><br /><strong>Going to the link in view source.</strong><br /><img src="images/30-6.png" alt="images/30-6.png" /><br /><br /><strong>Webpage Enumeration</strong><br /><img src="images/30-7.png" alt="images/30-7.png" /><br /><br />Ag – Hg – Ta – Sb – Po – Pd – Hg – Pt – Lr<br />47 – 80 – 73 – 51 – 84 – 46 – 80 – 78 – 103<br /><br />Above are the element&#39;s number in periodic table.<br />We convert the above from ASCII to Text Oniline.<br /><br /><br /><img src="images/30-8.png" alt="images/30-8.png" /><br /><br />Enumerating the new location found. (<strong>/PI3T.PNg</strong>)<br /><img src="images/30-9.png" alt="images/30-9.png" /><br /><br />We downloaded the PNG file and checked with <strong>exiftool</strong>. Indeed it shows binary content<br /><img src="images/30-10.png" alt="images/30-10.png" /><br /><br />We got one answer though: <strong>Creator of File - Piet Mondrian</strong><br />Binwalk also didn&#39;t give any particular results.<br /><br /><img src="images/30-11.png" alt="images/30-11.png" /><br /><br />Then, we searched online for <strong>PIET steganography</strong> &amp; looked for decoder.<br /><strong>Note:</strong> <strong>Piet</strong> as an esoteric language where code looks like abstract geometric pictures<br /><br />We will use this link: <strong>https://www.bertnase.de/npiet/npiet-execute.php</strong> <br /><br /><img src="images/30-12.png" alt="images/30-12.png" /><br /><br />The online site was showing errors. (As it needs the Picture in <strong>PPM</strong> format &amp; within a certain <strong>size</strong>)<br /><strong>Windows</strong><br />Windows executiblle does not need ppm format. We downloaded the windows executible and opened the <strong>PI3T.PNg</strong> file.<br /><img src="images/30-13.png" alt="images/30-13.png" /><br /><br /><strong>Linux</strong><br />To install <strong>npiet</strong> in linux. Get the <strong>www.bertnase.de/npiet/npiet-1.3f.tar.gz</strong> compressed source code<br />First install the required library from <strong>https://github.com/libgd/libgd/releases</strong> by gettin the release <strong>libgd-2.3.3.tar.gz</strong><br /><br />To install both the source code. (First install the libgd library)<br />Use the following insdie the respective folders. (Preferably in /opt)<br /><br /><strong>./configure<br />make<br />make install</strong><br /><br />To Uninstall<br /><strong>make uninstall</strong><br /><br /><strong>Note:</strong> In Linux, the <strong>.PNG</strong> format won&#39;t work. We need to convert it to <strong>.PPM</strong><br />Open the PNG file in <strong>gimp</strong> and then export it to PPM format<br /><br />We run as follows:<br /><img src="images/30-14.png" alt="images/30-14.png" /><br /><br /><br />From both the run instances, we found long series of text which is repeated. Following is the string<br /><strong>nagiosadmin%n3p3UQ&amp;9BjLp4$7uhWdY</strong><br /><br />Credentials Found<br /><strong>Username:	nagiosadmin<br />Password:		n3p3UQ&amp;9BjLp4$7uhWdY</strong><br /><br /><br />We try to use the same in the Login pages we found earlier.<br /><img src="images/30-15.png" alt="images/30-15.png" />                                                                                                                                                                                                                                                                                                                     <br />We got inside the Nagios dashboard<br /><img src="images/30-16.png" alt="images/30-16.png" /><br /><br /><br />Nagios Version: Found at left bottom of Nagios XI Dashboard<br /><img src="images/30-17.png" alt="images/30-17.png" /><br /><br /><strong><h2>Foothold With Elevated Privileges</h2></strong><br /><br />Using Searchsploit we found the exploit.<br /><img src="images/30-18.png" alt="images/30-18.png" /><br /><br />We will use metasploit as the exploit is indeed present in it.(see the highlight above)<br />We searched the CVE in google<br /><img src="images/30-19.png" alt="images/30-19.png" /><br /><br />Exploit Used:<br /><strong>exploit/linux/http/nagios_xi_plugins_check_plugin_authenticated_rce</strong><br /><br />Options Set:<br /><img src="images/30-20.png" alt="images/30-20.png" /><br /><br />After Running, we get root access.<br /><img src="images/30-21.png" alt="images/30-21.png" /><br /><br />We get the flags and complete the machine.<br /><br /><img src="images/30-22.png" alt="images/30-22.png" /><br /><br />Thanks!!<br /><br /></div>
</body>
</html>
