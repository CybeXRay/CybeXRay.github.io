<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>biohazard</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>biohazard</h1><br/><br /><br /><strong>Rustscan &amp; Nmap</strong><br />‚îå‚îÄ‚îÄ(rootüíÄmatrix)-[~]<br />‚îî‚îÄ# rustscan -g -a 10.10.123.187<br />10.10.123.187 -&gt; [21,22,80]<br /><br /><img src="images/37-1.png" alt="images/37-1.png" /><br /><br /><strong>Website Enumeration</strong><br /><img src="images/37-2.png" alt="images/37-2.png" /><br /><br />Click on the mansion link. We go to <strong>http://10.10.123.187/mansionmain/</strong> <br /><br /><img src="images/37-3.png" alt="images/37-3.png" /><br /><br />A question was asked. We view source to look for clues.<br /><img src="images/37-4.png" alt="images/37-4.png" /><br /><br />We get the answer: <strong>/diningRoom</strong><br />Using the above directory<br /><br /><img src="images/37-5.png" alt="images/37-5.png" /><br /><br /><br /><br /><br />We click on <strong>YES</strong><br /><img src="images/37-6.png" alt="images/37-6.png" /><br /><br /><br /><br />Looks like we got the <strong>emblem flag</strong> along with instruction to reload the <strong>/diningRoom</strong> page.<br />The reloaded page.<br /><img src="images/37-7.png" alt="images/37-7.png" /><br /><br /><br /><br />Now we get a input field which asks for the imput flag. We put the <strong>emblem flag</strong> in it and <strong>submit</strong>.<br />However, we went to a deadend. (Nothing happened page)<br /><img src="images/37-8.png" alt="images/37-8.png" /><br /><br /><br /><br /><br />Then we go back to the<strong> /dinningRoom</strong> and view its source<br /><img src="images/37-9.png" alt="images/37-9.png" /><br /><br /><br /><br />We decode it and get a hint about <strong>/teaRoom</strong><br /><img src="images/37-10.png" alt="images/37-10.png" /><br /><br /><br /><br />Lets open <strong>/teaRoom</strong><br /><img src="images/37-11.png" alt="images/37-11.png" /><br /><br /><br /><br />We get a <strong>Lockpick Link</strong> and another room as hint <strong>/artRoom</strong><br /><img src="images/37-12.png" alt="images/37-12.png" /><br /><br /><br /><br />We get the <strong>lock_pick Flag</strong>. We head to <strong>/artRoom</strong><br /><img src="images/37-13.png" alt="images/37-13.png" /><br /><br /><br />We click <strong>YES</strong><br /><img src="images/37-14.png" alt="images/37-14.png" /><br /><br />We got a map of the <strong>mansion</strong><br /><br />Lets go through the new rooms sequentially.<br />First we enter <strong>/barRoom</strong><br /><br /><img src="images/37-15.png" alt="images/37-15.png" /><br />We use the <strong>lock_pick flag</strong> here and submit. It unlocked the <strong>barRoom</strong><br />Flag Used: <strong>lock_pick{037b35e2ff90916a9abf99129c8e1837}</strong><br /><br /><img src="images/37-16.png" alt="images/37-16.png" /><br />We have a <strong>READ</strong> link. We will open it.<br /><br /><br /><img src="images/37-17.png" alt="images/37-17.png" /><br />Looks like we got a decoded music note.<br />We decode it using base-32<br /><br /><img src="images/37-18.png" alt="images/37-18.png" /><br /><br />We used the above music to <strong>play the piano</strong> and submit.<br />Flag Used: <strong>music_sheet{362d72deaf65f5bdc63daece6a1f676e}</strong><br /><br /><img src="images/37-19.png" alt="images/37-19.png" /><br />We landed on a secret bar room and we take the <strong>gold emblem</strong> by clicking <strong>YES</strong><br /><br /><br /><img src="images/37-20.png" alt="images/37-20.png" /><br />It gives us <strong>gold_emblem</strong> flag and instructs to refresh the previous page.<br /><br /><img src="images/37-21.png" alt="images/37-21.png" /><br />Upon Refreshing the previous page we are asked to enter an emblem flag. (We just have one such which we had found first in the /diningRoom)<br />Flag Used: <strong>emblem{fec832623ea498e20bf4fe1821d58727}</strong><br /><br /><img src="images/37-22.png" alt="images/37-22.png" /><br /><br />We got a name: <strong>rebecca</strong><br />Also I remembered that <strong>/diningRoom</strong> had an input field that did not work with the normal emblem flag. Lets try the <strong>gold emblem flag</strong> there.<br /><img src="images/37-23.png" alt="images/37-23.png" /><br />We entered the <strong>gold emblem flag</strong> and hit submit.<br />Flag Used: <strong>gold_emblem{58a8c41a9d08b8a4e38d02a4d7ff4843}</strong><br /><br /><img src="images/37-24.png" alt="images/37-24.png" /><br />We got yet more encoded information. <br />I checked the encoded information in <strong>cyberchef</strong>. After trying for some time. I found that the instruction was encoded with <strong>Vigenere Cipher</strong><br />It asked for a key. (I entered the plain text name ‚Äú<strong>rebecca</strong>‚Äù we had found in the<strong> secret bar room</strong>)<br />The message was successfully decoded. We are instructed to go to <strong>the_great_shield_key</strong> inside the <strong>/diningRoom</strong><br /><img src="images/37-25.png" alt="images/37-25.png" /><br /><br />We opened the instructed page.<br /><img src="images/37-26.png" alt="images/37-26.png" /><br />We got the <strong>shield_key</strong> flag<br /><br />We move on to <strong>/diningRoom2F</strong><br /><img src="images/37-27.png" alt="images/37-27.png" /><br />Nothing Important here. So we view its source.<br /><br /><br /><img src="images/37-28.png" alt="images/37-28.png" /><br /><br />We found some encoded information. [Its looks like rot13 where alphabets are shifted 13 charecters.]<br />I used an universal online encoder/decoder (<strong>https://www.scopulus.co.uk/tools/hexconverter.htm</strong>) to decode the information.<br /><img src="images/37-29.png" alt="images/37-29.png" /><br /><br /><br />We tried various decoding formats. As expected using <strong>rot13</strong> we decoded the message successfully.<br /><strong>You get the blue gem by pushing the status to the lower floor. The gem is on the diningRoom first floor. Visit sapphire.html</strong><br /><br /><br />As instructed in the message. We go <strong>/diningRoom</strong> and into<strong> /sapphire.html</strong><br /><img src="images/37-30.png" alt="images/37-30.png" /><br />We got the <strong>blue_gem</strong> flag<br /><br /><br />Next, we continue to explore other rooms. We go to <strong>/tigerStatusRooom</strong><br /><img src="images/37-31.png" alt="images/37-31.png" /><br />It asks for a gem. Lets try to put the <strong>blue_gem</strong> flag here.<br /><br /><br /><img src="images/37-32.png" alt="images/37-32.png" /><br />We got the above message. We need to find <strong>4 </strong>such <strong>crests</strong> and <strong>combine</strong> them then <strong>decode</strong> them to reveal some path.<br />Also it says each crest is encoded twice.<br /><br />Therefore I decoded the crest 2 times and got our <strong>first crest part</strong>.<br />I took the help of cyberchef&#39;s magic method to determine the encryption.<br /><br /><img src="images/37-33.png" alt="images/37-33.png" /><br />(14 Charecters)<br />Crest 1: <strong>RlRQIHVzZXI6IG</strong><br /><br />We continue to next room. We now got to the <strong>/galleryRoom</strong><br /><img src="images/37-34.png" alt="images/37-34.png" /><br />I click on <strong>Examine</strong><br /><br /><br /><img src="images/37-35.png" alt="images/37-35.png" /><br />We got the second crest. We decoded it twice and have the <strong>second crest part</strong><br />We tried a lot with <strong>cyberchef</strong>. I din&#39;t find any solution. So i used the <strong>magic</strong> decoder.<br /><br /><img src="images/37-36.png" alt="images/37-36.png" /><br />It suggests first base32 is used to decode.<br />then base58 decoding is done.<br /><br />We do the same in terminal. We get the crest 2 output.<br /><img src="images/37-37.png" alt="images/37-37.png" /><br /><br />(18 Charecters)<br />Crest 2: <strong>h1bnRlciwgRlRQIHBh</strong><br /><br /><br />We moved on the next room. We go to <strong>/studyRoom</strong>.<br /><img src="images/37-38.png" alt="images/37-38.png" /><br /><br /><br />It asks for a <strong>helmet</strong> symbol. We do not have any such flags<br />We move on the next room. We enter <strong>/armorRoom/</strong><br /><br /><img src="images/37-39.png" alt="images/37-39.png" /><br /><br /><br />It asks for a <strong>shield</strong> symbol. We do not have any such flags<br />We enter the shield flag here.<br /><br />Flag Used: <strong>shield_key{48a7a9227cd7eb89f0a062590798cbac}</strong><br /><br /><img src="images/37-40.png" alt="images/37-40.png" /><br />We click on the <strong>READ</strong><br /><br /><img src="images/37-41.png" alt="images/37-41.png" /><br />We found the <strong>crest 3</strong>. We will decode it and keep it as the <strong>third crest part</strong><br />As usual we try to decode it with cyberchef&#39;s magic method. We found 3 encryptions used.<br /><br />3 Times Encoded: base64 ‚Üí binary ‚Üí hex<br /><img src="images/37-42.png" alt="images/37-42.png" /><br />we get the output<br /><br />(19 Charecters)<br />Crest 3: <strong>c3M6IHlvdV9jYW50X2h</strong><br /><br /><br />We move on the next room. We enter <strong>/attic/</strong><br /><br /><img src="images/37-43.png" alt="images/37-43.png" /><br /><br />It asks for a <strong>shield</strong> symbol. We do not have any such flags<br /><br />Flag Used: <strong>shield_key{48a7a9227cd7eb89f0a062590798cbac}</strong><br /><br /><img src="images/37-44.png" alt="images/37-44.png" /><br /><br />We click on <strong>READ</strong><br />and got the <strong>fourth crest part</strong><br /><img src="images/37-45.png" alt="images/37-45.png" /><br /><br />We use cyberchef again.<br /><img src="images/37-46.png" alt="images/37-46.png" /><br /><br />(17 Charecters)<br />Crest 4: <strong>pZGVfZm9yZXZlcg==</strong><br /><br />Now, we have all the 4 crests and decoded them.<br />Lets combine all of them<br /><br />crest 1 + crest 2 + crest 3 + crest 4<br /><br /><strong>RlRQIHVzZXI6IGh1bnRlciwgRlRQIHBhc3M6IHlvdV9jYW50X2hpZGVfZm9yZXZlcg==</strong><br /><br />We decode this:<br /><img src="images/37-47.png" alt="images/37-47.png" /><br /><br /><br /><strong>FTP Credentials Found</strong><br />Username	:	<strong>hunter</strong><br />Password		:	<strong>you_cant_hide_forever</strong>	<br /><br /><br /><img src="images/37-48.png" alt="images/37-48.png" /><br /><br /><br />We get all the files locally and inspect them.<br /><br /><img src="images/37-49.png" alt="images/37-49.png" /><br /><br />Lets check the hidden directory <strong>/hidden_closet</strong><br /><br /><img src="images/37-50.png" alt="images/37-50.png" /><br /><br />I then focus on the <strong>helmet_key.txt.gpg</strong> file. This file should contain the flag.<br />We use the following command to decrypt the file. But it asks for a paraphrase.<br /><br /><strong>gpg --decrypt helmet_key.txt.gpg </strong><br /><br /><img src="images/37-51.png" alt="images/37-51.png" /><br /><br />We do not have a paraphrase currently so we cancel it. <br />Following is the terminal output.<br /><br /><img src="images/37-52.png" alt="images/37-52.png" /><br /><br /><br />We then check all the pictures and look for a paraphrase.<br /><br /><strong>1st Picture: 001-key.jpg</strong><br /><img src="images/37-53.png" alt="images/37-53.png" /><br /><br />We the extract the <strong>key-001.txt</strong> using the following.<br /><img src="images/37-54.png" alt="images/37-54.png" /><br /><br />key-001.txt: <strong>cGxhbnQ0Ml9jYW</strong><br /><br /><strong>2nd Picture: 002-key.jpg</strong><br /><img src="images/37-55.png" alt="images/37-55.png" /><br /><br />key-002.txt: <strong>5fYmVfZGVzdHJveV9</strong><br /><br /><strong>3rd Picture: 003-key.jpg</strong><br /><img src="images/37-56.png" alt="images/37-56.png" /><br /><br />It seems that <strong>003-key.jpg</strong> has hidden data<br />We thus extract the components<br /><br /><img src="images/37-57.png" alt="images/37-57.png" /><br /><br /><br />We then explore the extracted directory: <strong>_003-key.jpg.extracted</strong><br /><br /><img src="images/37-58.png" alt="images/37-58.png" /><br /><br /><br />key-003.txt: <strong>3aXRoX3Zqb2x0</strong><br /><br /><br />Let us combine all the 3 keys found from the 3 images:<br /><br /><strong>cGxhbnQ0Ml9jYW5fYmVfZGVzdHJveV93aXRoX3Zqb2x0</strong><br /><br />We try to decode it using base64 (Got hint from <strong>cyberchef</strong>)<br /><br /><img src="images/37-59.png" alt="images/37-59.png" /><br />Paraphrase Found: <strong>plant42_can_be_destroy_with_vjolt</strong><br /><br /><br />Lets decrypt the <strong>helmet_key.txt.gpg</strong> file with the found paraphrase.<br /><strong>gpg --decrypt helmet_key.txt.gpg</strong><br /><br />It was successfully decrypted. Following is the <strong>helmet_key</strong> flag.<br /><img src="images/37-60.png" alt="images/37-60.png" /><br /><br /><br /><br />Now, that we have the <strong>helmet_key</strong> we can open 2 previously locked rooms.<br /><br /><strong>/studyRoom<br />/hidden_closet</strong><br /><br />Lets open each of them witht the <strong>helmet_key</strong>.<br /><br /><strong>Enumerating: /studyRoom</strong><br />We open the <strong>/studyRoom</strong><br /><img src="images/37-61.png" alt="images/37-61.png" /><br /><br /><br />We click on <strong>EXAMINE</strong>. We get a <strong>doom.tar.gz</strong> file. We download it to our local machine.<br />Lets examine the file.<br /><br /><img src="images/37-62.png" alt="images/37-62.png" /><br /><br />We got a SSH User: <strong>umbrella_guest</strong><br /><br /><br /><br /><strong>Enumerating: /hidden_closet</strong><br />Next, lets enumerate the <strong>/hidden_closet</strong> directory and open it with the <strong>helmet_key</strong><br /><br /><img src="images/37-63.png" alt="images/37-63.png" /><br /><br />We click on <strong>READ</strong> &amp; <strong>EXAMINE</strong><br /><br /><strong>READ</strong><br /><img src="images/37-64.png" alt="images/37-64.png" /><br />Above is the contents of MO disk 1<br />We know similar encryption was solved before. <strong>(Vigenere cipher)</strong><br />But we had a key. Presently there seems to be no keys.<br /><strong><br /></strong><br /><strong>EXAMINE</strong><br /><img src="images/37-65.png" alt="images/37-65.png" /><br />Above is the contents of wolf_medal<br />We got a SSH Password:	<strong>T_virus_rules</strong><br /><br /><br />SSH Credentials<br />Username	:	<strong>umbrella_guest</strong>	<br />Password		:	<strong>T_virus_rules</strong><br /><br /><strong><h2>Foothold</h2></strong><br /><br />We SSH into the machine with the above credentials and enumerate further.<br /><br /><img src="images/37-66.png" alt="images/37-66.png" /><br /><br />We get the whereabouts of <strong>Chris</strong><br />It also tells that <strong>Weasker</strong> is the traitor<br /><br />We also got the <strong>MO disk 2</strong> : albert<br />Maybe we can use this to decrypt the <strong>MO disk 1</strong> : wpbwbxr wpkzg pltwnhro, txrks_xfqsxrd_bvv_fy_rvmexa_ajk<br /><br />We use cyberchef again with the new found key.<br /><img src="images/37-67.png" alt="images/37-67.png" /><br />We cracked the contents.<br />We got: <strong>weasker login password, stars_members_are_my_guinea_pig</strong><br /><br /><br />SSH Credentials<br />Username	: 	<strong>weasker</strong><br />Password		:	<strong>stars_members_are_my_guinea_pig</strong><br /><br />Then we login with the new SSH credential.<br /><br /><img src="images/37-68.png" alt="images/37-68.png" /><br /><br />We also got the name of the ultimate lifeform: <strong>Tyrant</strong><br />We get the root flag at /root.<br /><img src="images/37-69.png" alt="images/37-69.png" /><br /><br />Thanks!!<br /><br /></div>
</body>
</html>
