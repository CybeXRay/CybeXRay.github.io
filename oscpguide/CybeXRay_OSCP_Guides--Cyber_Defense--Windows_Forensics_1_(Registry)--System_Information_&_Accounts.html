<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>System Information & Accounts</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>System Information & Accounts</h1><br/><strong><h1>System Information and System Accounts</h1></strong><br /><br /><br />Now that we have learned how to read registry data, let&#39;s find out where to look in the registry to perform our forensic analysis.<br /><br />When we start performing forensic analysis, the first step is to find out about the system information. This task will cover gathering information related to a machine&#39;s System and Account information.<br /><br /><strong><h2>OS Version:</h2></strong><br />If we only have triage data to perform forensics, we can determine the OS version from which this data was pulled through the┬áregistry. To find the OS version, we can use the following registry key:<br /><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SOFTWARE\Microsoft\Windows NT\CurrentVersion</strong><br /><br /><br /><strong><h2>Current control set:</h2></strong><br /><br />The hives containing the machine’s configuration data used for controlling system startup are called Control Sets. Commonly, we will see two Control Sets, ControlSet001 and ControlSet002, in the SYSTEM hive on a machine. In most cases, ControlSet001 will point to the Control Set that the machine booted with, and ControlSet002 will be the last known good configuration. Their locations will be:<br /><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SYSTEM\ControlSet001</strong><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SYSTEM\ControlSet002</strong><br /><br />Windows creates a volatile Control Set when the machine is live, called the <em>CurrentControlSet</em> (<strong>HKLM\SYSTEM\CurrentControlSet</strong>). For getting the most accurate system information, this is the hive that we will refer to. We can find out which Control Set is being used as the CurrentControlSet by looking at the following registry value:<br /><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SYSTEM\Select\Current</strong><br /><br />Similarly, the last known good configuration can be found using the following registry value:<br /><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SYSTEM\Select\LastKnownGood</strong><br /><br /><br /><strong><h2>Computer Name:</h2></strong><br /><br />It is crucial to establish the Computer Name while performing forensic analysis to ensure that we are working on the machine we are supposed to work on. We can find the Computer Name from the following location:<br /><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName</strong><br /><br /><br /><strong><h2>Time Zone Information:</h2></strong><br /><br />For accuracy, it is important to establish what time zone the computer is located in. This will help us understand the chronology of the events as they happened. For finding the Time Zone Information, we can look at the following location:<br /><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SYSTEM\CurrentControlSet\Control\TimeZoneInformation</strong><br /><br /><br /><strong><h2>Network Interfaces and Past Networks:</h2></strong><br /><br />The following registry key will give a list of network interfaces on the machine we are investigating:<br /><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces</strong><br /><br /><strong>Note:</strong> Each Interface is represented with a unique identifier (GUID) subkey, which contains values relating to the interface’s TCP/IP configuration. This key will provide us with information like IP addresses, DHCP IP address and Subnet Mask, DNS Servers, and more. This information is significant because it helps you make sure that you are performing forensics on the machine that you are supposed to perform it on.<br /><br /><br /><em>The past networks a given machine was connected to can be found in the following locations:</em><br /><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Unmanaged</strong><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Managed</strong><br /><br />These registry keys contain past networks as well as the last time they were connected. The last write time of the registry key points to the last time these networks were connected.<br /><br /><br /><strong><h2>Autostart Programs (Autoruns):</h2></strong><br /><br />The following registry keys include information about programs or commands that run when a user logs on. <br /><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Run</strong><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\RunOnce</strong><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce</strong><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SOFTWARE\Microsoft\Windows\CurrentVersion\policies\Explorer\Run</strong><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SOFTWARE\Microsoft\Windows\CurrentVersion\Run</strong><br /><br /><br />The following registry key contains information about <strong>services</strong>:<br /><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SYSTEM\CurrentControlSet\Services</strong><br /><br /><strong>Note:</strong> In this registry key, if the <strong>start</strong> key is set to <strong>0x02</strong>, this means that this service will start at boot.<br /><br /><strong><h2>SAM hive and user information:</h2></strong><br /><br />The SAM hive contains user account information, login information, and group information. This information is mainly located in the following location:<br /><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SAM\Domains\Account\Users</strong><br /><br /></div>
</body>
</html>
