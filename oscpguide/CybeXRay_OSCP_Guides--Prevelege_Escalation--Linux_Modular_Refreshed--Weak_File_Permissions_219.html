<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Weak File Permissions</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Weak File Permissions</h1><br/><p><strong><h1>Weak File Permissions</h1></strong></p><p></p><p><strong><h2>A) Readable /etc/shadow</h2></strong></p><p></p><p>The /etc/shadow file contains user password hashes and is usually readable only by the root user.</p><p></p><p><strong>Note </strong>that the /etc/shadow file on the VM is world-readable:</p><p></p><p><strong>ls -l /etc/shadow</strong></p><p></p><p>View the contents of the /etc/shadow file:</p><p></p><p><strong>cat /etc/shadow</strong></p><p></p><p>Each line of the file represents a user. A user&#39;s password hash (if they have one) can be found between the first and second colons (:) of each line.</p><p></p><p>Save the root user&#39;s hash to a file called <strong>hash.txt</strong> on your Kali VM and use <strong>john the ripper</strong> to crack it. You may have to unzip /usr/share/wordlists/rockyou.txt.gz first and run the command using sudo depending on your version of Kali:</p><p></p><p><strong>john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt</strong></p><p></p><p>Switch to the root user, using the cracked password:</p><p></p><p><strong>su root</strong></p><p></p><p><strong>Example:</strong></p><p><img src="images/219-1.png" alt="images/219-1.png" /></p><p></p><p>Now in Kali</p><p><img src="images/219-2.png" alt="images/219-2.png" /></p><p></p><p></p><p><strong><h2>B) Writable /etc/shadow</h2></strong></p><p></p><p>The /etc/shadow file contains user password hashes and is usually readable only by the root user.</p><p></p><p><strong>Note </strong>that the /etc/shadow file on the VM is world-writable:</p><p></p><p><strong>ls -l /etc/shadow</strong></p><p></p><p>Generate a new password hash with a password of your choice:</p><p></p><p><strong>mkpasswd -m sha-512 newpasswordhere</strong></p><p>or</p><p><strong>openssl passwd -6 -salt custom_salt newpasswordhere</strong></p><p></p><p><strong>Edit</strong> the<strong> /etc/shadow</strong> file and replace the original root user&#39;s password hash with the one you just generated.</p><p></p><p>Switch to the root user, using the new password:</p><p></p><p><strong>su root</strong></p><p></p><p><strong>Example:</strong></p><p><img src="images/219-3.png" alt="images/219-3.png" /></p><p>Next, we will edit the /etc/shadow file and add these passwords for root user and login with Password1234</p><p></p><p></p><p><strong><h2>C) Writable /etc/passwd</h2></strong></p><p></p><p>The /etc/passwd file contains information about user accounts. It is world-readable, but usually only writable by the root user. Historically, the /etc/passwd file contained user password hashes, and some versions of Linux will still allow password hashes to be stored there.</p><p></p><p><strong>Note</strong> that the /etc/passwd file is world-writable:</p><p></p><p><strong>ls -l /etc/passwd</strong></p><p></p><p>Generate a new password hash with a password of your choice:</p><p></p><p><strong>openssl passwd newpasswordhere</strong></p><p>It creates a MD5 hash($1$)</p><p></p><p>Edit the <strong>/etc/passwd</strong> file and place the generated<strong> password hash </strong>between the <strong>first</strong> and <strong>second</strong> colon <strong>(:)</strong> of the <strong>root user&#39;s row</strong> (replacing the <strong>&quot;x&quot;</strong>).</p><p></p><p>Switch to the root user, using the new password:</p><p><strong>su root</strong></p><p></p><p><strong>Alternatively</strong>, <strong>copy</strong> the root user&#39;s row and append it to the bottom of the file, changing the first instance of the word &quot;<strong>root</strong>&quot; to &quot;<strong>newroot</strong>&quot; and placing the generated password hash between the first and second colon (replacing the &quot;x&quot;).</p><p></p><p>Now switch to the newroot user, using the new password:</p><p></p><p><strong>su newroot</strong></p><p></p><p></p><p><strong><h2>END</h2></strong></p></div>
</body>
</html>
