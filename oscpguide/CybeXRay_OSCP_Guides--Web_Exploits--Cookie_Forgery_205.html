<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Cookie Forgery</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Cookie Forgery</h1><br/><p><strong><h3>Cookie Forgery (Enumeration - Not Successful)</h3></strong> </p><p></p><p>I opened the site with Burpsuite and logged in as a freshly created user (Sign up). I noticed that the requests after login are done using cookies. I will try to forge a admin cookie so that i can access the <strong>/admin</strong> location.</p><p></p><p><strong>Following are the steps:</strong> </p><p></p><p>1. Create a user with some password in the <strong>Sign up</strong></p><p>	<strong>Site User</strong></p><p>	Username: <strong>Bob</strong></p><p>	Password: <strong>12345</strong>	</p><p>	</p><p>2. Go to <strong>Login</strong> and login to the site using the above user.</p><p>	</p><p>	<img src="images/205-1.png" alt="images/205-1.png" /></p><p></p><p>3. Record this in <strong>Burpsuite</strong> to get the <strong>cookie</strong>.</p><p>	<strong>Login Request</strong></p><p>	<img src="images/205-2.png" alt="images/205-2.png" />	</p><p>	</p><p>	<strong>Login Response</strong> with the cookie for Bob</p><p>	<img src="images/205-3.png" alt="images/205-3.png" /></p><p>	</p><p>	Or</p><p>	</p><p>	we can harvest the cookie from the <strong>Cookie Editor</strong> tool in firefox after loggin in as Bob.</p><p>	<strong>Link</strong> to Cookie Editor Tool â†’ <strong>https://addons.mozilla.org/en-US/firefox/addon/cookie-editor/</strong> </p><p>	<img src="images/205-4.png" alt="images/205-4.png" /></p><p>	</p><p><strong>	Cookie Found:</strong> eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjQsInVzZXJuYW1lIjoiQm9iIiwiYWRtaW4iOmZhbHNlLCJpYXQiOjE2NTU5ODExMTZ9.cmGKaF05QdLL0B1j4wXVROaXioK50zJxf_B7i5oCbJE</p><p>	</p><p>4. Next, we will decode the cookie in the <strong>https://jwt.io/</strong> website. We will forge the cookie to be an admin. Then get the encoded copy.</p><p>	<img src="images/205-5.png" alt="images/205-5.png" /></p><p>	</p><p>	I changed the <strong>admin</strong> value to <strong>true</strong>, and then copied the modiefied encoded cookie from the right. I opened the /admin page which inputing the modified cookie using burpsuite or cookie editor. However, i was unable to impersonate admin.</p><p>	</p><p><strong>	Forged Cookie:</strong> eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjQsInVzZXJuYW1lIjoiQm9iIiwiYWRtaW4iOnRydWUsImlhdCI6MTY1NTk4MTExNn0.fPVZZX7dVpHnhrQOeXMG5ZskguYWfn8XdgmOLW2lqco</p><p>	<img src="images/205-6.png" alt="images/205-6.png" /></p><p></p><p></p><p><strong>Note:</strong> (Findings)</p><p></p><p>The cookie forgery did not work because of the additional parameter the cookie uses for each account.</p><p><img src="images/205-7.png" alt="images/205-7.png" /></p><p>Notice the <strong>iat</strong> paramter is different for each account and thus the forged cookie will never be same as the original one. Until we find the <strong>admin cookie&#39;s iat value</strong></p></div>
</body>
</html>
