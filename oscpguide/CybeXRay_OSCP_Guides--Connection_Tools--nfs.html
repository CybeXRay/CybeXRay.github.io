<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>nfs</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>nfs</h1><br/><strong><h1>NFS</h1></strong><br /><br /><br /><strong>NFS-Common</strong><br /><small>It is important to have this package installed on any machine that uses NFS, either as client or server. It includes programs such as: </small><strong><small>lockd, statd</small></strong><small>, </small><strong><small>showmount</small></strong><small>, </small><strong><small>nfsstat, gssd</small></strong><small>, </small><strong><small>idmapd</small></strong><small> and </small><strong><small>mount.nfs</small></strong><small>. Primarily, we are concerned with &quot;showmount&quot; and &quot;mount.nfs&quot; as these are going to be most useful to us when it comes to extracting information from the NFS share.</small><br /><br /><br /><strong>Default Port: 2049</strong><br /><strong><br /></strong><strong><span style="text-decoration:underline;">Mounting NFS shares</span></strong><br /><br />Your client’s system needs a directory where all the content shared by the host server in the export folder can be accessed. You can create<br />this folder anywhere on your system. Once you&#39;ve created this mount point, you can use the &quot;mount&quot; command to connect the NFS share to the mount point on your machine like so:<br /><br /><strong>mount -t nfs IP:share /tmp/mount/ -nolock</strong><br /><br />Let&#39;s break this down<br />	<br />Tag 	Function<br />mount 	Execute the mount command<br />-t nfs 	Type of device to mount, then specifying that it&#39;s NFS<br />IP:share 	The IP Address of the NFS server, and the name of the share we wish to mount<br />-nolock 	Specifies not to use NLM locking<br /><br />Eg.<br /><br /><strong>mkdir /tmp/mount; mount -t nfs 10.10.253.206:/home /tmp/mount</strong><br /><img src="images/203-1.png" alt="images/203-1.png" /><br /><br /><strong><span style="text-decoration:underline;">To Check available shares from (Client Machine)</span></strong><br /><br /><strong>/usr/sbin/showmount -e [IP] </strong><br /><br />Eg.<br /><br /><strong>showmount -e 10.10.253.206<br /></strong><img src="images/203-2.png" alt="images/203-2.png" /><br /><br /><strong><span style="text-decoration:underline;">To check if nfs is active in a linux system(On the Remote System)</span></strong><br /><br /><strong>rpcinfo -p | grep nfs</strong><br /><br /><img src="images/203-3.png" alt="images/203-3.png" /><br /><br /><strong><span style="text-decoration:underline;">What is root_squash?</span></strong><br /><br />By default, on NFS shares- Root Squashing is enabled, and prevents anyone connecting to the NFS share from having root access to the NFS volume. Remote root users are assigned a user “nfsnobody” when connected, which has the least local privileges. Not what we want. However, if this is turned off, it can allow the creation of SUID bit files, allowing a remote user root access to the connected system. <br /><br /><strong>Note:</strong> If we see an option of <strong>no_root_squash</strong>, it means root_squash is disabled which means, if a remote user connects to the NFS share as <strong>root</strong>. He will have root privileges on the share and can setup a <strong>SUID</strong> bit for a <strong>local binary</strong><br /><br /><img src="images/203-4.png" alt="images/203-4.png" /><br /><br />Lets, get a local <strong>bash</strong> binary to the <strong>/home</strong>. Then from the <strong>NFS mount</strong> in our <strong>Kali</strong> machine. Set <strong>SUID bit</strong> on the <strong>bash</strong> executible.<br />Next, in the target machine, we can run the program with SUID.<br /><br /><strong>Target Machine</strong><br /><img src="images/203-5.png" alt="images/203-5.png" /><br /><br /><strong>Kali Machine</strong><br /><img src="images/203-6.png" alt="images/203-6.png" /><br /><br />Now, Finally in <strong>Target Machine</strong><br /><img src="images/203-7.png" alt="images/203-7.png" /><br /><br /></div>
</body>
</html>
