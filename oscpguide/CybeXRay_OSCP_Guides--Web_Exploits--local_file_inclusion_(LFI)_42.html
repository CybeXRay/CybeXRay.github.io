<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>local file inclusion (LFI)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>local file inclusion (LFI)</h1><br/><p>Local file inclusion (also known as LFI) is the process of including files, that are</p><p>already locally present on the server, through the exploitation of vulnerable inclusion</p><p>procedures implemented in an application.</p><p></p><p></p><p>We can easily determine if this is the case by attempting to load a file that we know definitely exists on the</p><p>system and is readable by all users. One of those files is /etc/passwd and to load it, change the file</p><p>parameter from home.php to /etc/passwd . For consistency reasons we will show this process with the</p><p>cURL command line utility instead of a browser.</p><p></p><p></p><p>curl &#39;http://{target_IP}/?file=/etc/passwd&#39;</p><p></p><p><img src="images/42-1.png" alt="images/42-1.png" /></p><p></p><p>This is successful and a list of users is returned.</p><p>It is worth noting that inputting /etc/passwd might not always work if the inclusion already specifies a</p><p>working directory.</p><p></p><p>For instance, consider the following code.</p><p></p><p>if ($_GET[&#39;file&#39;]) {</p><p>include( __DIR__ . $_GET[&#39;file&#39;]);</p><p>} else {</p><p>header(&quot;Location: <a href="http://$_SERVER[HTTP_HOST]/index.php?file=home.php">http://$_SERVER[HTTP_HOST]/index.php?file=home.php</a>&quot;);</p><p>}</p><p></p><p></p><p>In this example the __DIR__ parameter is used to acquire the current working directory that the script is</p><p>located in (e.g. /var/www/html ) and then the value of the file variable is concatenated at the end. If we</p><p>were to input /etc/passwd the full path would become /var/www/html/etc/passwd , which would result</p><p>in a blank page as there is no such file or folder on the system.</p><p>To bypass this restriction we would have to instruct the code to search in previous directories. This would</p><p>work similarly to how navigating to a previous folder is done with the cd command.</p><p></p><p></p><p>In such a case, /etc/passwd would become ../../../etc/passwd .</p><p></p><p>Example:</p><p>curl &#39;http://{target_IP}/?file=/var/lib/tftpboot/shell.php&#39;</p><p></p><p></p><p>OR</p><p></p><p>You can use <strong>Burpsuite</strong> Bruteforce with <strong>Sniper Attack</strong> using the <strong>Intruder</strong> module.</p><p>Here we manually create a/multiple payload file and use the content to be inserted at previouly marked sections.</p><p></p><p></p><p>OR</p><p></p><p>You can use the LFITool.</p><p>https://github.com/D35m0nd142/LFISuite</p><p></p><p></p><p></p><p><strong><span style="text-decoration:underline;">Wordlist and Links</span></strong></p><p></p><p><em><strong>https://github.com/carlospolop/Auto_Wordlists</strong></em></p><p></p><p>It has both Windows and Linux wordlists for checking LFI.</p><p></p><p></p><p></p></div>
</body>
</html>
