<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Using MMC</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Using MMC</h1><br/><p><strong><h1>Enumeration through Microsoft Management Console (MMC)</h1></strong></p><p></p><p>Do The Tasks in Own Windows Machine: (We only need a valid credential to enumerate using the <strong>runas</strong> tool)</p><p></p><p><strong><h3>Microsoft Management Console</h3></strong></p><p></p><p>In this task, we will explore our first enumeration method, which is the only method that makes use of a GUI until the very last task. We will be using the Microsoft Management Console (MMC) with the Remote Server Administration Tools&#39; (RSAT) AD Snap-Ins. If you use the provided <strong>Windows VM (THMJMP1)</strong>, it has already been installed for you. However, if you are using your <strong>own Windows machine</strong>, you can perform the following steps to install the Snap-Ins:</p><p></p><p>    1. Press Start</p><p>    2. Search &quot;Apps &amp; Features&quot; and press enter</p><p>    3. Click Manage Optional Features</p><p>    4. Click Add a feature</p><p>    5. Search for &quot;RSAT&quot;</p><p>    6. Select &quot;RSAT: Active Directory Domain Services and Lightweight Directory Tools&quot; and click Install</p><p></p><p>You can start MMC by using the Windows Start button, searching run, and typing in MMC. If we just run MMC normally, it would not work as our local windows computer is not domain-joined, and our local account cannot be used to authenticate to the domain. </p><p>[However, if we use <strong>THMJMP1</strong> system, it will work as it is joined to the Domain]</p><p></p><p><img src="images/331-1.png" alt="images/331-1.png" /></p><p></p><p>The above error comes in our <strong>own Windows Machine</strong> [While adding domain --→ Steps are below].</p><p>This is where the Runas window from the previous task comes into play. In that window, we can start MMC, which will ensure that all MMC network connections will use our injected AD credentials.</p><p></p><p><strong>runas.exe /netonly /user:za.tryhackme.com\jennifer.wright cmd.exe</strong></p><p></p><p>Then in the new cmd prompt, run <strong>mmc</strong></p><p></p><p>Now, we can add the domain without error.</p><p></p><p>In MMC, we can now attach the AD RSAT Snap-In:</p><p></p><p>1. Click <strong>File</strong> -&gt; <strong>Add/Remove Snap-in</strong></p><p>2. Select and <strong>Add</strong> all three Active Directory Snap-ins</p><p>3. Click through any errors and warnings</p><p>4. Right-click on <strong>Active Directory Domains and Trusts</strong> and select <strong>Change Forest</strong></p><p>5. Enter <em>za.tryhackme.com</em> as the <strong>Root domain</strong> and Click <strong>OK</strong></p><p>6. Right-click on <strong>Active Directory Sites and Services</strong> and select <strong>Change Forest</strong></p><p>7. Enter <em>za.tryhackme.com</em> as the <strong>Root domain</strong> and Click OK</p><p>8. Right-click on <strong>Active Directory Users and Computers</strong> and select <strong>Change Domain</strong></p><p>9. Enter <em>za.tryhackme.com</em> as the <strong>Domain</strong> and Click <strong>OK</strong></p><p>10. Right-click on <strong>Active Directory Users and Computers</strong> in the left-hand pane</p><p>11. Click on <strong>View</strong> -&gt; <strong>Advanced Features</strong></p><p></p><p>If everything up to this point worked correctly, your MMC should now be pointed to, and authenticated against, the target Domain:</p><p></p><p><img src="images/331-2.png" alt="images/331-2.png" /></p><p></p><p><strong>Users and Computers</strong></p><p></p><p>Let&#39;s take a look at the Active Directory structure. For this task, we will focus on AD Users and Computers. Expand that snap-in and expand the za domain to see the initial Organisational Unit (OU) structure:</p><p></p><p><img src="images/331-3.png" alt="images/331-3.png" /></p><p></p><p>Let&#39;s take a look at the People directory. Here we see that the users are divided according to department OUs. Clicking on each of these OUs will show the users that belong to that department.</p><p></p><p><img src="images/331-4.png" alt="images/331-4.png" /></p><p></p><p>Clicking on any of these users will allow us to review all of their properties and attributes. We can also see what groups they are a member of:</p><p></p><p><img src="images/331-5.png" alt="images/331-5.png" /></p><p></p><p>We can also use MMC to find hosts in the environment. If we click on either Servers or Workstations, the list of domain-joined machines will be displayed.</p><p></p><p><img src="images/331-6.png" alt="images/331-6.png" /></p><p></p><p>If we had the relevant permissions, we could also use MMC to directly make changes to AD, such as changing the user&#39;s password or adding an account to a specific group. Play around with MMC to better understand the AD domain structure. Make use of the search feature to look for objects.</p><p></p><p><strong>Benefits</strong></p><p></p><p>    1. The GUI provides an excellent method to gain a holistic view of the AD environment.</p><p>    2. Rapid searching of different AD objects can be performed.</p><p>    3. It provides a direct method to view specific updates of AD objects.</p><p>    4. If we have sufficient privileges, we can directly update existing AD objects or add new ones.</p><p></p><p><strong>Drawbacks</strong></p><p></p><p>    1. The GUI requires RDP access to the machine where it is executed.</p><p>    2. Although searching for an object is fast, gathering AD wide properties or attributes cannot be performed.﻿</p><p>    </p><p>    </p><p></p></div>
</body>
</html>
