<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Enumeration of Files/Folders</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Enumeration of Files/Folders</h1><br/><p><strong><h1>Usage or knowledge of files/folders</h1></strong></p><p></p><p></p><p><strong><h2>Recent Files:</h2></strong></p><p></p><p>Windows maintains a list of recently opened files for each user. As we might have seen when using Windows Explorer, it shows us a list of recently used files. This information is stored in the NTUSER hive and can be found on the following location:</p><p></p><p><span style="text-decoration:underline;">Registry Key</span>: <strong>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs</strong></p><p></p><p><strong>Registry Explorer</strong> allows us to sort data contained in registry keys quickly. For example, the Recent documents tab arranges the Most Recently Used (MRU) file at the top of the list. Registry Explorer also arranges them so that the Most Recently Used (MRU) file is shown at the top of the list and the older ones later.</p><p></p><p>Another interesting piece of information in this registry key is that there are different keys with file extensions, such as .pdf, .jpg, .docx etc. These keys provide us with information about the last used files of a specific file extension. So if we are looking specifically for the last used PDF files, we can look at the following registry key:</p><p></p><p><span style="text-decoration:underline;">Registry Key</span>: <strong>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.pdf</strong></p><p></p><p><strong>Registry Explorer</strong> also lists the Last Opened time of the files. </p><p></p><p></p><p><strong><h2>Office Recent Files:</h2></strong></p><p></p><p>Similar to the Recent Docs maintained by Windows Explorer, Microsoft Office also maintains a list of recently opened documents. This list is also located in the NTUSER hive. It can be found in the following location:</p><p></p><p><span style="text-decoration:underline;">Registry Key</span>: <strong>NTUSER.DAT\Software\Microsoft\Office\VERSION</strong></p><p></p><p>The version number for each Microsoft Office release is different. An example registry key will look like this:</p><p></p><p><span style="text-decoration:underline;">Registry Key</span>: <strong>NTUSER.DAT\Software\Microsoft\Office\15.0\Word</strong></p><p></p><p>Here, the 15.0 refers to Office 2013. A list of different Office releases and their version numbers can be found on this link.</p><p>(<a href="https://docs.microsoft.com/en-us/deployoffice/install-different-office-visio-and-project-versions-on-the-same-computer#office-releases-and-their-version-number">https://docs.microsoft.com/en-us/deployoffice/install-different-office-visio-and-project-versions-on-the-same-computer#office-releases-and-their-version-number</a>)</p><p></p><p>Starting from Office 365, Microsoft now ties the location to the user&#39;s live ID. In such a scenario, the recent files can be found at the following location. </p><p></p><p><span style="text-decoration:underline;">Registry Key</span>:<strong> NTUSER.DAT\Software\Microsoft\Office\VERSION\UserMRU\LiveID_####\FileMRU</strong></p><p></p><p></p><p><strong><h2>ShellBags:</h2></strong></p><p></p><p>When any user opens a folder, it opens in a specific layout. Users can change this layout according to their preferences. These layouts can be different for different folders. This information about the Windows &#39;shell&#39; is stored and can identify the Most Recently Used files and folders. Since this setting is different for each user, it is located in the user hives. We can find this information on the following locations:</p><p></p><p><span style="text-decoration:underline;">Registry Key</span>: <strong>USRCLASS.DAT\Local Settings\Software\Microsoft\Windows\Shell\Bags</strong></p><p><span style="text-decoration:underline;">Registry Key</span>: <strong>USRCLASS.DAT\Local Settings\Software\Microsoft\Windows\Shell\BagMRU</strong></p><p><span style="text-decoration:underline;">Registry Key</span>: <strong>NTUSER.DAT\Software\Microsoft\Windows\Shell\BagMRU</strong></p><p><span style="text-decoration:underline;">Registry Key</span>: <strong>NTUSER.DAT\Software\Microsoft\Windows\Shell\Bags</strong></p><p></p><p><strong>Registry Explorer</strong> doesn&#39;t give us much information about <strong>ShellBags</strong>. However, another tool from <strong>Eric Zimmerman&#39;s tools</strong> called the <strong>ShellBag Explorer</strong> shows us the information in an easy-to-use format. We just have to point to the hive file we have extracted, and it parses the data and shows us the results.</p><p></p><p></p><p><strong><h2>Open/Save and LastVisited Dialog MRUs:</h2></strong></p><p></p><p>When we open or save a file, a dialog box appears asking us where to save or open that file from. It might be noticed that once we open/save a file at a specific location, Windows remembers that location. This implies that we can find out recently used files if we get our hands on this information. We can do so by examining the following registry keys</p><p></p><p><span style="text-decoration:underline;">Registry Key</span>: <strong>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePIDlMRU</strong></p><p><span style="text-decoration:underline;">Registry Key</span>: <strong>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidlMRU</strong></p><p></p><p></p><p><strong><h2>Windows Explorer Address/Search Bars:</h2></strong></p><p></p><p>Another way to identify a user&#39;s recent activity is by looking at the paths typed in the Windows Explorer address bar or searches performed using the following registry keys, respectively.</p><p></p><p><span style="text-decoration:underline;">Registry Key</span>: <strong>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths</strong></p><p><span style="text-decoration:underline;">Registry Key</span>: <strong>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\WordWheelQuery</strong></p><p></p></div>
</body>
</html>
