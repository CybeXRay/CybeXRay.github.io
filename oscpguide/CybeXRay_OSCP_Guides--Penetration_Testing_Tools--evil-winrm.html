<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>evil-winrm</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>evil-winrm</h1><br/>Used for Windows Remote Management Exploitation.<br /><br /><a href="https://github.com/Hackplayers/evil-winrm">https://github.com/Hackplayers/evil-winrm</a><br /><br />gem install evil-winrm<br /><br /><img src="images/67-1.png" alt="images/67-1.png" /><br /><br /><strong>For Prevelege Escalation :</strong><br /><br />To list all processes<br /><br />Get-Process<br /><br />To get details of a particular process. Say eg.Firefox Browser<br /><br />Get-Process -name firefox<br /><br /><img src="images/67-2.png" alt="images/67-2.png" /><br /><br />We will use the &quot;procdump&quot; utility of microsoft to dump the process data from memory and look for passwords. <br /><br /><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/procdump">https://docs.microsoft.com/en-us/sysinternals/downloads/procdump</a><br /><br />Note: The “procdump” has to be uploaded to the target server<br /><br /><br /><img src="images/67-3.png" alt="images/67-3.png" /><br /><br />We need to use the -ma flag to dump the entire memory of the process.<br />The process ID we found should be used here.<br /><br /><img src="images/67-4.png" alt="images/67-4.png" /><br /><br />Note: -accepteula is ONLY required the first time the program is run.<br /><br /><br />We can start an SMB server locally to transfer this file.<br /><br />smbserver.py -smb2support -username guest -password guest share /root/htb<br /><br />The server will use the credentials ​guest / guest ​for authentication.<br /><br />Then in target windows machine use the following to mount the samba share &amp; copy the dump into it.<br /><br /><img src="images/67-5.png" alt="images/67-5.png" /><br /><br /><strong>By Seeing the Test Login in BurpSuite:</strong><br />The page used login_password as the parameter to submit passwords. We can search the dump<br />for strings like “login_password” to find any requests.<br /><br /><br />Now we parse the file locally <br /><img src="images/67-6.png" alt="images/67-6.png" /><br /><img src="images/67-7.png" alt="images/67-7.png" /><br /><br /><br />Then we use psexec to login as administrator.<br /><br /><img src="images/67-8.png" alt="images/67-8.png" /><br /><br /><br />We can also use evil-winrm for admin logins as follows: (Required in cases where no smb service running. “psexec.py uses smb”)<br /><br /><img src="images/67-9.png" alt="images/67-9.png" /><br /><br /><br /><br /><strong>To use evil-winrm to use password hash</strong><br />Use the -H option<br /><br /><strong>evil-winrm -i 10.10.11.113 -u administrator -H 0e0363213e37b94221497260b0bcb4fc</strong><br /><br /><img src="images/67-10.png" alt="images/67-10.png" /></div>
</body>
</html>
