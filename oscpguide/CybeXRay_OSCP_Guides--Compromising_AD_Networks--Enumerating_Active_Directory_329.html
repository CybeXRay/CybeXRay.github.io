<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Enumerating Active Directory</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Enumerating Active Directory</h1><br/><p><strong><h1>AD Enumeration</h1></strong></p><p></p><p></p><p><img src="images/329-1.png" alt="images/329-1.png" /></p><p></p><p></p><p>Once we have that first set of AD credentials and the means to authenticate with them on the network, a whole new world of possibilities opens up! We can start enumerating various details about the AD setup and structure with authenticated access, even super low-privileged access.</p><p></p><p>During a red team engagement, this will usually lead to us being able to perform some form of privilege escalation or lateral movement to gain additional access until we have sufficient privileges to execute and reach our goals. In most cases, enumeration and exploitation are heavily entwined. Once an attack path shown by the enumeration phase has been exploited, enumeration is again performed from this new privileged position, as shown in the diagram below.</p><p></p><p><img src="images/329-2.png" alt="images/329-2.png" /></p><p></p><p><strong>Learning Objectives</strong></p><p></p><p>In this network, we will cover several methods that can be used to enumerate AD. This is by no means a complete list as available methods are usually highly situational and dependent on the acquired breach. However, we will cover the following techniques for enumerating AD:</p><p></p><p>    • The AD snap-ins of the Microsoft Management Console.</p><p>    • The net commands of Command Prompt.</p><p>    • The AD-RSAT cmdlets of PowerShell.</p><p>    • Bloodhound</p><p>    </p><p><strong><span style="text-decoration:underline;">Using Networks in Tryhackme:</span></strong></p><p></p><p></p><p>First, Download a different vpn file. Named: <strong>breachingad.ovpn</strong> from Tryhackme</p><p></p><p>Then,</p><p> You will have to configure DNS on the host on which you are running the VPN connection. In order to configure our DNS, we must edit the<strong> /etc/systemd/resolved.conf</strong> file. Uncomment the DNS line and add the I<strong>P of THMDC</strong>: (As Shown in Network Diagram Above)</p><p> </p><p><img src="images/329-3.png" alt="images/329-3.png" /></p><p></p><p>Finally, Restart the service:</p><p></p><p><strong>systemctl restart systemd-resolved</strong></p><p></p><p>Or</p><p></p><p>Add the DNS in <strong>GUI Network Manager</strong>/<strong>nmtui</strong> tool (1st is the THM DNS then use default in the 2nd place).</p><p></p><p>and restart the Network Manager service:</p><p></p><p><strong>systemctl restart NetworkManager</strong></p><p></p><p><strong><span style="text-decoration:underline;">Testing DNS Status</span></strong></p><p></p><p><strong>nslookup thmdc.za.tryhackme.com</strong></p><p></p><p><img src="images/329-4.png" alt="images/329-4.png" /></p><p></p><p><strong>Requesting Your Credentials</strong></p><p></p><p>To simulate an AD breach, you will be provided with your first set of AD credentials. Once your networking setup has been completed, on your Attack Box, navigate to<strong> </strong><strong><a href="http://distributor.za.tryhackme.com/creds">http://distributor.za.tryhackme.com/creds</a></strong> to request your credential pair. Click the &quot;<strong>Get Credentials</strong>&quot; button to receive your credential pair that can be used for initial access.</p><p></p><p>This credential pair will provide you <strong>RDP</strong> and <strong>SSH</strong> access to <strong>THMJMP1.za.tryhackme.com</strong>. <strong>THMJMP1</strong> can be seen as a jump host into this environment, simulating a foothold that you have achieved. Jump hosts are often targeted by the red team since they provide access to a new network segment. You can use Remmina or any other similar Remote Desktop client to connect to this host for RDP. Remember to specify the domain of <strong>za.tryhackme.com</strong> when connecting. Task 2 and 3 will require RDP access.</p><p></p><p>For <strong>RDP</strong> access,</p><p></p><p><strong>xfreerdp /dynamic-resolution +clipboard /cert:ignore /scale:140 /v:thmjmp1.za.tryhackme.com /u:jennifer.wright /p:&#39;Acknowledge1998&#39;</strong></p><p></p><p><strong>Note</strong>: We can also use the IP as: <strong>/v:10.200.14.248</strong></p><p></p><p>For <strong>SSH</strong> access, you can use the following SSH command:</p><p></p><p><strong>ssh za.tryhackme.com\\&lt;AD Username&gt;@thmjmp1.za.tryhackme.com</strong></p><p></p><p>When prompted, provide your account&#39;s associated password. Although RDP can be used for all tasks, SSH is faster and can be used for Task 4, 5, and 6.</p><p></p><p><img src="images/329-5.png" alt="images/329-5.png" /></p><p></p><p><strong>Credentials:</strong></p><p>Username: jennifer.wright</p><p>Password: Acknowledge1998</p></div>
</body>
</html>
