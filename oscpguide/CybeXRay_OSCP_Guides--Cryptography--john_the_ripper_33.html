<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>john the ripper</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>john the ripper</h1><br/><p>Password cracking by brute force.</p><p></p><p><img src="images/33-1.png" alt="images/33-1.png" /></p><p></p><p>We do some random tries.</p><p></p><p><img src="images/33-2.png" alt="images/33-2.png" /></p><p></p><p></p><p></p><p>John the Ripper is a free password cracking software tool. Originally developed for the</p><p>Unix operating system, it can run on fifteen different platforms (eleven of which are</p><p>architecture-specific versions of Unix, DOS, Win32, BeOS, and OpenVMS). It is among the</p><p>most frequently used password testing and breaking programs as it combines a number of</p><p>password crackers into one package, autodetects password hash types, and includes a</p><p>customizable cracker. It can be run against various encrypted password formats</p><p>including several crypt password hash types most commonly found on various Unix</p><p>versions (based on DES, MD5, or Blowfish), Kerberos AFS, and Windows NT/2000/XP/2003 LM</p><p>hash. Additional modules have extended its ability to include MD4-based password hashes</p><p>and passwords stored in LDAP, MySQL, and others.</p><p></p><p></p><p>apt install john</p><p></p><p><img src="images/33-3.png" alt="images/33-3.png" /></p><p></p><p>In order to successfully crack the password, we will have to convert the ZIP into the hash using the</p><p>zip2john module that comes within John the Ripper:</p><p></p><p><img src="images/33-4.png" alt="images/33-4.png" /></p><p></p><p></p><p>Now, we will type the following command:</p><p></p><p>john -wordlist=/usr/share/wordlists/rockyou.txt hashes</p><p></p><p>So it will load the wordlist &amp; it will do a bruteforce attack against the hash stored in file hashes . Once the</p><p>password is cracked, we will use the --show option to display the cracked password.</p><p></p><p><img src="images/33-5.png" alt="images/33-5.png" /></p><p></p><p>We got the password: 741852963</p><p></p><p><strong>John with few specific options</strong></p><p>john hash --format=Raw-SHA512 --wordlist=rockyou.txt --rules=jumbo --fork=4 </p><p></p><p><strong>John for cracking a user&#39;s hash received from Database:</strong></p><p></p><p>john gamer_hash --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-SHA256</p><p></p><p><strong>To view it again:</strong></p><p></p><p>john gamer_hash --show --format=Raw-SHA256</p><p></p><p></p><p><strong><h1>THM: John Room</h1></strong></p><p></p><p></p><p><strong><h3>Automatic Cracking</h3></strong></p><p></p><p>John has built-in features to detect what type of hash it&#39;s being given, and to select appropriate rules and formats to crack it for you, this isn&#39;t always the best idea as it can be unreliable- but if you can&#39;t identify what hash type you&#39;re working with and just want to try cracking it, it can be a good option! To do this we use the following syntax:</p><p></p><p><strong>john --wordlist=[path to wordlist] [path to file]</strong></p><p></p><p><strong>--wordlist=</strong> - Specifies using wordlist mode, reading from the file that you supply in the following path...</p><p></p><p><strong>[path to wordlist] </strong>- The path to the wordlist you&#39;re using, as described in the previous task.</p><p></p><p><span style="text-decoration:underline;">Example Usage</span>:</p><p></p><p>john --wordlist=/usr/share/wordlists/rockyou.txt hash_to_crack.txt</p><p></p><p></p><p><strong><h3>Identifying Hashes</h3></strong></p><p></p><p>Sometimes John won&#39;t play nicely with automatically recognising and loading hashes, that&#39;s okay! We&#39;re able to use other tools to identify the hash, and then set john to use a specific format. There are multiple ways to do this, such as using an online hash identifier like this one. I like to use a tool called hash-identifier, a Python tool that is super easy to use and will tell you what different types of hashes the one you enter is likely to be, giving you more options if the first one fails.</p><p></p><p>To use hash-identifier, you can just pull the python file from gitlab using: <strong>wget https://gitlab.com/kalilinux/packages/hash-identifier/-/raw/kali/master/hash-id.py</strong>.</p><p></p><p>Then simply launch it with <strong>python3 hash-id.py</strong> and then enter the hash you&#39;re trying to identify- and it will give you possible formats</p><p></p><p>Online Tool: <a href="https://hashes.com/en/tools/hash_identifier">https://hashes.com/en/tools/hash_identifier</a></p><p>Python Tool: <a href="https://gitlab.com/kalilinux/packages/hash-identifier/-/tree/kali/master">https://gitlab.com/kalilinux/packages/hash-identifier/-/tree/kali/master</a></p><p>Kali Tool: <strong>hashid</strong></p><p></p><p><strong><h3>Format-Specific Cracking</h3></strong></p><p></p><p>Once you have identified the hash that you&#39;re dealing with, you can tell john to use it while cracking the provided hash using the following syntax:</p><p></p><p><strong>john --format=[format] --wordlist=[path to wordlist] [path to file]</strong></p><p></p><p><strong>--format=</strong> - This is the flag to tell John that you&#39;re giving it a hash of a specific format, and to use the following format to crack it</p><p></p><p><strong>[format]</strong> - The format that the hash is in</p><p></p><p><span style="text-decoration:underline;">Example Usage</span>:</p><p></p><p>john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt hash_to_crack.txt</p><p></p><p><strong>Note:</strong></p><p>When you are telling john to use formats, if you&#39;re dealing with a standard hash type, e.g. md5 as in the example above, you have to prefix it with <strong>raw-</strong> to tell john you&#39;re just dealing with a standard hash type, though this doesn&#39;t always apply. To check if you need to add the prefix or not, you can list all of John&#39;s formats using <strong>john --list=formats</strong> and either check manually, or grep for your hash type using something like <strong>john --list=formats | grep -iF &quot;md5&quot;</strong>.</p><p></p><p><strong><h3>Cracking Windows Authentication Hashes (NT Hash/NTLM)</h3></strong></p><p></p><p>Format to be Used: <strong>NT</strong></p><p><span style="text-decoration:underline;">Command</span>: john --wordlist=/usr/share/wordlists/rockyou.txt --format=NT ntlm.txt</p><p></p><p><img src="images/33-6.png" alt="images/33-6.png" /></p><p></p><p></p><p></p><p></p><p><strong><h3>Cracking /etc/shadow Hashes</h3></strong></p><p></p><p><strong>Cracking Linux System Passwords:</strong></p><p></p><p>We need to dump /etc/passwd --→ password.txt and /etc/shadow --→ shadow.txt</p><p></p><p><em><strong>unshadow password.txt shadow.txt &gt; crackMe.txt</strong></em></p><p></p><p>This will put the password hashes in its place in the Output file.</p><p></p><p><em><strong>john --wordlist=/usr/share/wordlists/rockyou.txt crackMe.txt</strong></em></p><p></p><p>Note: We do not need to explicitly mention the format to be used. However, in certain times <strong>--format=sha512crypt</strong> can be used.</p><p></p><p><span style="text-decoration:underline;">Exercise</span>:</p><p><img src="images/33-7.png" alt="images/33-7.png" /></p><p></p><p><strong><h3>Cracking SSH Keys with John</h3></strong></p><p></p><p><strong>Cracking Paraphrase from ID_RSA</strong><span style="text-decoration:underline;"></span></p><p><span style="text-decoration:underline;"></span></p><p><img src="images/33-8.png" alt="images/33-8.png" /></p><p></p><p>Get the complete id_rsa (Private Key) contents into a file. (Say kay_id_rsa)</p><p></p><p><strong>chmod 600 kay_id_rsa</strong></p><p><strong>ssh2john kay_id_rsa &gt; john_ssh_hash</strong></p><p><strong>john --wordlist=/usr/share/wordlists/rockyou.txt john_ssh_hash</strong></p><p></p><p><img src="images/33-9.png" alt="images/33-9.png" /></p><p>We found the Paraphrase for <strong>kay_id_rsa</strong></p><p></p><p><strong>Credentials Found</strong></p><p><strong>Username: kay</strong></p><p><strong>Paraphrase: beeswax</strong></p><p></p><p>We can now login to SSH with the <strong>kay_id_rsa</strong> and the <strong>cracked paraphrase </strong></p><p></p><p></p><p><strong><h3>Single Crack Mode</h3></strong></p><p></p><p>So far we&#39;ve been using John&#39;s wordlist mode to deal with brute forcing simple., and not so simple hashes. But John also has another mode, called Single Crack mode. In this mode, John uses only the information provided in the username, to try and work out possible passwords heuristically, by slightly changing the letters and numbers contained within the username.</p><p></p><p><strong>Word Mangling</strong></p><p></p><p>The best way to show what Single Crack mode is,  and what word mangling is, is to actually go through an example:</p><p></p><p>If we take the username: Markus</p><p>Some possible passwords could be:</p><p></p><p>    Markus1, Markus2, Markus3 (etc.)</p><p>    MArkus, MARkus, MARKus (etc.)</p><p>    Markus!, Markus$, Markus* (etc.)</p><p></p><p>This technique is called word mangling. John is building it&#39;s own dictionary based on the information that it has been fed and uses a set of rules called &quot;mangling rules&quot; which define how it can mutate the word it started with to generate a wordlist based off of relevant factors for the target you&#39;re trying to crack. This is exploiting how poor passwords can be based off of information about the username, or the service they&#39;re logging into.</p><p></p><p><strong>GECOS</strong></p><p><strong></strong></p><p>John&#39;s implementation of word mangling also features compatibility with the Gecos fields of the UNIX operating system, and other UNIX-like operating systems such as Linux. So what are Gecos? Remember in the last task where we were looking at the entries of both /etc/shadow and /etc/passwd? Well if you look closely You can see that each field is seperated by a colon &quot;:&quot;. Each one of the fields that these records are split into are called Gecos fields. John can take information stored in those records, such as full name and home directory name to add in to the wordlist it generates when cracking /etc/shadow hashes with single crack mode.</p><p></p><p><strong>Using Single Crack Mode</strong></p><p></p><p>To use single crack mode, we use roughly the same syntax that we&#39;ve used to so far, for example if we wanted to crack the password of the user named &quot;Mike&quot;, using single mode, we&#39;d use:</p><p></p><p><strong>john --single --format=[format] [path to file]</strong></p><p></p><p><strong>--single</strong> - This flag lets john know you want to use the single hash cracking mode.</p><p></p><p><span style="text-decoration:underline;">Example Usage</span>:</p><p></p><p>john --single --format=raw-sha256 hashes.txt</p><p></p><p><strong>Note:</strong></p><p>If you&#39;re cracking hashes in single crack mode, you need to change the file format that you&#39;re feeding john for it to understand what data to create a wordlist from. You do this by <strong>prepending</strong> the <strong>hash</strong> with the <strong>username</strong> that the hash belongs to, so according to the above example- we would change the file <strong>hashes.txt</strong></p><p></p><p>From:</p><p></p><p>1efee03cdcb96d90ad48ccc7b8666033</p><p></p><p>To</p><p></p><p>mike:1efee03cdcb96d90ad48ccc7b8666033</p><p></p><p><strong>Exercise</strong>: (The Username was Provided - joker)</p><p><img src="images/33-10.png" alt="images/33-10.png" /></p><p></p><p></p><p><strong><h3>Cracking Password Protected ZIP Files</h3></strong></p><p></p><p>First we need to convert the <strong>ZIP</strong> file to <strong>John</strong> format.</p><p></p><p><strong>Zip2John</strong></p><p></p><p>Similarly to the unshadow tool that we used previously, we&#39;re going to be using the zip2john tool to convert the zip file into a hash format that John is able to understand, and hopefully crack. The basic usage is like this:</p><p></p><p><strong>zip2john [options] [zip file] &gt; [output file]</strong></p><p></p><p><strong>[options] </strong>- Allows you to pass specific checksum options to zip2john, this shouldn&#39;t often be necessary</p><p></p><p><strong>[zip file]</strong> - The path to the zip file you wish to get the hash of</p><p></p><p><strong>&gt;</strong> - This is the output director, we&#39;re using this to send the output from this file to the...</p><p></p><p><strong>[output file]</strong> - This is the file that will store the output from</p><p></p><p></p><p><span style="text-decoration:underline;">Example</span>: <strong>zip2john zipfile.zip &gt; zip_hash.txt</strong></p><p></p><p><strong>Cracking</strong></p><p></p><p>We&#39;re then able to take the file we output from zip2john in our example use case called &quot;zip_hash.txt&quot; and, as we did with unshadow, feed it directly into John as we have made the input specifically for it.</p><p></p><p><strong>john --wordlist=/usr/share/wordlists/rockyou.txt zip_hash.txt</strong></p><p></p><p><strong>Exercise:</strong></p><p><img src="images/33-11.png" alt="images/33-11.png" /></p><p></p><p></p><p></p><p><strong><h3>Cracking Password Protected ZIP Files</h3></strong></p><p></p><p>First we need to convert the <strong>ZIP</strong> file to <strong>John</strong> format.</p><p></p><p><strong>Rar2John</strong></p><p></p><p>Similarly to the unshadow tool that we used previously, we&#39;re going to be using the zip2john tool to convert the zip file into a hash format that John is able to understand, and hopefully crack. The basic usage is like this:</p><p></p><p><strong>rar2john [options] [rar file] &gt; [output file]</strong></p><p></p><p><strong>[options] </strong>- Allows you to pass specific checksum options to zip2john, this shouldn&#39;t often be necessary</p><p></p><p><strong>[rar file]</strong> - The path to the rar file you wish to get the hash of</p><p></p><p><strong>&gt;</strong> - This is the output director, we&#39;re using this to send the output from this file to the...</p><p></p><p><strong>[output file]</strong> - This is the file that will store the output from</p><p></p><p></p><p><span style="text-decoration:underline;">Example</span>: <strong>rar2john rarfile.rar &gt; rar_hash.txt</strong></p><p></p><p><strong>Cracking</strong></p><p></p><p>We&#39;re then able to take the file we output from zip2john in our example use case called &quot;zip_hash.txt&quot; and, as we did with unshadow, feed it directly into John as we have made the input specifically for it.</p><p></p><p><strong>john --wordlist=/usr/share/wordlists/rockyou.txt rar_hash.txt</strong></p><p></p><p><strong>Exercise:</strong></p><p><img src="images/33-12.png" alt="images/33-12.png" /></p><p></p><p><strong><h3>Cracking Certificate FIles</h3></strong></p><p></p><p>Windows servers use <strong>.pfx</strong> files that contain a public key file and the associated private key file. Let’s use <strong>pfx2john</strong>.</p><p>Then, we will use <strong>john</strong> to crack it.</p><p></p><p></p><p><strong>pfx2john cert.pfx &gt; john_pfx_hash</strong></p><p></p><p><strong>john --wordlist=/usr/share/wordlists/rockyou.txt john_pfx_hash</strong></p><p></p><p><img src="images/33-13.png" alt="images/33-13.png" /></p><p></p><p>We find the password for the <strong>cert.pfx</strong> file.</p></div>
</body>
</html>
