<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Exploiting Active Directory</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Exploiting Active Directory</h1><br/><p><strong><h1>Exploiting Active Directory</h1></strong></p><p></p><p></p><p><img src="images/342-1.png" alt="images/342-1.png" /></p><p></p><p><strong><span style="text-decoration:underline;">Using Networks in Tryhackme:</span></strong></p><p></p><p>First, Download a different vpn file. Named: <strong>exploitingad.ovpn</strong> from Tryhackme</p><p></p><p>Then,</p><p> You will have to configure DNS on the host on which you are running the VPN connection. In order to configure our DNS, we must edit the<strong> /etc/systemd/resolved.conf</strong> file. Uncomment the DNS line and add the I<strong>P of THMDC</strong>: (As Shown in Network Diagram Above)</p><p> </p><p><img src="images/342-2.png" alt="images/342-2.png" /></p><p></p><p>Finally, Restart the service:</p><p></p><p><strong>systemctl restart systemd-resolved</strong></p><p></p><p>Or</p><p></p><p>Add the DNS in <strong>GUI Network Manager</strong>/<strong>nmtui</strong> tool (1st is the THM DNS then use default in the 2nd place).</p><p></p><p>and restart the Network Manager service:</p><p></p><p><strong>systemctl restart NetworkManager</strong></p><p></p><p><strong><span style="text-decoration:underline;">Testing DNS Status</span></strong></p><p></p><p><strong>nslookup thmdc.za.tryhackme.loc</strong></p><p></p><p><img src="images/342-3.png" alt="images/342-3.png" /></p><p></p><p></p><p><strong><span style="text-decoration:underline;">Requesting Your Credentials</span></strong></p><p></p><p>To simulate an AD breach, you will be provided with your first set of AD credentials. Once your networking setup has been completed, navigate to <strong>http://distributor.za.tryhackme.loc/creds</strong> to request your credential pair. Click the &quot;Get Credentials&quot; button to receive your credential pair that can be used for initial access.</p><p></p><p>This credential pair will provide you RDP and SSH access to THMWRK1.za.tryhackme.loc. THMWRK1 can be seen as a jump host into this environment, simulating a foothold that you have achieved. You can use Remmina or any other similar Remote Desktop client to connect to this host for RDP. Remember to specify the domain of za.tryhackme.loc when connecting.</p><p></p><p>For SSH access, you can use the following SSH command:</p><p></p><p><strong>ssh za.tryhackme.loc\\&lt;AD Username&gt;@thmwrk1.za.tryhackme.loc</strong></p><p></p><p></p><p><img src="images/342-4.png" alt="images/342-4.png" /></p><p></p><p><strong>Credentials Received:</strong></p><p>Username: amy.king</p><p>Password: Planets1972</p><p></p><p></p><p><strong><h3>AD Exploitation</h3></strong></p><p></p><p>Now that we have performed our internal recon and understand the lay of the land regarding the AD structure and environment, it is time for the exploitation phase. This phase exploits misconfigurations to perform a combination of lateral movement and privilege escalation until we reach a suitable position to execute our goals, as shown in the diagram below. This phase is usually combined with persistence to ensure that we can&#39;t lose the new position we gain, but this will be covered in the next room. It is also usually combined with additional enumeration since our new position might allow us to acquire additional information about the lay of the land.</p><p></p><p><img src="images/342-5.png" alt="images/342-5.png" /></p><p></p><p></p><p><strong><span style="text-decoration:underline;">Learning Objectives</span></strong></p><p></p><p>In this network, we will cover several methods that can be used to exploit AD misconfigurations. This is by no means a complete list, as available methods are usually highly situational and dependent on the AD structure and environment. However, we will cover the following techniques for exploiting AD:</p><p></p><p>    ▪ AD Delegation</p><p>    ▪ Forcing Authentication Relays</p><p>    ▪ Group Policy Objects</p><p>    ▪ Targeting AD Users</p><p>    ▪ Domain Trusts</p><p>    ▪ Silver and Golden Tickets</p></div>
</body>
</html>
