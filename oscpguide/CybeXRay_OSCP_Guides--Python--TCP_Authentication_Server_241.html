<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>TCP Authentication Server</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>TCP Authentication Server</h1><br/><p><strong><h1>TCP Authentication Server</h1></strong></p><p></p><p></p><p><strong><h2>Authentication Server that listens on Port 5272 &amp; converts userinput from bytes to Long</h2></strong></p><p># 2022.07.05 12:08:29 IST</p><p>#Embedded file name: ../backdoor/backdoor.py</p><p>import socket</p><p>import subprocess</p><p>from Crypto.Util.number import bytes_to_long</p><p>usern = 232340432076717036154994L</p><p>passw = 10555160959732308261529999676324629831532648692669445488L</p><p>port = 5752</p><p>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</p><p>s.bind((&#39;&#39;, port))</p><p>s.listen(10)</p><p></p><p>def secret():</p><p>    with open(&#39;secret.txt&#39;, &#39;r&#39;) as f:</p><p>        reveal = f.read()</p><p>        return reveal</p><p></p><p></p><p>while True:</p><p>    try:</p><p>        conn, addr = s.accept()</p><p>        conn.send(&#39;\n\tChapter 1: A Call for help\n\n&#39;)</p><p>        conn.send(&#39;Username: &#39;)</p><p>        username = conn.recv(1024).decode(&#39;utf-8&#39;).strip()</p><p>        username = bytes(username, &#39;utf-8&#39;)</p><p>        conn.send(&#39;Password: &#39;)</p><p>        password = conn.recv(1024).decode(&#39;utf-8&#39;).strip()</p><p>        password = bytes(password, &#39;utf-8&#39;)</p><p>        if bytes_to_long(username) == usern and bytes_to_long(password) == passw:</p><p>            directory = bytes(secret(), &#39;utf-8&#39;)</p><p>            conn.send(directory)</p><p>            conn.close()</p><p>        else:</p><p>            conn.send(&#39;Errr... Authentication failed\n\n&#39;)</p><p>            conn.close()</p><p>    except:</p><p>        continue</p><p>+++ okay decompyling .file </p><p># decompiled 1 files: 1 okay, 0 failed, 0 verify failed</p><p># 2022.07.05 12:08:29 IST</p><p></p><p></p><p></p><p><strong><h2>Reverse Conversion From Long to Bytes</h2></strong></p><p>from Crypto.Util.number import long_to_bytes</p><p></p><p>username = long_to_bytes(232340432076717036154994)</p><p>print(&quot;Username: &quot; + username.decode(&quot;utf-8&quot;))</p><p></p><p>password = long_to_bytes(10555160959732308261529999676324629831532648692669445488)</p><p>print(&quot;Password: &quot; + password.decode(&quot;utf-8&quot;))</p></div>
</body>
</html>
