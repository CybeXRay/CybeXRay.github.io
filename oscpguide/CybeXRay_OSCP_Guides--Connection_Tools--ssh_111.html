<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>ssh</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>ssh</h1><br/><p>ssh connection with private id file.</p><p></p><p>Note: Change permission to 600.</p><p></p><p>chmod 600 id_rsa</p><p>ssh -i id_rsa user@Server_IP</p><p></p><p></p><p><strong>Reverse SSH Tunnel</strong></p><p></p><p><img src="images/111-1.png" alt="images/111-1.png" /></p><p></p><p>eg.</p><p></p><p><em><strong>ssh -L 9999:localhost:10000 agent47@10.10.169.69</strong></em></p><p></p><p>The CMS App is hosted in 10.10.169.69 and only accessible to localhost(own system). It is blocked by firewall for Remote Access.</p><p></p><p>However, using the above method we can access the CMS App <strong>remotely</strong>.</p><p></p><p>A reverse tunnel is created at Kali machine(Say at 9999)</p><p>Then the app running at localhost:10000 is tunneled to our machine.</p><p></p><p></p><p><strong>SSH Backdoors Using Keys:</strong></p><p></p><p><em><strong>https://github.com/NinjaJc01/ssh-backdoor</strong></em></p><p>Or </p><p><em><strong>https://kb.iu.edu/d/aews</strong></em></p><p>ssh-keygen -t rsa</p><p></p><p><strong>Connect to SSH Backdoor created by the git repository:</strong></p><p>Note:</p><p><em><strong>ssh james@10.10.131.235 -p 2222 </strong></em></p><p>The above should work. But it fails in Kali Linux</p><p></p><p></p><p>The following command works. Here we are explicitly mentioning <strong>ssh-rsa</strong> as one of the supported <strong>HostKeyAlgorithms</strong></p><p><em><strong>ssh  -o HostKeyAlgorithms\ ssh-rsa james@10.10.131.235 -p 2222</strong></em></p><p></p><p><strong>Recursive Secure Copy(SCP)</strong></p><p></p><p><em><strong>scp -r administrator@10.10.50.60:/Users/Administrator/Downloads /home/cybex/lab/Windows_tools</strong></em></p><p></p><p>This will copy (recursively) all the contents inside <strong>C:\Users\Administrator\Downloads</strong> directory into the local directory mentioned above.</p><p>By default SCP uses <strong>C: drive</strong> in windows, so we need not mention it.</p><p></p><p><strong>Secure Copy in different Port</strong></p><p></p><p><strong>scp -P 9090 fox@10.10.93.57:/tmp/shutdown .</strong></p><p></p><p></p><p><strong>Generating SSH keys and sending public key to machines so that we can access them</strong></p><p></p><p><img src="images/111-2.png" alt="images/111-2.png" /></p><p></p><p></p><p><strong><span style="text-decoration:underline;">SSH Tunnel for NFS</span></strong></p><p></p><p>We created SSH tunnel to default nfs port: <strong>2049</strong></p><p></p><p><strong>ssh -L 2049:localhost:2049 paradox@10.10.108.191</strong></p><p><strong>mount -t nfs 127.0.0.1: nfs_share</strong></p><p></p><p>That is reason mount command connected automatically.</p><p>Note: If we tunnel to a custom port say <strong>9999</strong></p><p></p><p><strong>ssh -L 9999:localhost:2049 paradox@10.10.108.191</strong></p><p><strong>mount -t nfs -o port=9999 127.0.0.1: nfs_share</strong></p><p></p><p>Then we have to use <strong>-o option</strong> in mount with <strong>key port=9999</strong> for connection.</p><p></p><p><strong><span style="text-decoration:underline;">SSH Error</span></strong></p><p><strong>Error:</strong> Unable to negotiate with 10.10.58.16 port 22: no matching host key type found. Their offer: ssh-rsa,ssh-dss</p><p><strong>Solution:</strong></p><p><strong>ssh -o HostKeyAlgorithms=+ssh-dss user@10.10.58.16</strong></p><p>or</p><p><strong>ssh -o HostKeyAlgorithms\ ssh-dss user@10.10.58.16</strong></p><p></p><p></p><p><strong><span style="text-decoration:underline;">SSH Using a Pseudo Terminal (To Escape rbash : Restricted Bash):</span></strong></p><p>Using <strong>-t</strong> which enables &quot;<strong>pseudo-tty allocation</strong>&quot;</p><p><strong>ssh -i id_h4rdy h4rdy@10.10.113.98 -t bash &#39;--noprofile&#39;</strong></p><p></p><p></p><p><strong><span style="text-decoration:underline;">SSH Into a Domain System as a Domain USer:</span></strong><span style="text-decoration:underline;"></span></p><p><span style="text-decoration:underline;"></span></p><p><strong>Domain Name:</strong> za.tryhackme.com</p><p><strong>Username: </strong>AD_Username</p><p><strong>System to Connect (THMJMP1) :</strong> thmjmp1.za.tryhackme.com</p><p></p><p><strong>ssh za.tryhackme.com\\&lt;AD_Username&gt;@thmjmp1.za.tryhackme.com</strong></p></div>
</body>
</html>
