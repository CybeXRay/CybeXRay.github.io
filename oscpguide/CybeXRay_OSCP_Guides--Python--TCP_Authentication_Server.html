<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>TCP Authentication Server</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>TCP Authentication Server</h1><br/><strong><h1>TCP Authentication Server</h1></strong><br /><br /><br /><strong><h2>Authentication Server that listens on Port 5272 &amp; converts userinput from bytes to Long</h2></strong><br /># 2022.07.05 12:08:29 IST<br />#Embedded file name: ../backdoor/backdoor.py<br />import socket<br />import subprocess<br />from Crypto.Util.number import bytes_to_long<br />usern = 232340432076717036154994L<br />passw = 10555160959732308261529999676324629831532648692669445488L<br />port = 5752<br />s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br />s.bind((&#39;&#39;, port))<br />s.listen(10)<br /><br />def secret():<br />    with open(&#39;secret.txt&#39;, &#39;r&#39;) as f:<br />        reveal = f.read()<br />        return reveal<br /><br /><br />while True:<br />    try:<br />        conn, addr = s.accept()<br />        conn.send(&#39;\n\tChapter 1: A Call for help\n\n&#39;)<br />        conn.send(&#39;Username: &#39;)<br />        username = conn.recv(1024).decode(&#39;utf-8&#39;).strip()<br />        username = bytes(username, &#39;utf-8&#39;)<br />        conn.send(&#39;Password: &#39;)<br />        password = conn.recv(1024).decode(&#39;utf-8&#39;).strip()<br />        password = bytes(password, &#39;utf-8&#39;)<br />        if bytes_to_long(username) == usern and bytes_to_long(password) == passw:<br />            directory = bytes(secret(), &#39;utf-8&#39;)<br />            conn.send(directory)<br />            conn.close()<br />        else:<br />            conn.send(&#39;Errr... Authentication failed\n\n&#39;)<br />            conn.close()<br />    except:<br />        continue<br />+++ okay decompyling .file <br /># decompiled 1 files: 1 okay, 0 failed, 0 verify failed<br /># 2022.07.05 12:08:29 IST<br /><br /><br /><br /><strong><h2>Reverse Conversion From Long to Bytes</h2></strong><br />from Crypto.Util.number import long_to_bytes<br /><br />username = long_to_bytes(232340432076717036154994)<br />print(&quot;Username: &quot; + username.decode(&quot;utf-8&quot;))<br /><br />password = long_to_bytes(10555160959732308261529999676324629831532648692669445488)<br />print(&quot;Password: &quot; + password.decode(&quot;utf-8&quot;))</div>
</body>
</html>
