<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Password Spray Attack</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Password Spray Attack</h1><br/><p><strong><h1>Password Spray Attack</h1></strong></p><p></p><p>Password Spraying is an effective technique used to identify valid credentials. Nowadays, password spraying is considered one of the common password attacks for discovering weak passwords. This technique can be used against various online services and authentication systems, such as SSH, SMB, RDP, SMTP, Outlook Web Application, etc. A brute-force attack targets a specific username to try many weak and predictable passwords. While a password spraying attack targets many usernames using one common weak password, which could help avoid an account lockout policy. The following figure explains the concept of password spraying attacks where the attacker utilizes one common password against multiple users.</p><p></p><p><img src="images/401-1.png" alt="images/401-1.png" /></p><p></p><p></p><p>Common and weak passwords often follow a pattern and format. Some commonly used passwords and their overall format can be found below.</p><p></p><p>    <strong>• </strong>The current season followed by the current year (SeasonYear). For example, <strong>Fall2020</strong>, <strong>Spring2021</strong>, etc.</p><p>    <strong>• </strong>The current month followed by the current year (MonthYear). For example, <strong>November2020</strong>, <strong>March2021</strong>, etc.</p><p>    <strong>• </strong>Using the company name along with random numbers (CompanyNameNumbers). For example, <strong>TryHackMe01</strong>, <strong>TryHackMe02</strong>.</p><p>    </p><p>If a password complexity policy is enforced within the organization, we may need to create a password that includes symbols to fulfill the requirement, such as <strong>October2021!</strong>, <strong>Spring2021!</strong>, <strong>October2021@</strong>, etc. To be successful in the password spraying attack, we need to enumerate the target and create a list of valid usernames (or email addresses list).</p><p></p><p>Next, we will apply the password spraying technique using different scenarios against various services, including:</p><p></p><p>    <strong>• </strong>SSH</p><p>    <strong>• </strong>RDP</p><p>    <strong>• </strong>Outlook web access (OWA) portal</p><p>    <strong>• </strong>SMB</p><p>    </p><p>    </p><p><strong><h3>SSH</h3></strong></p><p></p><p>Assume that we have already enumerated the system and created a valid username list.</p><p></p><p><strong>hydra -L usernames-list.txt -p Spring2021 ssh://10.1.1.10</strong></p><p></p><p></p><p><strong><h3>RDP</h3></strong></p><p></p><p>Let&#39;s assume that we found an exposed RDP service on port <strong>3026</strong>. We can use a tool such as <strong>RDPassSpray</strong> to password spray against RDP. First, install the tool on your attacking machine by following the installation instructions in the tool’s Github repo. As a new user of this tool, we will start by executing the <strong>python3 RDPassSpray.py -h</strong> command to see how the tools can be used:</p><p></p><p>Link: <strong>https://github.com/xFreed0m/RDPassSpray</strong> </p><p></p><p>Usage:</p><p></p><p><strong>python3 RDPassSpray.py -u victim -p Spring2021! -t 10.100.10.240:3026</strong></p><p></p><p><img src="images/401-2.png" alt="images/401-2.png" /></p><p></p><p>The above output shows that we successfully found valid credentials victim:Spring2021!. Note that we can specify a domain name using the -d option if we are in an Active Directory environment.</p><p></p><p><strong>python3 RDPassSpray.py -U usernames-list.txt -p Spring2021! -d THM-labs -T RDP_servers.txt</strong></p><p></p><p></p><p><strong><h3>Outlook web access (OWA) portal</h3></strong></p><p></p><p><strong>Tools:</strong></p><p></p><p><strong>    SprayingToolkit (atomizer.py)</strong></p><p><strong>    MailSniper</strong></p><p></p><p>Link: <strong>https://github.com/byt3bl33d3r/SprayingToolkit</strong> </p><p>Link: <strong>https://github.com/dafthack/MailSniper</strong> </p><p></p><p></p><p><h3>SMB</h3></p><p></p><p><strong>Tool: </strong></p><p>    </p><p><strong>    Metasploit (auxiliary/scanner/smb/smb_login)</strong></p><p></p><p></p><p><strong><span style="text-decoration:underline;">Room Question</span></strong></p><p></p><p><strong>hydra -L usernames-list.txt -p Fall2021@ ssh://10.10.54.214</strong></p><p></p><p><img src="images/401-3.png" alt="images/401-3.png" /></p><p></p><p></p></div>
</body>
</html>
