<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Evidence of Execution</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Evidence of Execution</h1><br/><strong><h1>Evidence of Execution</h1></strong><br /><br /><strong><h2>UserAssist:</h2></strong><br /><br />Windows keeps track of applications launched by the user using Windows Explorer for statistical purposes in the User Assist registry keys. These keys contain information about the programs launched, the time of their launch, and the number of times they were executed. However, programs that were run using the command line can&#39;t be found in the User Assist keys. The User Assist key is present in the NTUSER hive, mapped to each user&#39;s GUID. We can find it at the following location:<br /><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>NTUSER.DAT\Software\Microsoft\Windows\Currentversion\Explorer\UserAssist\{GUID}\Count</strong><br /><br /><br /><strong><h2>ShimCache:</h2></strong><br /><br />ShimCache is a mechanism used to keep track of application compatibility with the OS and tracks all applications launched on the machine. Its main purpose in Windows is to ensure backward compatibility of applications. It is also called <strong>Application Compatibility Cache</strong> <strong>(AppCompatCache)</strong>. It is located in the following location in the SYSTEM hive:<br /><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache</strong><br /><br />ShimCache stores file name, file size, and last modified time of the executables.<br /><br />Our goto tool, the <strong>Registry Explorer</strong>, doesn&#39;t parse ShimCache data in a human-readable format, so we go to another tool called <strong>AppCompatCache Parser</strong>, also a part of Eric Zimmerman&#39;s tools. It takes the SYSTEM hive as input, parses the data, and outputs a <strong>CSV file</strong>.<br /><br />We can use the following command to run the<strong> AppCompatCache Parser Utility</strong>:<br /><br /><span style="text-decoration:underline;">Command</span>: <strong>AppCompatCacheParser.exe --csv &lt;path to save output&gt; -f &lt;path to SYSTEM hive for data parsing&gt; -c &lt;control set to parse&gt;</strong><br /><br />The output can be viewed using <strong>EZviewer</strong>, another one of Eric Zimmerman&#39;s tools.<br /><br /><br /><strong><h2>AmCache:</h2></strong><br /><br />The AmCache hive is an artifact related to ShimCache. This performs a similar function to ShimCache, and stores additional data related to program executions. This data includes execution path, installation, execution and deletion times, and SHA1 hashes of the executed programs. This hive is located in the file system at:<br /><br /><strong>C:\Windows\appcompat\Programs\Amcache.hve</strong><br /><br />Information about the last executed programs can be found at the following location in the hive:<br /><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>Amcache.hve\Root\File\{Volume GUID}\</strong><br /><br /><br /><strong><h2>BAM/DAM:</h2></strong><br /><br />Background Activity Monitor or BAM keeps a tab on the activity of background applications. Similar Desktop Activity Moderator or DAM is a part of Microsoft Windows that optimizes the power consumption of the device. Both of these are a part of the Modern Standby system in Microsoft Windows.<br /><br />In the Windows registry, the following locations contain information related to BAM and DAM. This location contains information about last run programs, their full paths, and last execution time.<br /><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SYSTEM\CurrentControlSet\Services\bam\UserSettings\{SID}</strong><br /><span style="text-decoration:underline;">Registry Key</span>: <strong>SYSTEM\CurrentControlSet\Services\dam\UserSettings\{SID}</strong><br /><br /><br /></div>
</body>
</html>
