<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Bloodhound</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Bloodhound</h1><br/><p><strong>BloodHound</strong></p><p></p><p><strong>https://github.com/BloodHoundAD/BloodHound</strong></p><p></p><p><strong>Bloodhound</strong> is a graphical interface that allows you to visually map out the network. This tool along with <strong>SharpHound</strong> which similar to  PowerView takes the user, groups, trusts etc. of the network and collects them into .json files to be used inside of Bloodhound.</p><p>Well be focusing on how to collect the .json files and how to import them into Bloodhound</p><p></p><p><strong>Note:</strong> It uses <strong>SharpHound</strong></p><p></p><p><strong>apt install bloodhound neo4j</strong></p><p><strong>neo4j console</strong>			:		To Start the neo4j server</p><p></p><p>default credentials -&gt; neo4j:neo4j</p><p>Current credentials -&gt; neo4j:admin@123</p><p></p><p>Then to start Bloodhound in terminal run:</p><p><strong>bloodhound</strong></p><p></p><p>Then login using default credentials.</p><p></p><p></p><p></p><p><strong>Getting loot with SharpHound</strong></p><p></p><p>1.) <strong>powershell -ep bypass</strong> same as with PowerView</p><p>2.) <strong>. .\Downloads\SharpHound.ps1</strong>    </p><p>3.) <strong>Invoke-Bloodhound -CollectionMethod All -Domain CONTROLLER.local -ZipFileName loot.zip </strong>   </p><p></p><p><img src="images/163-1.png" alt="images/163-1.png" /></p><p></p><p><strong>Very Very Important Note:</strong></p><p>If we use the SharpHound.ps1 file provided in this room. The loot.zip will not work due to <strong>compatibility issue</strong>. For the same to work, we need to install an old version of Bloodhound. (Tedious Task)</p><p></p><p>However, when I researched on the Bloodhound github, I found the latest <strong>SharpHound 1.0.3</strong> that is compatible with the latest Bloodhound.</p><p>But no ps1 format could be found. Thus I end up using the <strong>SharpHound.exe</strong> executible from:</p><p></p><p><strong>https://github.com/BloodHoundAD/SharpHound/releases</strong></p><p></p><p></p><p><img src="images/163-2.png" alt="images/163-2.png" /></p><p></p><p>Unzip the highlighted release and transfer the <strong>SharpHound.exe</strong> file to the target windows machine using scp.</p><p></p><p><strong>Note:</strong> Running the <strong>executible</strong> is bit different than running the <strong>ps1</strong> file. Following is the syntax</p><p>Quit <strong>Powershell</strong> and run it in <strong>cmd</strong>.</p><p></p><p><strong>SharpHound.exe --CollectionMethods All --domain CONTROLLER.local --ZipFileName loot.zip</strong></p><p></p><p></p><p><strong>Remarks:</strong> The command is almost similar to that of <strong>ps1</strong> version. However, it uses <strong>--</strong> for all options and <strong>CollectionMethod</strong> ---→ <strong>CollectionMethods</strong></p><p></p><p><img src="images/163-3.png" alt="images/163-3.png" /></p><p></p><p></p><p></p><p>4.) Transfer the loot.zip folder to your Attacker Machine</p><p></p><p><strong>Note:</strong> you can use scp to transfer the file if you’re using ssh</p><p></p><p><img src="images/163-4.png" alt="images/163-4.png" /></p><p></p><p></p><p><strong>Starting Neo4j console.</strong></p><p></p><p><img src="images/163-5.png" alt="images/163-5.png" /></p><p></p><p><strong>Then Run Bloodhound.</strong></p><p></p><p><img src="images/163-6.png" alt="images/163-6.png" /></p><p></p><p>Note: Upon first run of bloodhound, it asks us to change the password by going to <strong>http://localhost:7474</strong></p><p></p><p></p><p>In the neo4j browser, we give the first console command (This command is entered by default)</p><p><strong>:server connect</strong></p><p></p><p><img src="images/163-7.png" alt="images/163-7.png" /></p><p></p><p>We enter the default credentials here and are asked to change it.</p><p></p><p><img src="images/163-8.png" alt="images/163-8.png" /></p><p></p><p>Once Password is set. We can play around in Neo4j web browser.</p><p></p><p><strong>To view help, use the command</strong></p><p></p><p>:help server</p><p></p><p><img src="images/163-9.png" alt="images/163-9.png" /></p><p></p><p><strong>To change Password</strong></p><p></p><p>:server change-password</p><p></p><p><strong>Now, get back to Bloodhound and use the new set credentials</strong></p><p></p><p><strong>Mapping the network with BloodHound</strong></p><p></p><p>1.) bloodhound Run this on your attacker machine not the victim machine</p><p>2.) Sign In using the same credentials you set with Neo4j</p><p>3.) Inside of Bloodhound search for <strong>import icon</strong> <img src="images/163-10.png" alt="images/163-10.png" /> and import the loot.zip folder</p><p></p><p><strong>Note:</strong> On some versions of BloodHound the import button does not work to get around this simply <strong>drag and drop the loot.zip</strong> folder into Bloodhound to import the .json files</p><p>Or Click on the <strong>upload icon</strong> <img src="images/163-11.png" alt="images/163-11.png" /> on right and upload the loot.zip</p><p></p><p>4.) To view the graphed network open the <strong>Menu</strong> and select <strong>Analysis</strong> this will give you a list of pre-compiled queries to choose from.</p><p></p><p></p><p><strong>Eg,</strong> The queries can be as simple as <strong>find all domain admins</strong></p><p></p><p><img src="images/163-12.png" alt="images/163-12.png" /></p><p></p><p></p><p><strong>Eg,</strong> The queries can be as complex as <strong>shortest path to high value targets</strong></p><p></p><p><img src="images/163-13.png" alt="images/163-13.png" /></p><p></p><p></p><p><strong><h3>Custom Queries to find instances where a computer has the &quot;AdminTo&quot; relationship over another computer:</h3></strong></p><p></p><p><strong>MATCH p=(c1:Computer)-[r1:MemberOf*1..]-&gt;(g:Group)-[r2:AdminTo]-&gt;(n:Computer) RETURN p</strong></p><p></p><p><img src="images/163-14.png" alt="images/163-14.png" /></p></div>
</body>
</html>
