<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Rule Based</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Rule Based</h1><br/><p><strong><h1>Rule-Based attacks</h1></strong></p><p></p><p>Rule-Based attacks are also known as <strong>hybrid</strong> attacks. Rule-Based attacks assume the attacker knows something about the password policy. Rules are applied to create passwords within the guidelines of the given password policy and should, in theory, only generate valid passwords. Using pre-existing wordlists may be useful when generating passwords that fit a policy â€” for example, manipulating or &#39;mangling&#39; a password such as &#39;password&#39;: p@ssword, Pa$$word, Passw0rd, and so on.</p><p></p><p></p><p>For this attack, we can expand our wordlist using either hashcat or John the ripper. However, for this attack, let&#39;s see how<strong> John the ripper </strong>works. Usually, John the ripper has a config file that contains rule sets, which is located at /etc/john/john.conf or /opt/john/john.conf depending on your distro or how john was installed. You can read /etc/john/john.conf and look for List.Rules to see all the available rules:</p><p></p><p><strong>cat /etc/john/john.conf | grep &quot;List.Rules:&quot; | cut -d&quot;.&quot; -f3 | cut -d&quot;:&quot; -f2 | cut -d&quot;]&quot; -f1 | awk NF</strong></p><p></p><p></p><p><img src="images/399-1.png" alt="images/399-1.png" /></p><p></p><p>We can see that we have many rules that are available for us to use. We will create a wordlist with only one password containing the string <strong>tryhackme</strong>, to see how we can expand the wordlist. Let&#39;s choose one of the rules, the best64 rule, which contains the best 64 built-in John rules, and see what it can do!</p><p></p><p><span style="text-decoration:underline;">Example Rule Usage</span>:</p><p></p><p><strong>echo tryhackme &gt; /tmp/single-password-list.txt</strong></p><p><strong>john --wordlist=/tmp/single-password-list.txt --rules=best64 --stdout | wc -l</strong></p><p></p><p><img src="images/399-2.png" alt="images/399-2.png" /></p><p></p><p></p><p><strong>--wordlist=</strong> to specify the wordlist or dictionary file. </p><p></p><p><strong>--rules </strong>to specify which rule or rules to use.</p><p></p><p><strong>--stdout</strong> to print the output to the terminal.</p><p></p><p><strong>|wc -l </strong> to count how many lines John produced.</p><p></p><p></p><p><span style="text-decoration:underline;">Example Rule Usage</span>:</p><p></p><p><strong>john --wordlist=single-password-list.txt --rules=KoreLogic --stdout |grep &quot;Tryh@ckm3&quot;</strong></p><p></p><p>The output from the previous command shows that our list has the <strong>complex</strong> version of <strong>tryhackme</strong>, which is Tryh@ckm3. Finally, we recommend checking out all the rules and finding one that works the best for you. Many rules apply combinations to an existing wordlist and expand the wordlist to increase the chance of finding a valid password!</p><p></p><p></p><p><strong><h3>Custom Rules</h3></strong></p><p></p><p>John the ripper has a lot to offer. For instance, we can build our own rule(s) and use it at run time while john is cracking the hash or use the rule to build a custom wordlist!</p><p></p><p>Let&#39;s say we wanted to create a custom wordlist from a pre-existing dictionary with custom modification to the original dictionary. The goal is to add special characters (ex: !@#$*&amp;) to the beginning of each word and add numbers 0-9 at the end. The format will be as follows:</p><p></p><p><strong>[symbols]word[0-9]</strong></p><p></p><p>We can add our rule to the end of <strong>john.conf</strong>:</p><p></p><p></p><p><img src="images/399-3.png" alt="images/399-3.png" /></p><p></p><p><strong>[List.Rules:THM-Password-Attacks]</strong>  specify the rule name<strong> THM-Password-Attacks</strong>.</p><p></p><p><strong>Az</strong> represents a single word from the original wordlist/dictionary using -p.</p><p></p><p><strong>&quot;[0-9]&quot;</strong> append a single digit (from 0 to 9) to the end of the word. For <strong>two</strong> digits, we can add <strong>&quot;[0-9][0-9]&quot; </strong> and so on.  </p><p></p><p><strong>^[!@#$] </strong>add a special character at the beginning of each word. <strong>^</strong> means the beginning of the line/word. Note, changing <strong>^ </strong>to <strong>$</strong> will append the special characters to the end of the line/word.</p><p></p><p></p><p>We include the name of the rule we created in the John command using the <strong>--rules </strong>option. We also need to show the result in the terminal. We can do this by using <strong>--stdout</strong> as follows:</p><p></p><p></p><p><strong>echo password &gt; /tmp/single.lst</strong></p><p><strong>john --wordlist=/tmp/single.lst --rules=THM-Password-Attacks --stdout </strong></p><p></p><p><img src="images/399-4.png" alt="images/399-4.png" /></p><p></p><p></p><p></p></div>
</body>
</html>
